
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../favicon.ico">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.5.0">
    
    
      
        <title>Deployment - AI Software Development Kit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2e8b5541.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../styles.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#module-simaticaideployment" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../index.html" title="AI Software Development Kit" class="md-header__button md-logo" aria-label="AI Software Development Kit" data-md-component="logo">
      
  <img src="../../Sie_logo_white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AI Software Development Kit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Deployment
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../index.html" title="AI Software Development Kit" class="md-nav__button md-logo" aria-label="AI Software Development Kit" data-md-component="logo">
      
  <img src="../../Sie_logo_white.svg" alt="logo">

    </a>
    AI Software Development Kit
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../index.html" class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../CHANGELOG.html" class="md-nav__link">
        Changelog
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../user_manual.html" class="md-nav__link">
        User Manual
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_1" type="checkbox" id="__nav_4_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_1">
          Log Module
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Log Module" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          Log Module
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../log_module/index.html" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../log_module/mock_logger.html" class="md-nav__link">
        Mock Logger
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4_2">
          Simaticai
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Simaticai" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Simaticai
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Deployment
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="deployment.html" class="md-nav__link md-nav__link--active">
        Deployment
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#variables" class="md-nav__link">
    Variables
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#convert_package" class="md-nav__link">
    convert_package
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create_delta_package" class="md-nav__link">
    create_delta_package
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#find_dependencies" class="md-nav__link">
    find_dependencies
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python_version_validator" class="md-nav__link">
    python_version_validator
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#component" class="md-nav__link">
    Component
  </a>
  
    <nav class="md-nav" aria-label="Component">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#attributes" class="md-nav__link">
    Attributes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#descendants" class="md-nav__link">
    Descendants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_input" class="md-nav__link">
    add_input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_output" class="md-nav__link">
    add_output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change_input" class="md-nav__link">
    change_input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change_output" class="md-nav__link">
    change_output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_input" class="md-nav__link">
    delete_input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_output" class="md-nav__link">
    delete_output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save" class="md-nav__link">
    save
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate" class="md-nav__link">
    validate
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gpuruntimecomponent" class="md-nav__link">
    GPURuntimeComponent
  </a>
  
    <nav class="md-nav" aria-label="GPURuntimeComponent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#attributes_1" class="md-nav__link">
    Attributes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_1" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_1" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_input_1" class="md-nav__link">
    add_input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_output_1" class="md-nav__link">
    add_output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change_input_1" class="md-nav__link">
    change_input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change_output_1" class="md-nav__link">
    change_output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_input_1" class="md-nav__link">
    delete_input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_output_1" class="md-nav__link">
    delete_output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save_1" class="md-nav__link">
    save
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use_config" class="md-nav__link">
    use_config
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use_model" class="md-nav__link">
    use_model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_1" class="md-nav__link">
    validate
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pipeline" class="md-nav__link">
    Pipeline
  </a>
  
    <nav class="md-nav" aria-label="Pipeline">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#attributes_2" class="md-nav__link">
    Attributes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_components" class="md-nav__link">
    from_components
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_2" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_component" class="md-nav__link">
    add_component
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_dependencies" class="md-nav__link">
    add_dependencies
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_input_2" class="md-nav__link">
    add_input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_output_2" class="md-nav__link">
    add_output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_parameter" class="md-nav__link">
    add_parameter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_timeshifting_reference" class="md-nav__link">
    add_timeshifting_reference
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_wiring" class="md-nav__link">
    add_wiring
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_input_2" class="md-nav__link">
    delete_input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_input_wire" class="md-nav__link">
    delete_input_wire
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_output_2" class="md-nav__link">
    delete_output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#export" class="md-nav__link">
    export
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_datalink_metadata" class="md-nav__link">
    get_datalink_metadata
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_pipeline_config" class="md-nav__link">
    get_pipeline_config
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_wire_for_input" class="md-nav__link">
    get_wire_for_input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_wire_for_output" class="md-nav__link">
    get_wire_for_output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove_timeshifting_reference" class="md-nav__link">
    remove_timeshifting_reference
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save_2" class="md-nav__link">
    save
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save_datalink_metadata" class="md-nav__link">
    save_datalink_metadata
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save_pipeline_config" class="md-nav__link">
    save_pipeline_config
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save_readme_html" class="md-nav__link">
    save_readme_html
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save_telemetry_data" class="md-nav__link">
    save_telemetry_data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_timeshifting_periodicity" class="md-nav__link">
    set_timeshifting_periodicity
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_2" class="md-nav__link">
    validate
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pythoncomponent" class="md-nav__link">
    PythonComponent
  </a>
  
    <nav class="md-nav" aria-label="PythonComponent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#attributes_3" class="md-nav__link">
    Attributes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_1" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_2" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_3" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_dependencies_1" class="md-nav__link">
    add_dependencies
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_input_3" class="md-nav__link">
    add_input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_metric" class="md-nav__link">
    add_metric
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_output_3" class="md-nav__link">
    add_output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_python_packages" class="md-nav__link">
    add_python_packages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_resources" class="md-nav__link">
    add_resources
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change_input_2" class="md-nav__link">
    change_input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change_output_2" class="md-nav__link">
    change_output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_input_3" class="md-nav__link">
    delete_input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_metric" class="md-nav__link">
    delete_metric
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_output_3" class="md-nav__link">
    delete_output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disable_dependency_optimization" class="md-nav__link">
    disable_dependency_optimization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enable_dependency_optimization" class="md-nav__link">
    enable_dependency_optimization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save_3" class="md-nav__link">
    save
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_entrypoint" class="md-nav__link">
    set_entrypoint
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_parallel_steps" class="md-nav__link">
    set_parallel_steps
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_requirements" class="md-nav__link">
    set_requirements
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_3" class="md-nav__link">
    validate
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="model_config_pb2.html" class="md-nav__link">
        Model Config Pb2
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2_4" type="checkbox" id="__nav_4_2_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_2_4">
          Data
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Data" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_2_4">
          <span class="md-nav__icon md-icon"></span>
          Data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="data/index.html" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="data/schemas.html" class="md-nav__link">
        Schemas
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2_5" type="checkbox" id="__nav_4_2_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_2_5">
          Helpers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Helpers" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_2_5">
          <span class="md-nav__icon md-icon"></span>
          Helpers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="helpers/index.html" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="helpers/model_config.html" class="md-nav__link">
        Model Config
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="helpers/pep508.html" class="md-nav__link">
        Pep508
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="helpers/tempfiles.html" class="md-nav__link">
        Tempfiles
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="helpers/yaml_helper.html" class="md-nav__link">
        Yaml Helper
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2_6" type="checkbox" id="__nav_4_2_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_2_6">
          Packaging
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Packaging" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_2_6">
          <span class="md-nav__icon md-icon"></span>
          Packaging
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="packaging/constants.html" class="md-nav__link">
        Constants
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="packaging/index.html" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="packaging/python_dependencies.html" class="md-nav__link">
        Python Dependencies
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="packaging/wheelhouse.html" class="md-nav__link">
        Wheelhouse
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2_7" type="checkbox" id="__nav_4_2_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_2_7">
          Testing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Testing" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_2_7">
          <span class="md-nav__icon md-icon"></span>
          Testing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="testing/index.html" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="testing/pipeline_runner.html" class="md-nav__link">
        Pipeline Runner
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="testing/pipeline_validator.html" class="md-nav__link">
        Pipeline Validator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="testing/run_component.html" class="md-nav__link">
        Run Component
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="testing/run_gpuruntime_component.html" class="md-nav__link">
        Run Gpuruntime Component
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#variables" class="md-nav__link">
    Variables
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#convert_package" class="md-nav__link">
    convert_package
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create_delta_package" class="md-nav__link">
    create_delta_package
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#find_dependencies" class="md-nav__link">
    find_dependencies
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python_version_validator" class="md-nav__link">
    python_version_validator
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#component" class="md-nav__link">
    Component
  </a>
  
    <nav class="md-nav" aria-label="Component">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#attributes" class="md-nav__link">
    Attributes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#descendants" class="md-nav__link">
    Descendants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_input" class="md-nav__link">
    add_input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_output" class="md-nav__link">
    add_output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change_input" class="md-nav__link">
    change_input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change_output" class="md-nav__link">
    change_output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_input" class="md-nav__link">
    delete_input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_output" class="md-nav__link">
    delete_output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save" class="md-nav__link">
    save
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate" class="md-nav__link">
    validate
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gpuruntimecomponent" class="md-nav__link">
    GPURuntimeComponent
  </a>
  
    <nav class="md-nav" aria-label="GPURuntimeComponent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#attributes_1" class="md-nav__link">
    Attributes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_1" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_1" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_input_1" class="md-nav__link">
    add_input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_output_1" class="md-nav__link">
    add_output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change_input_1" class="md-nav__link">
    change_input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change_output_1" class="md-nav__link">
    change_output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_input_1" class="md-nav__link">
    delete_input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_output_1" class="md-nav__link">
    delete_output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save_1" class="md-nav__link">
    save
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use_config" class="md-nav__link">
    use_config
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use_model" class="md-nav__link">
    use_model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_1" class="md-nav__link">
    validate
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pipeline" class="md-nav__link">
    Pipeline
  </a>
  
    <nav class="md-nav" aria-label="Pipeline">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#attributes_2" class="md-nav__link">
    Attributes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_components" class="md-nav__link">
    from_components
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_2" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_component" class="md-nav__link">
    add_component
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_dependencies" class="md-nav__link">
    add_dependencies
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_input_2" class="md-nav__link">
    add_input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_output_2" class="md-nav__link">
    add_output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_parameter" class="md-nav__link">
    add_parameter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_timeshifting_reference" class="md-nav__link">
    add_timeshifting_reference
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_wiring" class="md-nav__link">
    add_wiring
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_input_2" class="md-nav__link">
    delete_input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_input_wire" class="md-nav__link">
    delete_input_wire
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_output_2" class="md-nav__link">
    delete_output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#export" class="md-nav__link">
    export
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_datalink_metadata" class="md-nav__link">
    get_datalink_metadata
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_pipeline_config" class="md-nav__link">
    get_pipeline_config
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_wire_for_input" class="md-nav__link">
    get_wire_for_input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_wire_for_output" class="md-nav__link">
    get_wire_for_output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove_timeshifting_reference" class="md-nav__link">
    remove_timeshifting_reference
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save_2" class="md-nav__link">
    save
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save_datalink_metadata" class="md-nav__link">
    save_datalink_metadata
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save_pipeline_config" class="md-nav__link">
    save_pipeline_config
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save_readme_html" class="md-nav__link">
    save_readme_html
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save_telemetry_data" class="md-nav__link">
    save_telemetry_data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_timeshifting_periodicity" class="md-nav__link">
    set_timeshifting_periodicity
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_2" class="md-nav__link">
    validate
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pythoncomponent" class="md-nav__link">
    PythonComponent
  </a>
  
    <nav class="md-nav" aria-label="PythonComponent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#attributes_3" class="md-nav__link">
    Attributes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_1" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_2" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_3" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_dependencies_1" class="md-nav__link">
    add_dependencies
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_input_3" class="md-nav__link">
    add_input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_metric" class="md-nav__link">
    add_metric
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_output_3" class="md-nav__link">
    add_output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_python_packages" class="md-nav__link">
    add_python_packages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_resources" class="md-nav__link">
    add_resources
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change_input_2" class="md-nav__link">
    change_input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change_output_2" class="md-nav__link">
    change_output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_input_3" class="md-nav__link">
    delete_input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_metric" class="md-nav__link">
    delete_metric
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_output_3" class="md-nav__link">
    delete_output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disable_dependency_optimization" class="md-nav__link">
    disable_dependency_optimization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enable_dependency_optimization" class="md-nav__link">
    enable_dependency_optimization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save_3" class="md-nav__link">
    save
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_entrypoint" class="md-nav__link">
    set_entrypoint
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_parallel_steps" class="md-nav__link">
    set_parallel_steps
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_requirements" class="md-nav__link">
    set_requirements
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_3" class="md-nav__link">
    validate
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="module-simaticaideployment">Module simaticai.deployment</h1>
<p>Packaging ML models for deployment on the AI Inference Server.</p>
<p>The AI SDK offers the functionality to create a pipeline configuration package and wrap trained models, which can be converted to an
edge configuration package and then uploaded and run on an AI Inference Server on an Industrial Edge device.</p>
<p>From a deployment perspective, the inference pipeline can consist of one or more components. This is independent of the logical structure of
the inference pipeline. For example, a typical time series pipeline that consists of multiple Scikit Learn pipeline elements can be packaged
into a single pipeline component, which includes both a feature extractor and a classifier. Alternatively, you can deploy the same pipeline
split into two components, one for the feature extractor and another for the classifier.</p>
<p>To keep things simple and less error-prone, a pipeline should have as few components as possible.
In many cases, a single component will be sufficient.
However, there might be reasons why you might consider using separate components, such as:</p>
<ul>
<li>You need a different Python environment for different parts of your processing, e.g., you have components requiring conflicting package versions.</li>
<li>You want to exploit parallelism between components without implementing multithreading.</li>
<li>You want to modularize and build your pipeline from a pool of component variants, which you can combine flexibly.</li>
</ul>
<p>The AI SDK allows you to create pipeline components implemented in Python and compose linear pipelines of one or multiple of such components.
The API is designed to anticipate future possible types of components that might be based on a different technology than Python, e.g. ONNX or
native TensorFlow Serving. Currently, only Python is supported.</p>
<p>For a comprehensive overview on how to package ML models in the context of a machine learning workflow, we recommend you refer to
the AI SDK User Manual, especially the chapter concerning packaging models into an inference pipeline. We also recommend you
follow the project templates for the AI SDK, which provide packaging notebooks as examples, and where source code and
saved trained models are organized into a given folder structure.</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="c1"># Copyright (C) Siemens AG 2021. All Rights Reserved. Confidential.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">Packaging ML models for deployment on the AI Inference Server.</span>

<span class="sd">The AI SDK offers the functionality to create a pipeline configuration package and wrap trained models, which can be converted to an</span>

<span class="sd">edge configuration package and then uploaded and run on an AI Inference Server on an Industrial Edge device.</span>

<span class="sd">From a deployment perspective, the inference pipeline can consist of one or more components. This is independent of the logical structure of</span>

<span class="sd">the inference pipeline. For example, a typical time series pipeline that consists of multiple Scikit Learn pipeline elements can be packaged</span>

<span class="sd">into a single pipeline component, which includes both a feature extractor and a classifier. Alternatively, you can deploy the same pipeline</span>

<span class="sd">split into two components, one for the feature extractor and another for the classifier.</span>

<span class="sd">To keep things simple and less error-prone, a pipeline should have as few components as possible.</span>

<span class="sd">In many cases, a single component will be sufficient.</span>

<span class="sd">However, there might be reasons why you might consider using separate components, such as:</span>

<span class="sd">- You need a different Python environment for different parts of your processing, e.g., you have components requiring conflicting package versions.</span>

<span class="sd">- You want to exploit parallelism between components without implementing multithreading.</span>

<span class="sd">- You want to modularize and build your pipeline from a pool of component variants, which you can combine flexibly.</span>

<span class="sd">The AI SDK allows you to create pipeline components implemented in Python and compose linear pipelines of one or multiple of such components.</span>

<span class="sd">The API is designed to anticipate future possible types of components that might be based on a different technology than Python, e.g. ONNX or</span>

<span class="sd">native TensorFlow Serving. Currently, only Python is supported.</span>

<span class="sd">For a comprehensive overview on how to package ML models in the context of a machine learning workflow, we recommend you refer to</span>

<span class="sd">the AI SDK User Manual, especially the chapter concerning packaging models into an inference pipeline. We also recommend you</span>

<span class="sd">follow the project templates for the AI SDK, which provide packaging notebooks as examples, and where source code and</span>

<span class="sd">saved trained models are organized into a given folder structure.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="n">from</span><span class="w"> </span><span class="n">dataclasses</span><span class="w"> </span><span class="n">import</span><span class="w"> </span><span class="n">dataclass</span>

<span class="n">import</span><span class="w"> </span><span class="n">json</span>

<span class="n">import</span><span class="w"> </span><span class="n">logging</span>

<span class="n">import</span><span class="w"> </span><span class="n">math</span>

<span class="n">import</span><span class="w"> </span><span class="n">os</span>

<span class="n">import</span><span class="w"> </span><span class="n">uuid</span>

<span class="n">import</span><span class="w"> </span><span class="n">platform</span>

<span class="n">import</span><span class="w"> </span><span class="n">re</span>

<span class="n">import</span><span class="w"> </span><span class="n">shutil</span>

<span class="n">import</span><span class="w"> </span><span class="n">subprocess</span>

<span class="n">import</span><span class="w"> </span><span class="n">sys</span>

<span class="n">import</span><span class="w"> </span><span class="n">tempfile</span>

<span class="n">import</span><span class="w"> </span><span class="n">zipfile</span>

<span class="n">from</span><span class="w"> </span><span class="n">datetime</span><span class="w"> </span><span class="n">import</span><span class="w"> </span><span class="n">datetime</span>

<span class="n">from</span><span class="w"> </span><span class="n">importlib</span><span class="w"> </span><span class="n">import</span><span class="w"> </span><span class="n">resources</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">module_resources</span>

<span class="n">from</span><span class="w"> </span><span class="n">pathlib</span><span class="w"> </span><span class="n">import</span><span class="w"> </span><span class="n">Path</span><span class="p">,</span><span class="w"> </span><span class="n">PurePath</span>

<span class="n">from</span><span class="w"> </span><span class="n">typing</span><span class="w"> </span><span class="n">import</span><span class="w"> </span><span class="n">Optional</span><span class="p">,</span><span class="w"> </span><span class="n">Tuple</span><span class="p">,</span><span class="w"> </span><span class="n">Union</span>

<span class="n">import</span><span class="w"> </span><span class="n">jsonschema</span>

<span class="n">import</span><span class="w"> </span><span class="n">jsonschema</span><span class="o">.</span><span class="n">exceptions</span>

<span class="n">import</span><span class="w"> </span><span class="n">pkg_resources</span>

<span class="n">import</span><span class="w"> </span><span class="n">yaml</span>

<span class="n">from</span><span class="w"> </span><span class="n">MarkupPy</span><span class="w"> </span><span class="n">import</span><span class="w"> </span><span class="n">markup</span>

<span class="n">from</span><span class="w"> </span><span class="n">google</span><span class="o">.</span><span class="n">protobuf</span><span class="w"> </span><span class="n">import</span><span class="w"> </span><span class="n">text_format</span>

<span class="n">from</span><span class="w"> </span><span class="n">simaticai</span><span class="w"> </span><span class="n">import</span><span class="w"> </span><span class="n">model_config_pb2</span>

<span class="n">from</span><span class="w"> </span><span class="n">simaticai</span><span class="o">.</span><span class="n">helpers</span><span class="w"> </span><span class="n">import</span><span class="w"> </span><span class="n">pep508</span><span class="p">,</span><span class="w"> </span><span class="n">tempfiles</span><span class="p">,</span><span class="w"> </span><span class="n">yaml_helper</span><span class="p">,</span><span class="w"> </span><span class="n">model_config</span><span class="p">,</span><span class="w"> </span><span class="n">calc_sha</span>

<span class="n">from</span><span class="w"> </span><span class="n">simaticai</span><span class="o">.</span><span class="n">helpers</span><span class="o">.</span><span class="n">tempfiles</span><span class="w"> </span><span class="n">import</span><span class="w"> </span><span class="n">OpenZipInTemp</span>

<span class="n">from</span><span class="w"> </span><span class="n">simaticai</span><span class="o">.</span><span class="n">packaging</span><span class="o">.</span><span class="n">constants</span><span class="w"> </span><span class="n">import</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="n">PIPELINE_CONFIG</span><span class="p">,</span><span class="w"> </span><span class="n">RUNTIME_CONFIG</span><span class="p">,</span><span class="w"> </span><span class="n">DATALINK_METADATA</span><span class="p">,</span><span class="w">  </span><span class="c1"># pipeline configuration files</span>

<span class="w">    </span><span class="n">TELEMETRY_YAML</span><span class="p">,</span><span class="w"> </span><span class="n">README_HTML</span><span class="p">,</span><span class="w">  </span><span class="c1"># additional pipeline information files</span>

<span class="w">    </span><span class="n">REQUIREMENTS_TXT</span><span class="p">,</span><span class="w"> </span><span class="n">PYTHON_PACKAGES_ZIP</span><span class="p">,</span><span class="w">  </span><span class="c1"># component dependency configuration</span>

<span class="w">    </span><span class="n">PYTHON_PACKAGES</span><span class="p">,</span><span class="w"> </span><span class="n">supported_types</span><span class="p">,</span><span class="w"> </span><span class="n">MSG_NOT_FOUND</span><span class="p">,</span><span class="w">  </span><span class="c1"># additional constants</span>

<span class="w">    </span><span class="n">PIPELINE_SIZE_LIMIT</span>

<span class="p">)</span>

<span class="n">from</span><span class="w"> </span><span class="n">simaticai</span><span class="o">.</span><span class="n">packaging</span><span class="o">.</span><span class="n">python_dependencies</span><span class="w"> </span><span class="n">import</span><span class="w"> </span><span class="n">PythonDependencies</span>

<span class="n">from</span><span class="w"> </span><span class="n">simaticai</span><span class="o">.</span><span class="n">packaging</span><span class="o">.</span><span class="n">wheelhouse</span><span class="w"> </span><span class="n">import</span><span class="w"> </span><span class="n">create_wheelhouse</span>

<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">()</span>

<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span><span class="o">.</span><span class="n">handlers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)]</span>

<span class="n">_logger</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="n">_logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>

<span class="n">_version_matcher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;Version: ([^ ]+).*&#39;</span><span class="p">)</span>

<span class="n">_transitive_matcher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;Requires: (.+)&#39;</span><span class="p">)</span>

<span class="n">def</span><span class="w"> </span><span class="n">find_dependencies</span><span class="p">(</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">dependencies</span><span class="p">:</span><span class="w"> </span><span class="n">dict</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    @Deprecated, reason: uses &#39;pip show&#39; which only works for installed packages on the current platform.</span>

<span class="sd">    Collects all dependencies of the Python module given with its `name` in the current Python environment.</span>

<span class="sd">    All inherited dependencies will be added to the `dependencies` dictionary with the installed version of the module.</span>

<span class="sd">    The method executes an OS command like `python -m pip show scikit-learn`.</span>

<span class="sd">    Args:</span>

<span class="sd">        name (str): Name of the Python module to be searched through for its dependencies.</span>

<span class="sd">        dependencies (dict): Dictionary to collect the dependencies with the module name as key, and the installed version as value.</span>

<span class="sd">    Returns:</span>

<span class="sd">        dict: The `dependencies` dictionary with the collected module names and versions.</span>

<span class="sd">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="n">cmd_line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">sys</span><span class="o">.</span><span class="n">executable</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;-m&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;pip&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;show&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">]</span>

<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">cmd_line</span><span class="p">,</span><span class="w"> </span><span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span><span class="w"> </span><span class="n">text</span><span class="o">=</span><span class="n">True</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">result</span><span class="o">.</span><span class="n">returncode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">        </span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Dependency {name} is not found and cannot be added.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">dependencies</span>

<span class="w">    </span><span class="n">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>

<span class="w">        </span><span class="n">version_matches</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_version_matcher</span><span class="o">.</span><span class="k">match</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">version_matches</span><span class="p">:</span>

<span class="w">            </span><span class="n">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">version_matches</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

<span class="w">        </span><span class="n">transitive_matches</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_transitive_matcher</span><span class="o">.</span><span class="k">match</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">transitive_matches</span><span class="p">:</span>

<span class="w">            </span><span class="n">transitives</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transitive_matches</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">dependency</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">transitives</span><span class="p">:</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">dependency</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">dependencies</span><span class="p">:</span>

<span class="w">                    </span><span class="n">find_dependencies</span><span class="p">(</span><span class="n">dependency</span><span class="p">,</span><span class="w"> </span><span class="n">dependencies</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">dependencies</span><span class="p">:</span>

<span class="w">        </span><span class="n">spec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pep508</span><span class="o">.</span><span class="n">Spec</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="p">[(</span><span class="s1">&#39;==&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">)]</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="n">None</span><span class="p">)</span>

<span class="w">        </span><span class="n">dependencies</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spec</span>

<span class="w">        </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Found:&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">spec</span><span class="p">)</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">dependencies</span>

<span class="n">def</span><span class="w"> </span><span class="n">python_version_validator</span><span class="p">(</span><span class="n">version</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Checks if Python version string is valid and describes supported version.</span>

<span class="sd">    Only version 3.10 and 3.11 is supported. A patch version is optional and accepted but logs a warning.</span>

<span class="sd">    Accepted syntaxes are:</span>

<span class="sd">        - {major}.{minor}</span>

<span class="sd">        - {major}.{minor}.{patch}</span>

<span class="sd">    Args:</span>

<span class="sd">        version (str): Python version string</span>

<span class="sd">    Raises:</span>

<span class="sd">        ValueError: if the provided version is not supported</span>

<span class="sd">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="n">supported_versions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;3.10&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;3.11&quot;</span><span class="p">]</span>

<span class="w">    </span><span class="n">error_message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;The defined python version is not supported. Currently supported Python versions are 3.10 and 3.11. Python version must be specified only with major and minor version, e.g. &#39;3.10&#39;.&quot;</span>

<span class="w">    </span><span class="n">warning_message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;&quot;Required Python version was specified with patch version.</span>

<span class="s2">                Please note that the patch digit of the required Python version is often not taken into account by the Python ecosystem,</span>

<span class="s2">                so there is no guarantee it has the desired effect.&quot;&quot;&quot;</span>

<span class="w">    </span><span class="n">python_version_matcher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">re</span><span class="o">.</span><span class="k">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(3)\.(0|[1-9][0-9]*)\.?(0|[1-9][0-9]*)?$&#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">str</span><span class="p">(</span><span class="n">version</span><span class="p">))</span>

<span class="w">    </span><span class="n">major_minor_version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;0.0&quot;</span>

<span class="w">    </span><span class="n">has_patch_version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">python_version_matcher</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">        </span><span class="n">major_minor_version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;{python_version_matcher.group(1)}.{python_version_matcher.group(2)}&quot;</span>

<span class="w">        </span><span class="n">has_patch_version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">python_version_matcher</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">major_minor_version</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">supported_versions</span><span class="p">:</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="n">error_message</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">has_patch_version</span><span class="p">:</span>

<span class="w">        </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">warning_message</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="n">Component</span><span class="p">:</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Base class for pipeline components, with name, description, and a list of inputs and outputs.</span>

<span class="sd">    A new component is created with the given name and an empty input and output list.</span>

<span class="sd">    Args:</span>

<span class="sd">        name (str): Name of the component</span>

<span class="sd">        desc (str): Optional description of the component</span>

<span class="sd">        inputs (dict): Dictionary of (name, type) pairs, which describe the input variables</span>

<span class="sd">        outputs (dict): Dictionary of (name, type) pairs, which describe the output variables</span>

<span class="sd">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="n">reserved_names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span>

<span class="w">    </span><span class="err">@</span><span class="n">dataclass</span>

<span class="w">    </span><span class="k">class</span><span class="w"> </span><span class="n">BatchInfo</span><span class="p">:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Batch information for the component.</span>

<span class="sd">        This attribute specifies whether the component can handle batch input or output data.</span>

<span class="sd">        When set to True, the component will receive data in the form of a list of dictionaries instead of a single dictionary.</span>

<span class="sd">        It is important to note that the input and output variables on the component should still be defined as if they are single variables.</span>

<span class="sd">        If the input of the pipeline is configured for batch processing, it is recommended not to configure timeshifting, as the list will have the same timestamp for all elements, potentially resulting in data loss.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">inputBatch</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span>

<span class="w">        </span><span class="n">outputBatch</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>

<span class="w">                </span><span class="s1">&#39;inputBatch&#39;</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Yes&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputBatch</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">True</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;No&#39;</span><span class="p">,</span>

<span class="w">                </span><span class="s1">&#39;outputBatch&#39;</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Yes&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputBatch</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">True</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;No&#39;</span>

<span class="w">            </span><span class="p">}</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Creates a new component with the given name and an empty input and output list.</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Name of the component.</span>

<span class="sd">            desc (str): Optional description of the component</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">desc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">desc</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">batch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">BatchInfo</span><span class="p">(</span><span class="n">False</span><span class="p">,</span><span class="w"> </span><span class="n">False</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb">str</span><span class="p">:</span>

<span class="w">        </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;[{self.__class__.__name__}] {self.name}</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">desc</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">:</span>

<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;{self.desc}</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Component Inputs:</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;&gt; {name} ({input[&#39;type&#39;]}){&#39;: &#39; + input[&#39;desc&#39;] if input.get(&#39;desc&#39;) is not None else &#39;&#39;}</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Component Outputs:</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;&lt; {name} ({output[&#39;type&#39;]}){&#39;: &#39; + output[&#39;desc&#39;] if output.get(&#39;desc&#39;) is not None else &#39;&#39;}</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">text</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">_type</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Adds a new input to the component with its type.</span>

<span class="sd">        Name of the variables cannot be reserved name like &#39;timestamp&#39;.</span>

<span class="sd">        Input variable &#39;timestamp&#39; is a prebuilt key in the payload and its value contains the timestamp when the payload is created by AI Inference Server.</span>

<span class="sd">        Types supported by AI Inference Server version 1.6 are contained in the `type_dictionary`. Newer AI Inference server version may support additional types.</span>

<span class="sd">        In case the type is not known by the AI SDK, a warning message will be printed.</span>

<span class="sd">        The most frequently used types are</span>

<span class="sd">        - String:</span>

<span class="sd">            Typically used for data received from Databus</span>

<span class="sd">        - Object:</span>

<span class="sd">            Object type variables are designed to receive from Vision Connect or transfer images between components</span>

<span class="sd">        - Numeric scalar types:</span>

<span class="sd">            Typically used for data received from S7 Connector</span>

<span class="sd">        The example payload below shows the format of image received from VCA Connector</span>

<span class="sd">        ```python</span>

<span class="sd">            payload = { &quot;image&quot;:</span>

<span class="sd">                {</span>

<span class="sd">                    &quot;resolutionWidth&quot;: image.width,</span>

<span class="sd">                    &quot;resolutionHeight&quot;: image.height,</span>

<span class="sd">                    &quot;mimeType&quot;: [&quot;image/raw&quot;],</span>

<span class="sd">                    &quot;dataType&quot;: &quot;uint8&quot;,</span>

<span class="sd">                    &quot;channelsPerPixel&quot;: 3,</span>

<span class="sd">                    &quot;image&quot;: _swap_bytes(image.tobytes())</span>

<span class="sd">                }</span>

<span class="sd">            }</span>

<span class="sd">        ```</span>

<span class="sd">        Between components the format is the same format as the format of Object as an output.</span>

<span class="sd">        ```python</span>

<span class="sd">            &quot;processedImage&quot;: {</span>

<span class="sd">                &quot;metadata&quot;: json.dumps( {</span>

<span class="sd">                                &quot;resolutionWidth&quot;: image.width,</span>

<span class="sd">                                &quot;resolutionHeight&quot;: image.height</span>

<span class="sd">                                }</span>

<span class="sd">                            ),</span>

<span class="sd">                &quot;bytes&quot;: image.tobytes()</span>

<span class="sd">            }</span>

<span class="sd">        ```</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Name of the new input.</span>

<span class="sd">            _type (str): Type of the new input.</span>

<span class="sd">            desc (str): Description of the input. (optional)</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Input &#39;{name}&#39; already exists.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">reserved_names</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Input &#39;{name}&#39; is a reserved keyword.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">_type</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">supported_types</span><span class="p">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;WARNING! Unknown type &#39;{_type}&#39; for input variable &#39;{name}&#39;. Please check if the target Inference Server supports this type.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">_type</span><span class="p">,</span>

<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">desc</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;desc&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">desc</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">change_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">_type</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Changes one of the inputs of the component.</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Name of the input to be changed.</span>

<span class="sd">            _type (str): New type of the input.</span>

<span class="sd">            desc (str): Description of the input. (optional)</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;There is no input with name &#39;{name}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">_type</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">supported_types</span><span class="p">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;WARNING! Unknown type &#39;{_type}&#39; for input variable &#39;{name}&#39;. Please check if the target Inference Server supports this type.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_type</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">desc</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;desc&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">desc</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">delete_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Deletes an input from the component by name.</span>

<span class="sd">        Once the package has been created with the given component, it is recommended not to change the component directly.</span>

<span class="sd">        Instead, all necessary methods to change it are available through the package to avoid component inconsistencies.</span>

<span class="sd">        It is recommended to use `package.delete_input_wire(...)` with default parameter `with_input=True`.</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Name of the input to be deleted.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Component &#39;{self.name}&#39; has no input &#39;{name}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">_type</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Adds a new output to the component.</span>

<span class="sd">        Types supported by AI Inference Server version 1.6 are contained in the `type_dictionary`. Newer AI Inference server version may support additional types.</span>

<span class="sd">        In case the type is not known by the AI SDK, a warning message will be printed.</span>

<span class="sd">        The most frequently used types are</span>

<span class="sd">        - String:</span>

<span class="sd">            Typically used for data to be sent to Databus</span>

<span class="sd">        - Object:</span>

<span class="sd">            Typically used for images to be sent to ZMQ Connector</span>

<span class="sd">        - Numeric scalar types:</span>

<span class="sd">            Typically used for data sent to S7 Connector</span>

<span class="sd">        For outputs of type `Object` the entrypoint must return with a `dictionary` containing two fields, where one field has type `str` and the other field has type `bytes`.</span>

<span class="sd">        The example below shows the required format, assuming that &#39;image&#39; is a PIL Image.</span>

<span class="sd">        ```python</span>

<span class="sd">            &quot;processedImage&quot;: {</span>

<span class="sd">                &quot;metadata&quot;: json.dumps( {</span>

<span class="sd">                                &quot;resolutionWidth&quot;: image.width,</span>

<span class="sd">                                &quot;resolutionHeight&quot;: image.height</span>

<span class="sd">                                }</span>

<span class="sd">                            ),</span>

<span class="sd">                &quot;bytes&quot;: image.tobytes()</span>

<span class="sd">            }</span>

<span class="sd">        ```</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Name of the new output.</span>

<span class="sd">            _type (str): Type of the new output.</span>

<span class="sd">            desc (str): Description of the output. (optional)</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Output &#39;{name}&#39; already exists&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">_type</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">supported_types</span><span class="p">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;WARNING! Unknown type &#39;{_type}&#39; for input variable &#39;{name}&#39;. Please check if the target Inference Server supports this type.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">_type</span><span class="p">,</span>

<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">desc</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;desc&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">desc</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">change_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">_type</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Changes one of the outputs of the component.</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Name of the output to be changed.</span>

<span class="sd">            _type (str): The new type of the output.</span>

<span class="sd">            desc (str): Description of the output. (optional)</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;There is no output with name &#39;{name}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">_type</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">supported_types</span><span class="p">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;WARNING! Unknown type &#39;{_type}&#39; for input variable &#39;{name}&#39;. Please check if the target Inference Server supports this type.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_type</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">desc</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;desc&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">desc</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">delete_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Deletes an output from the component by name.</span>

<span class="sd">        Once the package has been created with the given component, it is recommended not to change the component directly.</span>

<span class="sd">        Instead, all necessary methods to change it are available through the package to avoid component inconsistencies.</span>

<span class="sd">        Deleting an output which is represented in any wire will cause package inconsistency.</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Name of the output to be deleted.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Component &#39;{self.name}&#39; has no output &#39;{name}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">        </span><span class="n">inputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>

<span class="w">        </span><span class="n">inputs</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">[{</span>

<span class="w">            </span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">name</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">],</span>

<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">]</span>

<span class="w">        </span><span class="n">outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>

<span class="w">        </span><span class="n">outputs</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">[{</span>

<span class="w">            </span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">name</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">],</span>

<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">]</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;description&#39;</span><span class="p">:</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">desc</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;batch&#39;</span><span class="p">:</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">batch</span><span class="o">.</span><span class="n">dict</span><span class="p">(),</span>

<span class="w">            </span><span class="s1">&#39;inputType&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">inputs</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;outputType&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">outputs</span><span class="p">,</span>

<span class="w">        </span><span class="p">}</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Empty method for child classess to implement.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">pass</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">destination</span><span class="p">,</span><span class="w"> </span><span class="n">validate</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Empty method for child classess to implement.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="n">PythonComponent</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    A pipeline component implemented using Python scripts and libraries.</span>

<span class="sd">    A `PythonComponent` wraps Python code resource files such as saved models into a structured folder, which can be added to a pipeline</span>

<span class="sd">    configuration package.</span>

<span class="sd">    For a comprehensive overview on how to wrap ML models into Python components, we recommend you refer to</span>

<span class="sd">    the AI SDK User Manual, especially the guideline for writing pipeline components. We also recommend you</span>

<span class="sd">    study the example Python components in the E2E Tutorials for the AI SDK.</span>

<span class="sd">    A new `PythonComponent` is empty.</span>

<span class="sd">    Args:</span>

<span class="sd">        name (str): Component name. (default: inference)</span>

<span class="sd">        desc (str): Component description (optional)</span>

<span class="sd">        version (str): Component version. (default: 0.0.1)</span>

<span class="sd">        python_version (str): Python version on the target AI Inference Server.</span>

<span class="sd">            At the moment of writing, the current version supports Python 3.10 and 3.11.</span>

<span class="sd">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;inference&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="o">=</span><span class="s2">&quot;0.0.1&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">python_version</span><span class="o">=</span><span class="s1">&#39;3.10&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Creates a new, empty Python component.</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Component name. (default: inference)</span>

<span class="sd">            desc (str): Component description (optional)</span>

<span class="sd">            version (str): Component version. (default: 0.0.1)</span>

<span class="sd">            python_version (str): Python version on the target AI Inference Server. At the moment of writing, AI Inference Server supports Python 3.10 and 3.11.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="o">=</span><span class="n">desc</span><span class="p">)</span>

<span class="w">        </span><span class="n">try</span><span class="p">:</span>

<span class="w">            </span><span class="n">python_version_validator</span><span class="p">(</span><span class="n">python_version</span><span class="p">)</span>

<span class="w">        </span><span class="n">except</span><span class="w"> </span><span class="n">ValueError</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">error</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">python_version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">python_version</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">version</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PythonDependencies</span><span class="p">(</span><span class="n">python_version</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">_replicas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb">str</span><span class="p">:</span>

<span class="w">        </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">super</span><span class="p">()</span><span class="o">.</span><span class="n">__repr__</span><span class="p">()</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Metrics:</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">metric</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;&lt; {name}{&#39;: &#39; + metric[&#39;desc&#39;] if metric.get(&#39;desc&#39;) is not None else &#39;&#39;}</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="p">):</span>

<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Resources:</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;  {base}/{path.name}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;./&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;Entrypoint: {self.entrypoint}</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">text</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">set_entrypoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">entrypoint</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Sets the entrypoint module for the component.</span>

<span class="sd">        The entrypoint is the Python code which is responsible for receiving the input data and producing a structured response with the output for the AI Inference Server.</span>

<span class="sd">        The script should consume a JSON string and produce another. See the short example below.</span>

<span class="sd">        The file will be copied into the root directory of the component on the AI Inference Server, so every file reference should be aligned.</span>

<span class="sd">        The example code below shows a basic structure of the entrypoint Python code.</span>

<span class="sd">        ```python</span>

<span class="sd">        import json</span>

<span class="sd">        import sys</span>

<span class="sd">        from pathlib import Path</span>

<span class="sd">        # by adding the parent folder of your modules to system path makes them available for relative import</span>

<span class="sd">        sys.path.insert(0, str(Path(&#39;./src&#39;).resolve()))</span>

<span class="sd">        from my_module import processor  # then the processor module can be imported</span>

<span class="sd">        def run(data: str):</span>

<span class="sd">            input_data = json.loads(data)  # incoming JSON string is loaded as a dictionary</span>

<span class="sd">            result = processor.process_data(input_data)  # the process_data can be called to process the incoming data</span>

<span class="sd">            # the code below creates the formatted output for the AI Inference Server</span>

<span class="sd">            if result is None:</span>

<span class="sd">                answer = {&quot;ready&quot;: False, &quot;output&quot;: None}</span>

<span class="sd">            else:</span>

<span class="sd">                answer = {&quot;ready&quot;: True, &quot;output&quot;: json.dumps(result)}</span>

<span class="sd">            return answer</span>

<span class="sd">        ```</span>

<span class="sd">        Args:</span>

<span class="sd">            entrypoint (str): Name of the new entrypoint script to be copied</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">any</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">items</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">key</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">entrypoint</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="p">):</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;Entrypoint must be added as resource to the root directory before setting up as entrypoint.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">entrypoint</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_resources</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">base_dir</span><span class="p">:</span><span class="w"> </span><span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">,</span><span class="w"> </span><span class="n">resources</span><span class="p">:</span><span class="w"> </span><span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">list</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Adds files to a component.</span>

<span class="sd">        To make your file resources available on the AI Inference Server you need to add them to the package resources.</span>

<span class="sd">        These resources can be Python or config files, serialized ML models or reference data.</span>

<span class="sd">        They are then available on path {component_root}/{resources} in the runtime environment.</span>

<span class="sd">        When saving the package they will be copied from {base_dir}/{resources} into the package.</span>

<span class="sd">        Files in &#39;__pycache__&#39; folders or any other hidden folders (folder name starting with &#39;.&#39; character) will be excluded.</span>

<span class="sd">        Args:</span>

<span class="sd">            base_dir (path-like): Root folder of your code from which the resources are referred</span>

<span class="sd">            resources (os.PathLike or List): A single path or list of relative paths to resource files</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span>

<span class="w">        </span><span class="n">base_dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">base_dir</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">base_dir</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Parameter &#39;base_dir&#39; must be a directory and available in path {base_dir}.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">resources</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resources</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">type</span><span class="p">(</span><span class="n">resources</span><span class="p">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">[</span><span class="n">resources</span><span class="p">]</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">resources</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">_add_resource</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="w"> </span><span class="n">resource</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_add_resource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">base_dir</span><span class="p">:</span><span class="w"> </span><span class="n">Path</span><span class="p">,</span><span class="w"> </span><span class="n">resource</span><span class="p">:</span><span class="w"> </span><span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">):</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span><span class="o">.</span><span class="n">is_absolute</span><span class="p">()</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;..&#39;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">resource</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;The resource path must be relative and cannot contain &#39;/../&#39; elements.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">resource_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">base_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">resource</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">resource_path</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">_add_resource_file</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="w"> </span><span class="n">resource_path</span><span class="p">)</span>

<span class="w">            </span><span class="k">return</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">resource_path</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">glob_path</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">resource_path</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">):</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">glob_path</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>

<span class="w">                    </span><span class="bp">self</span><span class="o">.</span><span class="n">_add_resource_file</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="w"> </span><span class="n">glob_path</span><span class="p">)</span>

<span class="w">            </span><span class="k">return</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Specified resource is not a file or directory: &#39;{resource}&#39;&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_add_resource_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">base_dir</span><span class="p">:</span><span class="w"> </span><span class="n">Path</span><span class="p">,</span><span class="w"> </span><span class="n">resource_path</span><span class="p">:</span><span class="w"> </span><span class="n">Path</span><span class="p">):</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">parent</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">resource_path</span><span class="o">.</span><span class="n">parents</span><span class="p">:</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;__pycache__&#39;</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nb">str</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">):</span>

<span class="w">                </span><span class="k">return</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">resource_path</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Resource &#39;{resource_path}&#39; is already added to target directory &#39;{self.resources[resource_path]}&#39;&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="k">return</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="p">[</span><span class="n">resource_path</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;{resource_path.parent.relative_to(base_dir)}&quot;</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_dependencies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">packages</span><span class="p">:</span><span class="w"> </span><span class="n">list</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Adds required dependencies for the Python code.</span>

<span class="sd">        The list must contain the name of the Python packages or tuples in the form of (name, version) which are required to execute the component on AI Inference Server.</span>

<span class="sd">        The method will search for the packages for the target platform and collect their transitive dependencies as well.</span>

<span class="sd">        Packages that are distributed only in source format can be added too, but only if they are pure Python packages.</span>

<span class="sd">        Args:</span>

<span class="sd">            packages (list): Can be a list of strings (name) or a list of tuples (name, version) of the required packages for component execution</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span><span class="o">.</span><span class="n">add_dependencies</span><span class="p">(</span><span class="n">packages</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">set_requirements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">requirements_path</span><span class="p">:</span><span class="w"> </span><span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Reads the defined dependencies from the given `requirements.txt` file and creates a new dependency list. Previously added dependencies will be cleared.</span>

<span class="sd">        The file format must follow Python&#39;s requirements file format defined in PEP 508.</span>

<span class="sd">        It can contain URLs to additional repositories in the form of `--extra-index-url=my.repo.example.com`.</span>

<span class="sd">        Args:</span>

<span class="sd">            requirements_path (str): Path of the given `requirements.txt` file</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span><span class="o">.</span><span class="n">set_requirements</span><span class="p">(</span><span class="n">requirements_path</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_python_packages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Adds Python package(s) to the `PythonPackages.zip` file of the component.</span>

<span class="sd">        The `path` parameter can refer to either a `whl`, a `zip` or a `tar.gz` file.</span>

<span class="sd">        Zip files can be either a source distribution package or a collection of Python packages. Only pure Python source distributions are allowed.</span>

<span class="sd">        The dependency list of the component will be extended with the files added here, so that they will also get installed on the AI Inference Server.</span>

<span class="sd">        The method uses the `tempfile.tempdir` folder, so make sure that the folder is writeable.</span>

<span class="sd">        The wheel files must fulfill the requirements of the targeted device environment</span>

<span class="sd">        (e.g., the Python version must match the supported Python version of the targeted AI Inference Server, and the platform should be one of the supported ones too).</span>

<span class="sd">        Args:</span>

<span class="sd">            path (str): Path of the distribution file</span>

<span class="sd">        Examples:</span>

<span class="sd">            `component.add_python_packages(&#39;../resources/my_package-0.0.1-py3-none-any.wheel&#39;)`</span>

<span class="sd">                adds the wheel file to `PythonPackages.zip` and adds dictionary item `component.dependencies[&#39;my_package&#39;] = &#39;0.0.1&#39;`</span>

<span class="sd">            `component.add_python_packages(&#39;../resources/inference-wheels.zip&#39;)`</span>

<span class="sd">                adds all the wheel files in the zip to `PythonPackages.zip` and `component.dependencies`</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span><span class="o">.</span><span class="n">add_python_packages</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">set_parallel_steps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">replicas</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Sets the number of parallel executors.</span>

<span class="sd">        This method configures how many instances of the component can be</span>

<span class="sd">        executed at the same time.</span>

<span class="sd">        The component must be suitable for parallel execution. The inputs arriving</span>

<span class="sd">        to the component will be processed by different instances in parallel,</span>

<span class="sd">        and these instances do not share their state (e.g. variables). Every</span>

<span class="sd">        instance is initialized separately and receives only a fraction of the inputs.</span>

<span class="sd">        AI Inference Server supports at most 8 parallel instances.```</span>

<span class="sd">        Args:</span>

<span class="sd">            replicas (int): Number of parallel executors. Default is 1.</span>

<span class="sd">        Raises:</span>

<span class="sd">            ValueError: if the given argument is not a positive integer.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">not</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">replicas</span><span class="p">,</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">))</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">replicas</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="s2">&quot;Replica count must be a positive integer.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">replicas</span><span class="p">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;The current maximum of parallel executors is 8.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">_replicas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">replicas</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_metric</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Adds a metric that will be automatically used as a pipeline output.</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Name of the metric.</span>

<span class="sd">            desc (str): Description of the metric. (optional)</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="s2">&quot;_&quot;</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">name</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;The metric name must contain at least one underscore&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Metric &#39;{name}&#39; already exists&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">desc</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;desc&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">desc</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">delete_metric</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Remove a previously added metric.</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Name of the metric to be deleted.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Component &#39;{self.name}&#39; has no metric &#39;{name}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">        </span><span class="n">dict</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="o">**</span><span class="n">super</span><span class="p">()</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(),</span>

<span class="w">            </span><span class="s1">&#39;version&#39;</span><span class="p">:</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;entrypoint&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;./{self.entrypoint.name}&quot;</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;hwType&#39;</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;CPU&#39;</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;runtime&#39;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>

<span class="w">                </span><span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;python&#39;</span><span class="p">,</span>

<span class="w">                </span><span class="s1">&#39;version&#39;</span><span class="p">:</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">python_version</span>

<span class="w">            </span><span class="p">},</span>

<span class="w">            </span><span class="s1">&#39;replicas&#39;</span><span class="p">:</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_replicas</span>

<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">dict</span><span class="p">[</span><span class="s2">&quot;outputType&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">[{</span>

<span class="w">            </span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">name</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;String&#39;</span><span class="p">,</span>

<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">dict</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">enable_dependency_optimization</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Allows changing repository URLs to optimize the package size</span>

<span class="sd">        Allows the replacement of the `--index-url` argument during `pip download` to download</span>

<span class="sd">        CPU runtime optimized dependencies only. Enabling this optimization, the present</span>

<span class="sd">        `--index-url` will be prepended to the `--extra-index-url` list, and the Pytorch CPU only repository</span>

<span class="sd">        will be set as the `--index-url`.</span>

<span class="sd">        A warning message will be printed if the repository URL modification was necessary.</span>

<span class="sd">        Some dependencies have both CPU and GPU runtime</span>

<span class="sd">        versions, pytorch for example, but a `PythonComponent` can only run on CPU, so</span>

<span class="sd">        packaging the additional GPU runtime dependencies just enlarges the package size.</span>

<span class="sd">        If you want to run your model on GPU, convert it to an `ONNX` model and use it within a</span>

<span class="sd">        `GPURuntimeComponent`.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span><span class="o">.</span><span class="n">enable_dependency_optimization</span><span class="p">()</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">disable_dependency_optimization</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Disables any modification to repository URLs</span>

<span class="sd">        Disables the replacement of the `--index-url` argument during `pip download`.</span>

<span class="sd">        This way all `--index-url` or `--extra-index-url` arguments will be preserved if they</span>

<span class="sd">        were present in the requirements.txt file.</span>

<span class="sd">        Some dependencies have both CPU and GPU runtime</span>

<span class="sd">        versions, pytorch for example, but a `PythonComponent` can only run on CPU, so</span>

<span class="sd">        packaging the additional GPU runtime dependencies just enlarges the package size.</span>

<span class="sd">        A warning message will be printed about the package size if this optimization is disabled and</span>

<span class="sd">        the dependency list contains GPU optimized dependencies.</span>

<span class="sd">        Disabling this optimization will not allow the component to run on GPU.</span>

<span class="sd">        If you want to run your model on GPU, convert it to an `ONNX` model and use it within a</span>

<span class="sd">        `GPURuntimeComponent`.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span><span class="o">.</span><span class="n">disable_dependency_optimization</span><span class="p">()</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Validates that the component is ready to be serialized and packaged as part of a pipeline.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="p">:</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">                </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;Entrypoint must be defined&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">any</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">items</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">key</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="p">):</span>

<span class="w">                </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;Entrypoint must be added as resource to the root directory before setting up as entrypoint.&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span><span class="o">.</span><span class="n">dependencies</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span>

<span class="w">                </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;WARNING! There are no dependencies defined for component &#39;{self.name}&#39;. Please make sure that all necessary dependencies have been added.&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">True</span>

<span class="w">        </span><span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Component &#39;{self.name}&#39; is valid and ready to use.&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">destination</span><span class="p">,</span><span class="w"> </span><span class="n">validate</span><span class="o">=</span><span class="n">True</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Saves the component to a folder structure, so it can be used as part of a pipeline configuration package.</span>

<span class="sd">        Validation can be skipped by setting parameter `validate` to False.</span>

<span class="sd">        This is useful when the component is already validated and only intended to be saved.</span>

<span class="sd">        The component folder contains the following:</span>

<span class="sd">        - `requirements.txt` with a list of Python dependencies</span>

<span class="sd">        - Entry point script defined by the `entrypoint` attribute of the component</span>

<span class="sd">        - Extra files as added to the specified folders</span>

<span class="sd">        - `PythonPackages.zip` with the wheel binaries for the environment to be installed</span>

<span class="sd">        Args:</span>

<span class="sd">            destination (path-like): Target directory to which the component will be saved.</span>

<span class="sd">            validate (bool): With value True, triggers component validation. Defaults to True.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">validate</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>

<span class="w">        </span><span class="n">folder_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">name</span>

<span class="w">        </span><span class="n">folder_path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="n">True</span><span class="p">,</span><span class="w"> </span><span class="n">exist_ok</span><span class="o">=</span><span class="n">True</span><span class="p">)</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">file_path</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="p">:</span>

<span class="w">            </span><span class="n">dir_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">folder_path</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="p">[</span><span class="n">file_path</span><span class="p">]</span>

<span class="w">            </span><span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span><span class="w"> </span><span class="n">exist_ok</span><span class="o">=</span><span class="n">True</span><span class="p">)</span>

<span class="w">            </span><span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span><span class="w"> </span><span class="n">dir_path</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">file_path</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">folder_path</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="n">Pipeline</span><span class="p">:</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    `Pipeline` represents a pipeline configuration package with `Components` and wires to provide a data flow on the AI Inference Server.</span>

<span class="sd">    The `Components` have inputs and outputs to transfer data to each other and the wires describe this data flow between them.</span>

<span class="sd">    The package also contains configuration files required to deploy a pipeline on an Industrial Edge device.</span>

<span class="sd">    A newly initialized `Pipeline` does not contain any `Component` or wire, only its name and version will be set.</span>

<span class="sd">    The name and version together will define the name of the zip file when the package is saved.</span>

<span class="sd">    Args:</span>

<span class="sd">        name (str): Name of the package</span>

<span class="sd">        version (str): Version of the package</span>

<span class="sd">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="n">_wire_hash_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;{}.{} -&gt; {}.{}&quot;</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        A newly initialized `Pipeline` will contain no `Component` or wire, just its name and version will be set.</span>

<span class="sd">        The name and version will define together the name of the zip file when the package is saved.</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Name of the package</span>

<span class="sd">            desc (str): Package description (optional)</span>

<span class="sd">            version (str): Version of the package</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">desc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">desc</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">version</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">package_id</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">save_version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">save_package_id</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">author</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;AI SDK&#39;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">wiring</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">periodicity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">timeshift_reference</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">log_level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_set_log_level</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">log_level</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">):</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">log_level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">log_level</span>

<span class="w">        </span><span class="n">_logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_level</span><span class="p">)</span>

<span class="w">    </span><span class="err">@</span><span class="n">staticmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">from_components</span><span class="p">(</span><span class="n">components</span><span class="p">:</span><span class="w"> </span><span class="n">list</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s2">&quot;Pipeline&quot;</span><span class="p">:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Creates a pipeline configuration from the given components.</span>

<span class="sd">        The components are linked in a linear sequence with inputs and outputs auto-wired based on the name of the inputs and outputs of the components.</span>

<span class="sd">        The inputs of the first component will be wired as the pipeline inputs and the outputs of the last component will be wired as the pipeline outputs.</span>

<span class="sd">        The components must have unique names. Two or more versions of the same component can not be packaged simultaneously without renaming them.</span>

<span class="sd">        Args:</span>

<span class="sd">            components (list): List of PythonComponents</span>

<span class="sd">            name (str): Name of the pipeline</span>

<span class="sd">            version (str): Version information of the pipeline. (Optional)</span>

<span class="sd">        Returns:</span>

<span class="sd">            Pipeline: Pipeline object with the auto-wired components</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">pipeline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Pipeline</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="o">=</span><span class="n">desc</span><span class="p">)</span>

<span class="w">        </span><span class="n">first_component</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">components</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="w">        </span><span class="n">pipeline</span><span class="o">.</span><span class="n">add_component</span><span class="p">(</span><span class="n">first_component</span><span class="p">)</span>

<span class="w">        </span><span class="n">pipeline</span><span class="o">.</span><span class="n">inputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[(</span><span class="n">first_component</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">component_input</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">component_input</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">first_component</span><span class="o">.</span><span class="n">inputs</span><span class="p">]</span>

<span class="w">        </span><span class="n">pipeline</span><span class="o">.</span><span class="n">outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[(</span><span class="n">first_component</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">output</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">first_component</span><span class="o">.</span><span class="n">outputs</span><span class="p">]</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">components</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>

<span class="w">            </span><span class="n">pipeline</span><span class="o">.</span><span class="n">add_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">wire_component</span><span class="p">,</span><span class="w"> </span><span class="n">wire_name</span><span class="p">)</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">pipeline</span><span class="o">.</span><span class="n">outputs</span><span class="p">:</span>

<span class="w">                </span><span class="n">try</span><span class="p">:</span>

<span class="w">                    </span><span class="n">pipeline</span><span class="o">.</span><span class="n">add_wiring</span><span class="p">(</span><span class="n">wire_component</span><span class="p">,</span><span class="w"> </span><span class="n">wire_name</span><span class="p">,</span><span class="w"> </span><span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">wire_name</span><span class="p">)</span>

<span class="w">                </span><span class="n">except</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">e</span><span class="p">:</span>

<span class="w">                    </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Output variable {wire_component}.{wire_name} couldn&#39;t be auto-wired.</span><span class="se">\n</span><span class="s2">Cause: {e}&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="n">unwired_variables</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">f</span><span class="s1">&#39;{component.name}.{x}&#39;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">component</span><span class="o">.</span><span class="n">inputs</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">any</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;{component.name}.{x}&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">pipeline</span><span class="o">.</span><span class="n">wiring</span><span class="p">)]</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">unwired_variables</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">unwired_variables</span><span class="p">:</span>

<span class="w">                    </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Input variable {variable} couldn&#39;t be auto-wired.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="n">pipeline</span><span class="o">.</span><span class="n">outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[(</span><span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">output</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">component</span><span class="o">.</span><span class="n">outputs</span><span class="p">]</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">pipeline</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb">str</span><span class="p">:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Textual representation of the configured package.</span>

<span class="sd">        The method shows the `Components` with their inputs, outputs and parameters as well as the wiring between these `Components`.</span>

<span class="sd">        Returns:</span>

<span class="sd">            [str]: Textual representation of the package</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;[{self.__class__.__name__}] {self.name} ({self.version})</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">desc</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">:</span>

<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;{self.desc}</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Pipeline Parameters:</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;- {name} ({parameter[&#39;type&#39;]}, default: &#39;{parameter[&#39;defaultValue&#39;]}&#39;){(&#39;: &#39; + parameter[&#39;desc&#39;]) if parameter.get(&#39;desc&#39;) is not None else &#39;&#39;}</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Pipeline Inputs:</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">:</span>

<span class="w">                </span><span class="n">input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">component</span><span class="p">]</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;&gt; {name} ({input[&#39;type&#39;]}){&#39;: &#39; + input[&#39;desc&#39;] if input.get(&#39;desc&#39;) is not None else &#39;&#39;}</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Pipeline Outputs:</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">:</span>

<span class="w">                </span><span class="n">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">component</span><span class="p">]</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;&lt; {name} ({output[&#39;type&#39;]}){&#39;: &#39; + output[&#39;desc&#39;] if output.get(&#39;desc&#39;) is not None else &#39;&#39;}</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="n">metrics</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">metric</span><span class="p">,</span><span class="w"> </span><span class="n">component_name</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">component_name</span><span class="p">,</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">items</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">PythonComponent</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">metric</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">component</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Metrics:</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">metric</span><span class="p">,</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">metrics</span><span class="p">:</span>

<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;&lt; {name}{&#39;: &#39; + metric[&#39;desc&#39;] if metric.get(&#39;desc&#39;) is not None else &#39;&#39;}</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wiring</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">I/O Wiring:</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">:</span>

<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;  {name} -&gt; {component}.{name}</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">wire_hash</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">wiring</span><span class="p">:</span>

<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;  {wire_hash}</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">:</span>

<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;  {component}.{name} -&gt; {name}</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">metric</span><span class="p">,</span><span class="w"> </span><span class="n">component_name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">metrics</span><span class="p">:</span>

<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;  {component_name}.{name} -&gt; {name}</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">periodicity</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Timeshifting:</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;  Periodicity: {self.periodicity} ms</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timeshift_reference</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;  References:</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="n">ref</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">timeshift_reference</span><span class="p">:</span>

<span class="w">                    </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;  - {ref}</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>

<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">component</span><span class="o">.</span><span class="n">__repr__</span><span class="p">()</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">text</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Defines an input variable on the given component as a pipeline input.</span>

<span class="sd">        Args:</span>

<span class="sd">            component (str): Name of the component</span>

<span class="sd">            variable (str): Name of the input variable</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">try</span><span class="p">:</span>

<span class="w">            </span><span class="n">_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">component</span><span class="p">]</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span>

<span class="w">        </span><span class="n">except</span><span class="w"> </span><span class="n">KeyError</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;The component with input variable must exist in the pipeline.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">)</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;The pipeline input already exists.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">))</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">delete_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">component</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Deletes a pipeline input.</span>

<span class="sd">        Args:</span>

<span class="sd">            component (str): Name of the component</span>

<span class="sd">            variable (str): Name of the input variable</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">)</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;The pipeline input does not exist.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">remove</span><span class="p">((</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">))</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Defines an output variable on the given component as a pipeline output.</span>

<span class="sd">        Args:</span>

<span class="sd">            component (str): Name of the component</span>

<span class="sd">            variable (str): Name of the output variable</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">try</span><span class="p">:</span>

<span class="w">            </span><span class="n">_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">component</span><span class="p">]</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span>

<span class="w">        </span><span class="n">except</span><span class="w"> </span><span class="n">KeyError</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;The component with output variable must exist in the pipeline.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">)</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;The pipeline output already exists.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">))</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">delete_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">component</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Deletes a pipeline output.</span>

<span class="sd">        Args:</span>

<span class="sd">            component (str): Name of the component</span>

<span class="sd">            variable (str): Name of the input variable</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">)</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;The pipeline output does not exist.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">remove</span><span class="p">((</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">))</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_component</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">component</span><span class="p">:</span><span class="w"> </span><span class="n">Component</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Adds a `Component` to the pipeline configuration without any connection.</span>

<span class="sd">        The `Component` can be marked as an input or output component of the pipeline.</span>

<span class="sd">        When these parameters are True, the `Component` is responsible for input or output data of the pipeline.</span>

<span class="sd">        The component must have a unique name. Two or more versions of the same component can not be added to the same pipeline with the same component name.</span>

<span class="sd">        Args:</span>

<span class="sd">            component (Component): `Component` to be added</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Component with name {component.name} already exists. Please rename the component.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">component</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_wiring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">from_component</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">from_output</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">to_component</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">to_input</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Creates a one-to-one connection between the input and output of two components.</span>

<span class="sd">        The method checks if the connection is allowed with the following requirements:</span>

<span class="sd">        - The components exist with the given inputs/outputs</span>

<span class="sd">        - The given inputs and outputs are not connected to any wire</span>

<span class="sd">        - The types of the connected input and output are compatible</span>

<span class="sd">        Args:</span>

<span class="sd">            from_component (str): Name of the component which provides data to the `to_component`</span>

<span class="sd">            from_output (str): Name of the output variable of the `from_component`</span>

<span class="sd">            to_component (str): Name of the component which consumes data from the `from_component`</span>

<span class="sd">            to_input (str): Name of the input variable of the `to_component`</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">from_component</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;No component named &#39;{from_component}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">to_component</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;No component named &#39;{to_component}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">from_output</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">from_component</span><span class="p">]</span><span class="o">.</span><span class="n">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Component &#39;{from_component}&#39; has no output named &#39;{from_output}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">to_input</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">to_component</span><span class="p">]</span><span class="o">.</span><span class="n">inputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Component &#39;{to_component}&#39; has no input named &#39;{to_input}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">get_wire_for_input</span><span class="p">(</span><span class="n">to_component</span><span class="p">,</span><span class="w"> </span><span class="n">to_input</span><span class="p">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Input &#39;{to_input}&#39; of component &#39;{to_component}&#39; is already wired&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">_output_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">from_component</span><span class="p">]</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">from_output</span><span class="p">][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span>

<span class="w">        </span><span class="n">_input_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">to_component</span><span class="p">]</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">to_input</span><span class="p">][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">_output_type</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">_input_type</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;Output and input types do not match&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">wire_hash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_wire_hash_string</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">from_component</span><span class="p">,</span><span class="w"> </span><span class="n">from_output</span><span class="p">,</span><span class="w"> </span><span class="n">to_component</span><span class="p">,</span><span class="w"> </span><span class="n">to_input</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">wiring</span><span class="p">[</span><span class="n">wire_hash</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="s2">&quot;fromComponent&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">from_component</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;fromOutput&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">from_output</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;toComponent&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">to_component</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;toInput&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">to_input</span><span class="p">,</span>

<span class="w">        </span><span class="p">}</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">get_wire_for_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">component_name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">output_name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Searches for the wire which connects a component with `component_name` as data provider through its output with name output_name.</span>

<span class="sd">        Args:</span>

<span class="sd">            component_name (str): Name of the data provider component.</span>

<span class="sd">            output_name (str): Name of the output variable of `component_name`.</span>

<span class="sd">        Returns:</span>

<span class="sd">            [dict]: Wire which contains the data provider and receiver with their names and the names of their variables.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">wires</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">x</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">wiring</span><span class="o">.</span><span class="n">values</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;fromComponent&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">component_name</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;fromOutput&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">output_name</span><span class="p">]</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">wires</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">wires</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">None</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">get_wire_for_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">component_name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">input_name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Searches for the wire which connects a component with `component_name` as data consumer through its input with name `input_name`.</span>

<span class="sd">        Args:</span>

<span class="sd">            component_name (str): Name of the data consumer component.</span>

<span class="sd">            input_name (str): Name of the input variable of `component_name`.</span>

<span class="sd">        Returns:</span>

<span class="sd">            dict: Wire which contains the data provider and receiver with their names and the names of their variables.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">wires</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">x</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">wiring</span><span class="o">.</span><span class="n">values</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;toComponent&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">component_name</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;toInput&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">input_name</span><span class="p">]</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">wires</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">wires</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">None</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">delete_input_wire</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">component</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">with_input</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">True</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Deletes an existing connection between two components.</span>

<span class="sd">        The connection must be given with the name of the consumer component and its input variable.</span>

<span class="sd">        If an inter signal alignment reference variable is affected it cannot be deleted.</span>

<span class="sd">        By default, the input variable will be also deleted.</span>

<span class="sd">        Args:</span>

<span class="sd">            component (str): Name of the component which has the input given the name variable</span>

<span class="sd">            variable (str): Name of the input variable on the component which connected by the wire</span>

<span class="sd">            with_input (bool, optional): If set, the input variable will be also deleted from the component. Defaults to True.</span>

<span class="sd">        Raises:</span>

<span class="sd">            AssertionError: When the variable acts as inter signal alignment reference, it cannot be deleted, and an `AssertionError` will be raised.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">wire</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">get_wire_for_input</span><span class="p">(</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">wire</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;There is no wiring for input &#39;{variable}&#39; of component &#39;{component}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">timeshift_reference</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;Inter signal alignment reference variables can not be deleted.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">wire_hash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_wire_hash_string</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wire</span><span class="p">[</span><span class="s1">&#39;fromComponent&#39;</span><span class="p">],</span><span class="w"> </span><span class="n">wire</span><span class="p">[</span><span class="s1">&#39;fromOutput&#39;</span><span class="p">],</span><span class="w"> </span><span class="n">wire</span><span class="p">[</span><span class="s1">&#39;toComponent&#39;</span><span class="p">],</span><span class="w"> </span><span class="n">wire</span><span class="p">[</span><span class="s1">&#39;toInput&#39;</span><span class="p">])</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">wiring</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">wire_hash</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">with_input</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">component</span><span class="p">]</span><span class="o">.</span><span class="n">delete_input</span><span class="p">(</span><span class="n">variable</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_dependencies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">packages</span><span class="p">:</span><span class="w"> </span><span class="n">list</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        @Deprecated, reason: components can have different Python versions and/or platform, therefore it&#39;s better to specify dependencies on a case-by-case basis.</span>

<span class="sd">        Collects the given Python packages with their versions from the executing Python environment and add them to all components of type `PythonComponent`.</span>

<span class="sd">        This step is necessary in order to execute the pipeline configuration on the Edge side.</span>

<span class="sd">        The method can be called multiple times but each time the previously-collected dependencies are cleared.</span>

<span class="sd">        The reason for this is to ensure a consistent dependency list for the `requirements.txt` file when the package is saved.</span>

<span class="sd">        Args:</span>

<span class="sd">            packages (list): List of the necessary python packages to execute the script defined by self.entrypoint</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">python_components</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">name</span><span class="p">])</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">PythonComponent</span><span class="p">]</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">python_components</span><span class="p">:</span>

<span class="w">            </span><span class="n">component</span><span class="o">.</span><span class="n">add_dependencies</span><span class="p">(</span><span class="n">packages</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">set_timeshifting_periodicity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">periodicity</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Enables inter-signal alignment with the given sampling period.</span>

<span class="sd">        With inter-signal alignment enabled, the AI Inference Server collects data for different input variables before it triggers the model.</span>

<span class="sd">        By default, `startingPoint` property is set to `First timestamp`, which means that inter-signal alignment is started at the</span>

<span class="sd">        first incoming value for any input variable.</span>

<span class="sd">        This property can be changed to `Signal reference` by adding inter-signal alignment reference variables</span>

<span class="sd">        via the `add_timeshifting_reference(..)` method. In this case, inter-signal alignment is started when the first value arrives</span>

<span class="sd">        for the defined input variables.</span>

<span class="sd">        Args:</span>

<span class="sd">            periodicity (int): Periodicity time in milliseconds for the AI Inference Server to perform inter-signal alignment. Valid range is [10, 2^31).</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">periodicity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">(</span><span class="n">periodicity</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">periodicity</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">31</span><span class="p">))):</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;Inter signal alignment periodicity must be an integer and in range [10, 2^31)&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">periodicity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">periodicity</span>

<span class="w">        </span><span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Inter signal alignment periodicity has been set to {self.periodicity}.&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_timeshifting_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">reference</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Enables signal alignment mode `Signal reference` by declaring input variables as reference variables.</span>

<span class="sd">        Args:</span>

<span class="sd">            reference (str): Variable name to be added to `self.timeshift_reference` list.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">reference</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p">[</span><span class="n">name</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">]:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;There is no input variable defined with name &#39;{reference}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">reference</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">timeshift_reference</span><span class="p">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Reference variable with name &#39;{reference}&#39; has been already added.&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="k">return</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">timeshift_reference</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reference</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">remove_timeshifting_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">reference</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Removes previously-defined inter-signal alignment reference variables.</span>

<span class="sd">        If no reference variables remain, the `startingPoint` will be `First timestamp`.</span>

<span class="sd">        Args:</span>

<span class="sd">            reference (str): Variable name to be removed from `self.timeshift_reference` list.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">reference</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">timeshift_reference</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Reference variable with name {&#39;reference&#39;} does not exist.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">timeshift_reference</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">reference</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">get_pipeline_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Saves the information on the composed pipeline configuration package into a YAML file.</span>

<span class="sd">        This YAML file describes the components and the data flow between them for the AI Inference Server.</span>

<span class="sd">        The file is created in the `destination` folder with name `pipeline_config.yml`</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">save_version</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">save_version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">version</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">save_package_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">save_package_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">package_id</span>

<span class="w">        </span><span class="n">pipeline_inputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>

<span class="w">        </span><span class="n">pipeline_inputs</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">[{</span>

<span class="w">            </span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">name</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">component_name</span><span class="p">]</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>

<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">component_name</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">]</span>

<span class="w">        </span><span class="n">pipeline_outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>

<span class="w">        </span><span class="n">pipeline_outputs</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">[{</span>

<span class="w">            </span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">name</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">component_name</span><span class="p">]</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">],</span>

<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">component_name</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">]</span>

<span class="w">        </span><span class="n">pipeline_outputs</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">[{</span>

<span class="w">            </span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">name</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;String&#39;</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;topic&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;/siemens/edge/aiinference/{self.name}/{self.save_version}/metrics/{component_name}/{name}&quot;</span><span class="p">,</span>

<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">component_name</span><span class="p">,</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">items</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">PythonComponent</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">component</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>

<span class="w">        </span><span class="n">pipeline_dag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[{</span>

<span class="w">            </span><span class="s1">&#39;source&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;{wire[&#39;fromComponent&#39;]}.{wire[&#39;fromOutput&#39;]}&quot;</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;target&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;{wire[&#39;toComponent&#39;]}.{wire[&#39;toInput&#39;]}&quot;</span><span class="p">,</span>

<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">wire</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">wiring</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>

<span class="w">        </span><span class="n">pipeline_dag</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">[{</span>

<span class="w">            </span><span class="s1">&#39;source&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">f</span><span class="s1">&#39;Databus.{name}&#39;</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;target&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">f</span><span class="s1">&#39;{component_name}.{name}&#39;</span><span class="p">,</span>

<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">component_name</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">]</span>

<span class="w">        </span><span class="n">pipeline_dag</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">[{</span>

<span class="w">            </span><span class="s1">&#39;source&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">f</span><span class="s1">&#39;{component_name}.{name}&#39;</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;target&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">f</span><span class="s1">&#39;Databus.{name}&#39;</span><span class="p">,</span>

<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">component_name</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">]</span>

<span class="w">        </span><span class="n">pipeline_dag</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">[{</span>

<span class="w">            </span><span class="s1">&#39;source&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">f</span><span class="s1">&#39;{component_name}.{name}&#39;</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;target&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">f</span><span class="s1">&#39;Databus.{name}&#39;</span><span class="p">,</span>

<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">component_name</span><span class="p">,</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">items</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">PythonComponent</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">component</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>

<span class="w">        </span><span class="n">config_yml_content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="s1">&#39;fileFormatVersion&#39;</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;1.2.0&#39;</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;dataFlowPipelineInfo&#39;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>

<span class="w">                </span><span class="s1">&#39;author&#39;</span><span class="p">:</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">author</span><span class="p">,</span>

<span class="w">                </span><span class="s1">&#39;createdOn&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span>

<span class="w">                </span><span class="s1">&#39;dataFlowPipelineVersion&#39;</span><span class="p">:</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">save_version</span><span class="p">,</span>

<span class="w">                </span><span class="s1">&#39;description&#39;</span><span class="p">:</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">desc</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">desc</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Created by AI SDK&#39;</span><span class="p">,</span>

<span class="w">                </span><span class="s1">&#39;projectName&#39;</span><span class="p">:</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>

<span class="w">                </span><span class="s1">&#39;packageId&#39;</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_package_id</span><span class="p">)</span>

<span class="w">            </span><span class="p">},</span>

<span class="w">            </span><span class="s1">&#39;dataFlowPipeline&#39;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>

<span class="w">                </span><span class="s1">&#39;components&#39;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="n">component</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">()</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">values</span><span class="p">()],</span>

<span class="w">                </span><span class="s1">&#39;pipelineDag&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">pipeline_dag</span><span class="p">,</span>

<span class="w">                </span><span class="s1">&#39;pipelineInputs&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">pipeline_inputs</span><span class="p">,</span>

<span class="w">                </span><span class="s1">&#39;pipelineOutputs&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">pipeline_outputs</span><span class="p">,</span>

<span class="w">            </span><span class="p">},</span>

<span class="w">            </span><span class="s1">&#39;packageType&#39;</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;full&#39;</span>

<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">items</span><span class="p">())</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">            </span><span class="n">config_yml_content</span><span class="p">[</span><span class="s2">&quot;dataFlowPipeline&quot;</span><span class="p">][</span><span class="s2">&quot;pipelineParameters&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">parameter</span><span class="p">[</span><span class="s2">&quot;topicBased&quot;</span><span class="p">]:</span>

<span class="w">                    </span><span class="n">config_yml_content</span><span class="p">[</span><span class="s2">&quot;dataFlowPipeline&quot;</span><span class="p">][</span><span class="s2">&quot;pipelineParameters&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>

<span class="w">                        </span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">parameter</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">],</span>

<span class="w">                        </span><span class="s1">&#39;defaultValue&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">parameter</span><span class="p">[</span><span class="s1">&#39;defaultValue&#39;</span><span class="p">],</span>

<span class="w">                        </span><span class="s1">&#39;topicBased&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">parameter</span><span class="p">[</span><span class="s1">&#39;topicBased&#39;</span><span class="p">],</span><span class="w"> </span><span class="s1">&#39;valueTopic&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">parameter</span><span class="p">[</span><span class="s1">&#39;valueTopic&#39;</span><span class="p">]</span>

<span class="w">                    </span><span class="p">})</span>

<span class="w">                </span><span class="k">else</span><span class="p">:</span>

<span class="w">                    </span><span class="n">config_yml_content</span><span class="p">[</span><span class="s2">&quot;dataFlowPipeline&quot;</span><span class="p">][</span><span class="s2">&quot;pipelineParameters&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>

<span class="w">                        </span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">parameter</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">],</span>

<span class="w">                        </span><span class="s1">&#39;defaultValue&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">parameter</span><span class="p">[</span><span class="s1">&#39;defaultValue&#39;</span><span class="p">]</span>

<span class="w">                    </span><span class="p">})</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">config_yml_content</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">save_pipeline_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">destination</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Saves the information about the composed pipeline configuration package into a YAML file.</span>

<span class="sd">        This YAML file describes the components and the data flow between them for AI Inference Server.</span>

<span class="sd">        The file will be created in the `destination` folder with name `pipeline_config.yml`</span>

<span class="sd">        Args:</span>

<span class="sd">            destination (path-like): Path of the `destination` directory.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">with</span><span class="w"> </span><span class="n">open</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">PIPELINE_CONFIG</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;w&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">f</span><span class="p">:</span>

<span class="w">            </span><span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_pipeline_config</span><span class="p">(),</span><span class="w"> </span><span class="n">f</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">get_datalink_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        The method generates metadata information based on available information.</span>

<span class="sd">        Returns:</span>

<span class="sd">            dict: Dictionary with the necessary information for the AI Inference Server.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">timeshifting</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="s2">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">None</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;enabled&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">False</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;periodicity&quot;</span><span class="p">:</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">periodicity</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;startingPoint&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">None</span><span class="p">,</span>

<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">periodicity</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="n">timeshifting</span><span class="p">[</span><span class="s2">&quot;enabled&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">True</span>

<span class="w">            </span><span class="n">timeshifting</span><span class="p">[</span><span class="s2">&quot;startingPoint&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;First timestamp&#39;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timeshift_reference</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">            </span><span class="n">timeshifting</span><span class="p">[</span><span class="s2">&quot;startingPoint&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Signal reference&#39;</span>

<span class="w">        </span><span class="n">exported_metadata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="s2">&quot;fileFormatVersion&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">None</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">None</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;createdOn&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span>

<span class="w">            </span><span class="s2">&quot;updatedOn&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span>

<span class="w">            </span><span class="s2">&quot;timeShifting&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">timeshifting</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;inputs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>

<span class="w">                </span><span class="p">{</span>

<span class="w">                    </span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">_name</span><span class="p">,</span>

<span class="w">                    </span><span class="s1">&#39;mapping&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">None</span><span class="p">,</span>

<span class="w">                    </span><span class="s1">&#39;timeShiftingReference&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">_name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">timeshift_reference</span><span class="p">,</span>

<span class="w">                    </span><span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">_component</span><span class="p">]</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">_name</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>

<span class="w">                </span><span class="p">}</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">_component</span><span class="p">,</span><span class="w"> </span><span class="n">_name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span>

<span class="w">            </span><span class="p">]</span>

<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">exported_metadata</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">save_datalink_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">destination</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Saves metadata for pipeline input variables.</span>

<span class="sd">        This method saves metadata for the AI Inference Server into a YAML file.</span>

<span class="sd">        This metadata determines how the AI Inference Server feeds input to the pipeline, especially inter-signal alignment.</span>

<span class="sd">        The file is created in the `destination` folder with the name `datalink_metadata.yml`</span>

<span class="sd">        Args:</span>

<span class="sd">            destination (path-like): Path of the destination directory.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">with</span><span class="w"> </span><span class="n">open</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">DATALINK_METADATA</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;w&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">f</span><span class="p">:</span>

<span class="w">            </span><span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_datalink_metadata</span><span class="p">(),</span><span class="w"> </span><span class="n">f</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">save_telemetry_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">destination</span><span class="p">:</span><span class="w"> </span><span class="n">Path</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Save telemetry data to a specified destination.</span>

<span class="sd">        Args:</span>

<span class="sd">            destination (Path): The path where the telemetry data should be saved.</span>

<span class="sd">        Returns:</span>

<span class="sd">            None</span>

<span class="sd">        Raises:</span>

<span class="sd">            None</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">telemetry_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">TELEMETRY_YAML</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="p">[</span><span class="s2">&quot;platform&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="p">[</span><span class="s2">&quot;platform&quot;</span><span class="p">][</span><span class="s2">&quot;os&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="p">[</span><span class="s2">&quot;platform&quot;</span><span class="p">][</span><span class="s2">&quot;release&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">platform</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="p">[</span><span class="s2">&quot;platform&quot;</span><span class="p">][</span><span class="s2">&quot;python_version&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">platform</span><span class="o">.</span><span class="n">python_version</span><span class="p">()</span>

<span class="w">        </span><span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;locals: {locals()}&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="p">[</span><span class="s2">&quot;environment&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="p">[</span><span class="s2">&quot;environment&quot;</span><span class="p">][</span><span class="s2">&quot;jupyter&quot;</span><span class="p">]</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="n">any</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">locals</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;__IPYTHON__&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;get_ipython&quot;</span><span class="p">])</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="p">[</span><span class="s2">&quot;environment&quot;</span><span class="p">][</span><span class="s2">&quot;gitlab_ci&quot;</span><span class="p">]</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">True</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="s2">&quot;GITLAB_CI&quot;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">MSG_NOT_FOUND</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="p">[</span><span class="s2">&quot;environment&quot;</span><span class="p">][</span><span class="s2">&quot;azure_devops&quot;</span><span class="p">]</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">True</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="s2">&quot;TF_BUILD&quot;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">MSG_NOT_FOUND</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="p">[</span><span class="s2">&quot;environment&quot;</span><span class="p">][</span><span class="s2">&quot;github_actions&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">True</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="s2">&quot;GITHUB_ACTIONS&quot;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">MSG_NOT_FOUND</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="p">[</span><span class="s2">&quot;industrial_ai&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="p">[</span><span class="s2">&quot;industrial_ai&quot;</span><span class="p">][</span><span class="s2">&quot;simaticai&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MSG_NOT_FOUND</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="p">[</span><span class="s2">&quot;industrial_ai&quot;</span><span class="p">][</span><span class="s2">&quot;vep-template-sdk&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MSG_NOT_FOUND</span>

<span class="w">        </span><span class="n">try</span><span class="p">:</span>

<span class="w">            </span><span class="n">telemetry_data</span><span class="p">[</span><span class="s2">&quot;industrial_ai&quot;</span><span class="p">][</span><span class="s2">&quot;simaticai&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkg_resources</span><span class="o">.</span><span class="n">get_distribution</span><span class="p">(</span><span class="s2">&quot;simaticai&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">version</span>

<span class="w">        </span><span class="n">except</span><span class="w"> </span><span class="n">pkg_resources</span><span class="o">.</span><span class="n">DistributionNotFound</span><span class="p">:</span>

<span class="w">            </span><span class="k">pass</span>

<span class="w">        </span><span class="n">finally</span><span class="p">:</span>

<span class="w">            </span><span class="k">pass</span>

<span class="w">        </span><span class="n">try</span><span class="p">:</span>

<span class="w">            </span><span class="n">telemetry_data</span><span class="p">[</span><span class="s2">&quot;industrial_ai&quot;</span><span class="p">][</span><span class="s2">&quot;vep-template-sdk&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkg_resources</span><span class="o">.</span><span class="n">get_distribution</span><span class="p">(</span><span class="s2">&quot;vep-template-sdk&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">version</span>

<span class="w">        </span><span class="n">except</span><span class="w"> </span><span class="n">pkg_resources</span><span class="o">.</span><span class="n">DistributionNotFound</span><span class="p">:</span>

<span class="w">            </span><span class="k">pass</span>

<span class="w">        </span><span class="n">finally</span><span class="p">:</span>

<span class="w">            </span><span class="k">pass</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="p">[</span><span class="s2">&quot;pipeline&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="p">[</span><span class="s2">&quot;pipeline&quot;</span><span class="p">][</span><span class="s2">&quot;python_versions&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">list</span><span class="p">(</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">component</span><span class="p">]</span><span class="o">.</span><span class="n">python_version</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">component</span><span class="p">],</span><span class="w"> </span><span class="n">PythonComponent</span><span class="p">)))</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="p">[</span><span class="s2">&quot;pipeline&quot;</span><span class="p">][</span><span class="s2">&quot;file_extensions&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">list</span><span class="p">(</span><span class="n">set</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">suffix</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">f</span><span class="o">.</span><span class="n">suffix</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;.zip&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;.yml&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;.yaml&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;.html&quot;</span><span class="p">]))</span>

<span class="w">        </span><span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">telemetry_data</span><span class="p">,</span><span class="w"> </span><span class="n">open</span><span class="p">(</span><span class="n">telemetry_path</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;w&#39;</span><span class="p">))</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">save_readme_html</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">destination</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Saves a `README.html` in the `destination` folder that describes the pipeline.</span>

<span class="sd">        Args:</span>

<span class="sd">            destination (path-like): Path of the destination folder.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">pipelinePage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_PipelinePage</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<span class="w">        </span><span class="n">readme_html_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">README_HTML</span>

<span class="w">        </span><span class="n">readme_html_path</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">pipelinePage</span><span class="o">.</span><span class="n">__str__</span><span class="p">())</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">destination</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Validates whether the package configuration is compatible with the expected runtime environment.</span>

<span class="sd">        The method verifies:</span>

<span class="sd">        - If the package has at least one component</span>

<span class="sd">        - If all wires create connections between existing components and their variables</span>

<span class="sd">        - If metadata is defined and valid.</span>

<span class="sd">        - If a package with the same name already exists in the `destination` folder. In this case a warning message appears and the `save(..)` method overwrites the existing package.</span>

<span class="sd">        - If the package has multiple components and if they are using the same Python version</span>

<span class="sd">        Args:</span>

<span class="sd">            destination (str, optional): Path of the expected destination folder. Defaults to &quot;.&quot;.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;The package must have at least one component.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">batch</span><span class="o">.</span><span class="n">outputBatch</span><span class="p">:</span>

<span class="w">                </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;The component &#39;{name}&#39; has pipeline output defined with variable name &#39;{variable}&#39;. </span><span class="se">\</span>

<span class="w">                                      </span><span class="n">None</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">pipeline</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">allowed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">provide</span><span class="w"> </span><span class="n">batch</span><span class="w"> </span><span class="n">output</span><span class="o">.</span><span class="s2">&quot;)</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">wire_hash</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">wiring</span><span class="o">.</span><span class="n">copy</span><span class="p">():</span>

<span class="w">            </span><span class="n">wire</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">wiring</span><span class="p">[</span><span class="n">wire_hash</span><span class="p">]</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">_check_wiring</span><span class="p">(</span><span class="n">wire</span><span class="p">,</span><span class="w"> </span><span class="n">wire_hash</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">_check_timeshifting</span><span class="p">()</span>

<span class="w">        </span><span class="n">package_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;{self.name}_{self.version}&quot;</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;-&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">package_path</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Target folder ({package_path}) already exists! Unless changing the package name the package could be invalid and your files will be overwritten!&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">python_versions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">set</span><span class="p">()</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">component</span><span class="p">]</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">component</span><span class="p">],</span><span class="w"> </span><span class="n">PythonComponent</span><span class="p">):</span>

<span class="w">                </span><span class="n">python_versions</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">component</span><span class="p">]</span><span class="o">.</span><span class="n">python_version</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">python_versions</span><span class="p">)):</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;The use of multiple python version in a single pipeline is not recommended. We recommend using only one of the supported versions, which are Python 3.10 or 3.11.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Package &#39;{self.name}&#39; is valid and ready to save.&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_check_timeshifting</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timeshift_reference</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">periodicity</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;When using inter signal alignment reference variables, the periodicity must be set.&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_check_wiring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">wire</span><span class="p">,</span><span class="w"> </span><span class="n">wire_hash</span><span class="p">):</span>

<span class="w">        </span><span class="n">error_messages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">wire</span><span class="p">[</span><span class="s1">&#39;fromComponent&#39;</span><span class="p">]</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">:</span>

<span class="w">            </span><span class="n">error_messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;From component {wire[&#39;fromComponent&#39;]} does not exist&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">wire</span><span class="p">[</span><span class="s1">&#39;toComponent&#39;</span><span class="p">]</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">:</span>

<span class="w">            </span><span class="n">error_messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;To component {wire[&#39;toComponent&#39;]} does not exist&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">wire</span><span class="p">[</span><span class="s1">&#39;fromOutput&#39;</span><span class="p">]</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">wire</span><span class="p">[</span><span class="s1">&#39;fromComponent&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">error_messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Output variable {wire[&#39;fromOutput&#39;]} does not exist on component {wire[&#39;fromComponent&#39;]}&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">wire</span><span class="p">[</span><span class="s1">&#39;toInput&#39;</span><span class="p">]</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">wire</span><span class="p">[</span><span class="s1">&#39;toComponent&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">inputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">error_messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Input variable {wire[&#39;toInput&#39;]} does not exist on component {wire[&#39;toComponent&#39;]}&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">error_messages</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">            </span><span class="n">from_type_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">wire</span><span class="p">[</span><span class="s1">&#39;fromComponent&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">wire</span><span class="p">[</span><span class="s1">&#39;fromOutput&#39;</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>

<span class="w">            </span><span class="n">to_type_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">wire</span><span class="p">[</span><span class="s1">&#39;toComponent&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">wire</span><span class="p">[</span><span class="s1">&#39;toInput&#39;</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">from_type_</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">to_type_</span><span class="p">:</span>

<span class="w">                </span><span class="n">error_messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;The types of input and output variables does not match for wiring {wire_hash}.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">error_messages</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">wiring</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">wire_hash</span><span class="p">)</span>

<span class="w">            </span><span class="n">error_messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;The wire has been deleted, please check the variables and re-create the connection.&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">error_messages</span><span class="o">.</span><span class="n">__str__</span><span class="p">())</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">package_id</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Path</span><span class="p">:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        @Deprecated, reason: only edge package generation will be supported in the future. Use export instead.</span>

<span class="sd">        Saves the assembled package in a zip format.</span>

<span class="sd">        The name of the file is defined as `{package_name}_{package_version}.zip`.</span>

<span class="sd">        If a file with such a name already exists in the `destination` folder, it gets overwritten and a warning message appears.</span>

<span class="sd">        The package is also available as a subfolder on the destination path with the name `{package_name}_{package_version}`.</span>

<span class="sd">        If the assembled content does not meet the expected one, this content can be changed and simply packed into a zip file.</span>

<span class="sd">        The package contains files and folders in the following structure:</span>

<span class="sd">        - Package folder with name `{package_name}_{package_version}`</span>

<span class="sd">            - `datalink-metadata.yml`</span>

<span class="sd">            - `pipeline-config.yml`</span>

<span class="sd">            - Component folder with name `{component_name}`</span>

<span class="sd">            When the component is a `PythonComponent`, this folder contains:</span>

<span class="sd">            - `requirements.txt`</span>

<span class="sd">            - Entrypoint script defined by the entrypoint of the component</span>

<span class="sd">            - Extra files as added to the specified folders</span>

<span class="sd">            - Source folder with name `src` with necessary python scripts</span>

<span class="sd">        If a package ID is specified, and a package with the same ID and version is already present in the `destination` folder,</span>

<span class="sd">        an error is raised.</span>

<span class="sd">        Args:</span>

<span class="sd">            destination (str, optional): Target directory for saving the package. Defaults to &quot;.&quot;.</span>

<span class="sd">            package_id (UUID): The optional package ID. If None, a new UUID is generated.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>

<span class="w">        </span><span class="n">destination</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">package_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">package_id</span><span class="p">,</span><span class="w"> </span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">):</span>

<span class="w">            </span><span class="n">package_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">(</span><span class="n">package_id</span><span class="p">)</span>

<span class="w">        </span><span class="n">prev_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span>

<span class="w">        </span><span class="n">prev_id_version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span>

<span class="w">        </span><span class="n">prev_version</span><span class="p">,</span><span class="w"> </span><span class="n">prev_with_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_find_previous</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span><span class="w"> </span><span class="n">package_id</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">prev_with_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="n">prev_id_version</span><span class="p">,</span><span class="w"> </span><span class="n">prev_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prev_with_id</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">package_id</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">prev_id</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="p">(</span><span class="n">version</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">str</span><span class="p">(</span><span class="n">prev_id_version</span><span class="p">):</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">RuntimeError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;package with version &#39;{version or self.version}&#39; and id &#39;{package_id}&#39; already exists&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">save_version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="w"> </span>\

<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="w"> </span>\

<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="s2">&quot;1&quot;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">package_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">prev_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">package_id</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">prev_id</span><span class="w"> </span>\

<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="nb">str</span><span class="p">(</span><span class="n">prev_id_version</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">prev_id_version</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="w"> </span>\

<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="nb">str</span><span class="p">(</span><span class="n">prev_version</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">prev_version</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">prev_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="w"> </span>\

<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="s2">&quot;1&quot;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">save_package_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">package_id</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">package_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="w"> </span>\

<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="n">prev_id</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">prev_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="w"> </span>\

<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span>

<span class="w">        </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;-&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">package_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;{name}_{self.save_version}&quot;</span>

<span class="w">        </span><span class="n">package_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;{package_name}.zip&quot;</span>

<span class="w">        </span><span class="n">specified_version_is_decimal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">version</span><span class="o">.</span><span class="n">isdecimal</span><span class="p">()</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">isdecimal</span><span class="p">()</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">specified_version_is_decimal</span><span class="p">:</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">package_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>

<span class="w">                </span><span class="n">p_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_extract_package_id</span><span class="p">(</span><span class="n">package_file</span><span class="p">,</span><span class="w"> </span><span class="n">False</span><span class="p">)</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">p_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">p_id</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">package_id</span><span class="p">:</span>

<span class="w">                    </span><span class="n">raise</span><span class="w"> </span><span class="n">RuntimeError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;package with version &#39;{self.save_version}&#39; and id &#39;{self.save_package_id}&#39; already exists: &#39;{package_file}&#39;&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="n">edge_package_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;{name}-edge_{self.save_version}.zip&quot;</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">edge_package_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>

<span class="w">                </span><span class="n">p_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_extract_package_id</span><span class="p">(</span><span class="n">edge_package_file</span><span class="p">,</span><span class="w"> </span><span class="n">True</span><span class="p">)</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">p_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">p_id</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">package_id</span><span class="p">:</span>

<span class="w">                    </span><span class="n">raise</span><span class="w"> </span><span class="n">RuntimeError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;package with version &#39;{self.save_version}&#39; and id &#39;{self.save_package_id}&#39; already exists: &#39;{edge_package_file}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">destination</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">package_name</span>

<span class="w">        </span><span class="n">destination</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="n">True</span><span class="p">,</span><span class="w"> </span><span class="n">exist_ok</span><span class="o">=</span><span class="n">True</span><span class="p">)</span>

<span class="w">        </span><span class="c1"># Save</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">component</span><span class="p">]</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span><span class="w"> </span><span class="n">False</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">save_datalink_metadata</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">save_pipeline_config</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">save_readme_html</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">save_telemetry_data</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>

<span class="w">        </span><span class="n">zip_destination</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">shutil</span><span class="o">.</span><span class="n">make_archive</span><span class="p">(</span>

<span class="w">            </span><span class="n">base_name</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">destination</span><span class="o">.</span><span class="n">parent</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">package_name</span><span class="p">),</span><span class="w"> </span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;zip&#39;</span><span class="p">,</span>

<span class="w">            </span><span class="n">root_dir</span><span class="o">=</span><span class="n">destination</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span><span class="w"> </span><span class="n">base_dir</span><span class="o">=</span><span class="n">package_name</span><span class="p">,</span>

<span class="w">            </span><span class="n">verbose</span><span class="o">=</span><span class="n">True</span><span class="p">,</span><span class="w"> </span><span class="n">logger</span><span class="o">=</span><span class="n">_logger</span><span class="p">)</span>

<span class="w">        </span><span class="n">pipeline_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">zip_destination</span><span class="p">)</span><span class="w">  </span><span class="c1"># zipped package size in bytes</span>

<span class="w">        </span><span class="n">pipeline_size_GB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;{:.2f}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pipeline_size</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1000</span><span class="p">)</span>

<span class="w">        </span><span class="n">pipeline_size_limit_GB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;{:.2f}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PIPELINE_SIZE_LIMIT</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1000</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">pipeline_size</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">PIPELINE_SIZE_LIMIT</span><span class="p">:</span>

<span class="w">            </span><span class="n">error_msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;Pipeline size {pipeline_size} bytes ({pipeline_size_GB} GB) exceeds the limit of &quot;</span><span class="w"> </span>\

<span class="w">                        </span><span class="n">f</span><span class="s2">&quot;{PIPELINE_SIZE_LIMIT} bytes ({pipeline_size_limit_GB} GB). &quot;</span><span class="w"> </span>\

<span class="w">                        </span><span class="s2">&quot;Please remove unnecessary files and dependencies and try again.&quot;</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">RuntimeError</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">zip_destination</span><span class="p">)</span>

<span class="w">    </span><span class="c1"># TODO: reduce Cognitive complexity if possible</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_find_previous</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">destination</span><span class="p">:</span><span class="w"> </span><span class="n">Path</span><span class="p">,</span><span class="w"> </span><span class="n">package_id</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Tuple</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="nb nb-Type">int</span><span class="p">],</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb nb-Type">int</span><span class="p">,</span><span class="w"> </span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">]]]:</span>

<span class="w">        </span><span class="n">latest_version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span>

<span class="w">        </span><span class="n">latest_with_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">destination</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>

<span class="w">            </span><span class="n">package_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;-&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">destination</span><span class="o">.</span><span class="n">iterdir</span><span class="p">():</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>

<span class="w">                    </span><span class="k">continue</span>

<span class="w">                </span><span class="k">match</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">re</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;{package_name}(-edge)?_([1-9][0-9]*).zip&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">                    </span><span class="k">continue</span>

<span class="w">                </span><span class="n">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">(</span><span class="k">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

<span class="w">                </span><span class="n">pack_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_extract_package_id</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="k">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">)</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">pack_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="p">(</span><span class="n">package_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">pack_id</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">package_id</span><span class="p">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="p">(</span><span class="n">latest_with_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">latest_with_id</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">version</span><span class="p">):</span>

<span class="w">                    </span><span class="n">latest_with_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">version</span><span class="p">,</span><span class="w"> </span><span class="n">pack_id</span>

<span class="w">                </span><span class="k">elif</span><span class="w"> </span><span class="n">pack_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="p">(</span><span class="n">latest_version</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">latest_version</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">version</span><span class="p">):</span>

<span class="w">                    </span><span class="n">latest_version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">version</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">latest_version</span><span class="p">,</span><span class="w"> </span><span class="n">latest_with_id</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_extract_package_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">package_file</span><span class="p">:</span><span class="w"> </span><span class="n">Path</span><span class="p">,</span><span class="w"> </span><span class="n">is_edge_package</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">]:</span>

<span class="w">        </span><span class="n">try</span><span class="p">:</span>

<span class="w">            </span><span class="n">with</span><span class="w"> </span><span class="n">OpenZipInTemp</span><span class="p">(</span><span class="n">package_file</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">package_dir</span><span class="p">:</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">is_edge_package</span><span class="p">:</span>

<span class="w">                    </span><span class="n">package_dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">package_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">package_file</span><span class="o">.</span><span class="n">stem</span>

<span class="w">                </span><span class="n">with</span><span class="w"> </span><span class="n">open</span><span class="p">(</span><span class="n">package_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s1">&#39;pipeline_config.yml&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">config_file</span><span class="p">:</span>

<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">(</span><span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">config_file</span><span class="p">,</span><span class="w"> </span><span class="n">Loader</span><span class="o">=</span><span class="n">yaml</span><span class="o">.</span><span class="n">SafeLoader</span><span class="p">)[</span><span class="s2">&quot;dataFlowPipelineInfo&quot;</span><span class="p">][</span><span class="s2">&quot;packageId&quot;</span><span class="p">])</span>

<span class="w">        </span><span class="n">except</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">e</span><span class="p">:</span>

<span class="w">            </span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Could not extract Package ID from &#39;{package_file}&#39;: {e}&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="k">export</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">package_id</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Path</span><span class="p">:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Export a runnable pipeline package.</span>

<span class="sd">        Args:</span>

<span class="sd">            destination (str): optional target directory for saving the package. Defaults to &quot;.&quot;.</span>

<span class="sd">            package_id (UUID): optional package ID. If None, a new UUID is generated.</span>

<span class="sd">            version (str): optional version. If None, an automatic version number is generated.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">config_package</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span>

<span class="w">        </span><span class="n">try</span><span class="p">:</span>

<span class="w">            </span><span class="n">config_package</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span><span class="w"> </span><span class="n">package_id</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">)</span>

<span class="w">            </span><span class="n">runtime_package</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">convert_package</span><span class="p">(</span><span class="n">config_package</span><span class="p">)</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">runtime_package</span>

<span class="w">        </span><span class="n">finally</span><span class="p">:</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">config_package</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">                </span><span class="n">Path</span><span class="p">(</span><span class="n">config_package</span><span class="p">)</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">missing_ok</span><span class="o">=</span><span class="n">True</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_parameter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">default_value</span><span class="p">,</span><span class="w"> </span><span class="n">type_name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;String&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">topic_based</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Adds a parameter to the pipeline configuration, which alters the behavior of the pipeline.</span>

<span class="sd">        The parameter&#39;s default value and its properties are saved in the pipeline configuration</span>

<span class="sd">        and the value of the parameter can later be changed on AI Inference Server.</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Name of the parameter</span>

<span class="sd">            desc (str): Description of the parameter (optional)</span>

<span class="sd">            type_name (str, optional): Data type of the parameter. Defaults to &quot;String&quot;.</span>

<span class="sd">            default_value (str): Default value of the parameter</span>

<span class="sd">            topic_based (bool, optional): If true, the parameter can be updated from a message queue.</span>

<span class="sd">        Raises:</span>

<span class="sd">            ValueError:</span>

<span class="sd">                When:</span>

<span class="sd">                - the default value of the parameter is not of the specified data type (`type_name`) or</span>

<span class="sd">                - the specified data type itself is not an allowed data type (not a part of `parameter_types` dict) or</span>

<span class="sd">                - the specified data type is not given in the right format or</span>

<span class="sd">                - the type of the given `topic_based` parameter is not `bool`.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">parameter_types</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="s2">&quot;String&quot;</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;str&#39;</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;Integer&quot;</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;int&#39;</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;Double&quot;</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;float&#39;</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;Boolean&quot;</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;bool&#39;</span>

<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">default_value_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">type</span><span class="p">(</span><span class="n">default_value</span><span class="p">)</span><span class="o">.</span><span class="n">__name__</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">type_name</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">parameter_types</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;The given value type is not supported. Please use one of these: {parameter_types.keys()}&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">default_value_type</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">parameter_types</span><span class="p">[</span><span class="n">type_name</span><span class="p">]:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;The given value type does not match the type of &#39;{type_name}&#39;. Please use the correct one from these: {list(parameter_types.keys())}&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">topic_based</span><span class="p">,</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="p">):</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="s2">&quot;Type of the given `topic_based` parameter is not `bool`.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">name</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">type_name</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;defaultValue&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">default_value</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;topicBased&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">topic_based</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;valueTopic&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">None</span>

<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">desc</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;desc&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">desc</span>

<span class="n">def</span><span class="w"> </span><span class="n">convert_package</span><span class="p">(</span><span class="n">zip_path</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Path</span><span class="p">:</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    @Deprecated, reason: only edge package generation will be supported in the future. Use Pipeline.export(...) instead.</span>

<span class="sd">    Create an Edge Configuration Package from a given Pipeline Configuration Package.</span>

<span class="sd">    If the input zip file is `{path}/{name}_{version}.zip`, the output file will be created as `{path}/{name}-edge_{version}.zip`.</span>

<span class="sd">    Please make sure that the given zip file comes from a trusted source!</span>

<span class="sd">    If a file with such a name already exists, it is overwritten.</span>

<span class="sd">    First, this method verifies that the requirements identified by name and version are either included</span>

<span class="sd">    in `PythonPackages.zip` or available on pypi.org for the target platform.</span>

<span class="sd">    Currently, the supported edge devices run Linux on 64-bit x86 architecture, so the accepted Python libraries are restricted to the platform independent ones and packages built for &#39;x86_64&#39; platforms.</span>

<span class="sd">    AI Inference Server also provides a Python 3.10 and runtime environment, so the supported Python libraries are restricted to Python 3.10 and 3.11 compatible packages.</span>

<span class="sd">    If for the target platform the required dependency is not available on pypi.org</span>

<span class="sd">    and not present in `PythonPackages.zip`,  it will log the problem at ERROR level.</span>

<span class="sd">    Then it downloads all dependencies (either direct or transitive), and creates a new zip</span>

<span class="sd">    file, which is validated against the AI Inference Server&#39;s schema.</span>

<span class="sd">    This functionality requires pip with version of 21.3.1 or greater.</span>

<span class="sd">    This method can be used from the command line too.</span>

<span class="sd">    Example usage:</span>

<span class="sd">    ```</span>

<span class="sd">    python -m simaticai convert_package &lt;path_to_pipeline_configuration_package.zip&gt;</span>

<span class="sd">    ```</span>

<span class="sd">    Args:</span>

<span class="sd">        zip_path (path-like): path to the pipeline configuration package zip file.</span>

<span class="sd">    Returns:</span>

<span class="sd">        os.PathLike: The path of the created zip file.</span>

<span class="sd">    Exceptions:</span>

<span class="sd">        PipelineValidationError: If the validation fails. See the logger output for details.</span>

<span class="sd">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="n">zip_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">zip_path</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">zip_path</span><span class="o">.</span><span class="n">stem</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;The input zip file name must contain an underscore character.&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="n">with</span><span class="w"> </span><span class="n">tempfiles</span><span class="o">.</span><span class="n">OpenZipInTemp</span><span class="p">(</span><span class="n">zip_path</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">zip_dir</span><span class="p">:</span>

<span class="w">        </span><span class="n">top_level_items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">list</span><span class="p">(</span><span class="n">zip_dir</span><span class="o">.</span><span class="n">iterdir</span><span class="p">())</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">top_level_items</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;The Pipeline Configuration Package must contain a single top level directory.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">package_dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zip_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">top_level_items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="w">        </span><span class="n">runtime_dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zip_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s2">&quot;edge_config_package&quot;</span>

<span class="w">        </span><span class="n">runtime_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="n">True</span><span class="p">,</span><span class="w"> </span><span class="n">exist_ok</span><span class="o">=</span><span class="n">True</span><span class="p">)</span>

<span class="w">        </span><span class="n">config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yaml_helper</span><span class="o">.</span><span class="n">read_yaml</span><span class="p">(</span><span class="n">package_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">PIPELINE_CONFIG</span><span class="p">)</span>

<span class="w">        </span><span class="n">_validate_with_schema</span><span class="p">(</span><span class="s2">&quot;input pipeline_config.yml&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">config</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;pipeline.schema.json&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">runtime_config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_generate_runtime_config</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;dataFlowPipeline&#39;</span><span class="p">][</span><span class="s1">&#39;components&#39;</span><span class="p">]:</span>

<span class="w">            </span><span class="n">source_dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">package_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">component</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">component</span><span class="p">[</span><span class="s2">&quot;runtime&quot;</span><span class="p">][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;python&quot;</span><span class="p">:</span>

<span class="w">                </span><span class="n">python_version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">component</span><span class="p">[</span><span class="s1">&#39;runtime&#39;</span><span class="p">][</span><span class="s1">&#39;version&#39;</span><span class="p">]</span>

<span class="w">                </span><span class="n">try</span><span class="p">:</span>

<span class="w">                    </span><span class="n">python_version_validator</span><span class="p">(</span><span class="n">python_version</span><span class="p">)</span>

<span class="w">                </span><span class="n">except</span><span class="w"> </span><span class="n">ValueError</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">error</span><span class="p">:</span>

<span class="w">                    </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>

<span class="w">                </span><span class="n">_package_component_dependencies</span><span class="p">(</span><span class="n">source_dir</span><span class="p">,</span><span class="w"> </span><span class="n">python_version</span><span class="p">)</span>

<span class="w">                </span><span class="n">runtime_config</span><span class="p">[</span><span class="s2">&quot;runtimeConfiguration&quot;</span><span class="p">][</span><span class="s2">&quot;components&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>

<span class="w">                    </span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">component</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>

<span class="w">                    </span><span class="s2">&quot;device&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;IED1&quot;</span><span class="p">,</span>

<span class="w">                    </span><span class="s2">&quot;targetRuntime&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Python&quot;</span><span class="p">,</span>

<span class="w">                </span><span class="p">})</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">component</span><span class="p">[</span><span class="s2">&quot;runtime&quot;</span><span class="p">][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;gpuruntime&quot;</span><span class="p">:</span>

<span class="w">                </span><span class="n">runtime_config</span><span class="p">[</span><span class="s2">&quot;runtimeConfiguration&quot;</span><span class="p">][</span><span class="s2">&quot;components&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>

<span class="w">                    </span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">component</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>

<span class="w">                    </span><span class="s2">&quot;device&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;IED1&quot;</span><span class="p">,</span>

<span class="w">                    </span><span class="s2">&quot;targetRuntime&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;gpuruntime&quot;</span><span class="p">,</span>

<span class="w">                </span><span class="p">})</span>

<span class="w">            </span><span class="n">_package_component</span><span class="p">(</span><span class="n">source_dir</span><span class="p">,</span><span class="w"> </span><span class="n">runtime_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s1">&#39;components&#39;</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;{component[&#39;name&#39;]}_{component[&#39;version&#39;]}&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">package_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">PIPELINE_CONFIG</span><span class="p">),</span><span class="w"> </span><span class="nb">str</span><span class="p">(</span><span class="n">runtime_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">PIPELINE_CONFIG</span><span class="p">))</span>

<span class="w">        </span><span class="n">datalink_metadata_yaml</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">package_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">DATALINK_METADATA</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">datalink_metadata_yaml</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>

<span class="w">            </span><span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">datalink_metadata_yaml</span><span class="p">),</span><span class="w"> </span><span class="n">runtime_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">DATALINK_METADATA</span><span class="p">)</span>

<span class="w">        </span><span class="n">_validate_with_schema</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;generated {RUNTIME_CONFIG}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">runtime_config</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;runtime.schema.json&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">with</span><span class="w"> </span><span class="n">open</span><span class="p">(</span><span class="n">runtime_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">RUNTIME_CONFIG</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">file</span><span class="p">:</span>

<span class="w">            </span><span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">runtime_config</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="p">)</span>

<span class="w">        </span><span class="n">readme_html</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">package_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">README_HTML</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">readme_html</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>

<span class="w">            </span><span class="p">(</span><span class="n">runtime_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">README_HTML</span><span class="p">)</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">readme_html</span><span class="o">.</span><span class="n">read_text</span><span class="p">())</span>

<span class="w">        </span><span class="n">telemetry_yaml</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">package_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">TELEMETRY_YAML</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">telemetry_yaml</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>

<span class="w">            </span><span class="p">(</span><span class="n">runtime_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">TELEMETRY_YAML</span><span class="p">)</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">telemetry_yaml</span><span class="o">.</span><span class="n">read_text</span><span class="p">())</span>

<span class="w">        </span><span class="n">edge_package_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">shutil</span><span class="o">.</span><span class="n">make_archive</span><span class="p">(</span>

<span class="w">            </span><span class="c1"># One Pythonic Way to replace the last occurrence of &quot;_&quot; with &quot;-edge&quot;.</span>

<span class="w">            </span><span class="n">base_name</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">PurePath</span><span class="p">(</span><span class="n">zip_path</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s2">&quot;-edge_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">zip_path</span><span class="o">.</span><span class="n">stem</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">))),</span>

<span class="w">            </span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;zip&#39;</span><span class="p">,</span>

<span class="w">            </span><span class="n">root_dir</span><span class="o">=</span><span class="n">runtime_dir</span><span class="p">,</span>

<span class="w">            </span><span class="n">verbose</span><span class="o">=</span><span class="n">True</span><span class="p">,</span>

<span class="w">            </span><span class="n">logger</span><span class="o">=</span><span class="n">_logger</span><span class="p">))</span>

<span class="w">        </span><span class="n">sha256_hash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">calc_sha</span><span class="p">(</span><span class="n">edge_package_path</span><span class="p">)</span>

<span class="w">        </span><span class="n">sha_format</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;{sha256_hash}  {edge_package_path.name}&quot;</span>

<span class="w">        </span><span class="n">edge_package_path</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.sha256&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">sha_format</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">edge_package_path</span>

<span class="n">def</span><span class="w"> </span><span class="n">_package_component</span><span class="p">(</span><span class="n">source_dir</span><span class="p">,</span><span class="w"> </span><span class="n">target_name</span><span class="p">):</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">shutil</span><span class="o">.</span><span class="n">make_archive</span><span class="p">(</span>

<span class="w">        </span><span class="n">base_name</span><span class="o">=</span><span class="n">target_name</span><span class="p">,</span>

<span class="w">        </span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;zip&#39;</span><span class="p">,</span>

<span class="w">        </span><span class="n">root_dir</span><span class="o">=</span><span class="n">source_dir</span><span class="p">,</span>

<span class="w">        </span><span class="n">verbose</span><span class="o">=</span><span class="n">True</span><span class="p">,</span>

<span class="w">        </span><span class="n">logger</span><span class="o">=</span><span class="n">_logger</span><span class="p">)</span>

<span class="n">def</span><span class="w"> </span><span class="n">_package_component_dependencies</span><span class="p">(</span><span class="n">component_dir</span><span class="p">:</span><span class="w"> </span><span class="n">Path</span><span class="p">,</span><span class="w"> </span><span class="n">python_version</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>

<span class="w">    </span><span class="n">python_packages_folder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">component_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s1">&#39;packages&#39;</span>

<span class="w">    </span><span class="n">requirements_file_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">component_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">REQUIREMENTS_TXT</span>

<span class="w">    </span><span class="n">packages_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">component_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">PYTHON_PACKAGES_ZIP</span>

<span class="w">    </span><span class="n">python_packages_folder</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="n">True</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">packages_file</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>

<span class="w">        </span><span class="n">with</span><span class="w"> </span><span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">packages_file</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">zip_file</span><span class="p">:</span>

<span class="w">            </span><span class="n">zip_file</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">python_packages_folder</span><span class="p">)</span>

<span class="w">        </span><span class="n">packages_file</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>

<span class="w">    </span><span class="n">requirements_file_path</span><span class="o">.</span><span class="n">touch</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="n">True</span><span class="p">)</span>

<span class="w">    </span><span class="n">try</span><span class="p">:</span>

<span class="w">        </span><span class="n">create_wheelhouse</span><span class="p">(</span><span class="n">requirements_file_path</span><span class="p">,</span><span class="w"> </span><span class="n">python_version</span><span class="p">,</span><span class="w"> </span><span class="n">python_packages_folder</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">any</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">python_packages_folder</span><span class="p">)</span><span class="o">.</span><span class="n">iterdir</span><span class="p">()):</span>

<span class="w">            </span><span class="n">shutil</span><span class="o">.</span><span class="n">make_archive</span><span class="p">(</span>

<span class="w">                </span><span class="n">base_name</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">component_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">PYTHON_PACKAGES</span><span class="p">),</span>

<span class="w">                </span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;zip&#39;</span><span class="p">,</span>

<span class="w">                </span><span class="n">root_dir</span><span class="o">=</span><span class="n">python_packages_folder</span><span class="p">,</span>

<span class="w">                </span><span class="n">verbose</span><span class="o">=</span><span class="n">True</span><span class="p">,</span>

<span class="w">                </span><span class="n">logger</span><span class="o">=</span><span class="n">_logger</span><span class="p">)</span>

<span class="w">    </span><span class="n">finally</span><span class="p">:</span>

<span class="w">        </span><span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">python_packages_folder</span><span class="p">)</span>

<span class="w">    </span><span class="c1"># This filtering needs to happen here, not in PythonDependencies,</span>

<span class="w">    </span><span class="c1"># because create_wheelhouse still needs the original requirements.txt</span>

<span class="w">    </span><span class="c1"># with the extra index urls.</span>

<span class="w">    </span><span class="n">with</span><span class="w"> </span><span class="n">open</span><span class="p">(</span><span class="n">requirements_file_path</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;r&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">f</span><span class="p">:</span>

<span class="w">        </span><span class="n">lines</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

<span class="w">    </span><span class="n">filtered_lines</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">list</span><span class="p">(</span><span class="n">filter</span><span class="p">(</span><span class="n">lambda</span><span class="w"> </span><span class="n">x</span><span class="p">:</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;# Extra&quot;</span><span class="p">)</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;--extra-index-url&quot;</span><span class="p">)</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;# Index&quot;</span><span class="p">)</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;--index-url&quot;</span><span class="p">)),</span><span class="w"> </span><span class="n">lines</span><span class="p">))</span>

<span class="w">    </span><span class="n">with</span><span class="w"> </span><span class="n">open</span><span class="p">(</span><span class="n">requirements_file_path</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;w&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">f</span><span class="p">:</span>

<span class="w">        </span><span class="n">f</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">filtered_lines</span><span class="p">)</span>

<span class="n">def</span><span class="w"> </span><span class="n">_generate_runtime_config</span><span class="p">(</span><span class="n">pipeline_config</span><span class="p">:</span><span class="w"> </span><span class="n">dict</span><span class="p">):</span>

<span class="w">    </span><span class="n">project_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pipeline_config</span><span class="p">[</span><span class="s2">&quot;dataFlowPipelineInfo&quot;</span><span class="p">][</span><span class="s2">&quot;projectName&quot;</span><span class="p">]</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="s2">&quot;fileFormatVersion&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1&quot;</span><span class="p">,</span>

<span class="w">        </span><span class="s2">&quot;runtimeInfo&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="s2">&quot;projectName&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">project_name</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;runtimeConfigurationVersion&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;createdOn&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">T%H:%M:%SZ&quot;</span><span class="p">),</span>

<span class="w">        </span><span class="p">},</span>

<span class="w">        </span><span class="s2">&quot;runtimeConfiguration&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="s2">&quot;devices&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span>

<span class="w">                </span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;IED1&quot;</span><span class="p">,</span>

<span class="w">                </span><span class="s2">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span><span class="w">  </span><span class="c1"># Optional</span>

<span class="w">                </span><span class="s2">&quot;arch&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;x86_64&quot;</span><span class="p">,</span><span class="w">  </span><span class="c1"># Optional, TODO: validate target keys</span>

<span class="w">            </span><span class="p">}],</span>

<span class="w">            </span><span class="s2">&quot;components&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span>

<span class="w">        </span><span class="p">},</span>

<span class="w">    </span><span class="p">}</span>

<span class="n">def</span><span class="w"> </span><span class="n">_validate_with_schema</span><span class="p">(</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">:</span><span class="w"> </span><span class="n">dict</span><span class="p">,</span><span class="w"> </span><span class="n">schema</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>

<span class="w">    </span><span class="n">try</span><span class="p">:</span>

<span class="w">        </span><span class="n">jsonschema</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span>

<span class="w">            </span><span class="n">instance</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>

<span class="w">            </span><span class="n">schema</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">module_resources</span><span class="o">.</span><span class="n">open_text</span><span class="p">(</span><span class="s2">&quot;simaticai.data.schemas&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">schema</span><span class="p">))</span>

<span class="w">            </span><span class="c1"># TODO: after upgrading to python 3.9</span>

<span class="w">            </span><span class="c1"># schema=json.load(resources.files(&quot;simaticai&quot;) / &quot;data&quot; / &quot;schemas&quot; / &quot;pipeline.schema.json&quot;)</span>

<span class="w">        </span><span class="p">)</span>

<span class="w">    </span><span class="n">except</span><span class="w"> </span><span class="n">jsonschema</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ValidationError</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">e</span><span class="p">:</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;&quot;&quot;Schema validation failed for {name} using &#39;{schema}&#39;!</span>

<span class="s2">    message: {e.message}</span>

<span class="s2">    $id: {e.schema[&#39;$id&#39;]}</span>

<span class="s2">    title: {e.schema[&#39;title&#39;]}</span>

<span class="s2">    description: {e.schema[&#39;description&#39;]}</span>

<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">None</span>

<span class="n">def</span><span class="w"> </span><span class="n">_get_pipeline_info</span><span class="p">(</span><span class="n">pipeline_config</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>

<span class="w">    </span><span class="n">pipeline_config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yaml_helper</span><span class="o">.</span><span class="n">read_yaml</span><span class="p">(</span><span class="n">pipeline_config</span><span class="p">)</span>

<span class="w">    </span><span class="n">pipeline_info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pipeline_config</span><span class="p">[</span><span class="s2">&quot;dataFlowPipelineInfo&quot;</span><span class="p">]</span>

<span class="w">    </span><span class="n">pipeline_info</span><span class="p">[</span><span class="s2">&quot;packageType&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pipeline_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;packageType&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;full&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="n">pipeline_info</span><span class="p">[</span><span class="s2">&quot;originVersion&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pipeline_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;originVersion&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">None</span><span class="p">)</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">pipeline_info</span>

<span class="n">def</span><span class="w"> </span><span class="n">_validate_delta_package_inputs</span><span class="p">(</span><span class="n">origin_package_info</span><span class="p">:</span><span class="w"> </span><span class="n">dict</span><span class="p">,</span><span class="w"> </span><span class="n">new_package_info</span><span class="p">:</span><span class="w"> </span><span class="n">dict</span><span class="p">):</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">origin_package_info</span><span class="p">[</span><span class="s2">&quot;packageType&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;delta&quot;</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">new_package_info</span><span class="p">[</span><span class="s2">&quot;packageType&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;delta&quot;</span><span class="p">:</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;Neither of the packages can be delta package!&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">origin_package_info</span><span class="p">[</span><span class="s2">&quot;projectName&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">new_package_info</span><span class="p">[</span><span class="s2">&quot;projectName&quot;</span><span class="p">]:</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;The new edge package must have the same name as the origin edge package!&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">origin_package_info</span><span class="p">[</span><span class="s2">&quot;dataFlowPipelineVersion&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">new_package_info</span><span class="p">[</span><span class="s2">&quot;dataFlowPipelineVersion&quot;</span><span class="p">]:</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;The new edge package can not have the same version as the origin edge package!&quot;</span><span class="p">)</span>

<span class="n">def</span><span class="w"> </span><span class="n">_change_pipeline_config</span><span class="p">(</span><span class="n">config_path</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">origin_package_version</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>

<span class="w">    </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yaml_helper</span><span class="o">.</span><span class="n">read_yaml</span><span class="p">(</span><span class="n">config_path</span><span class="p">)</span>

<span class="w">    </span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;packageType&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;delta&quot;</span>

<span class="w">    </span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;originVersion&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">origin_package_version</span>

<span class="w">    </span><span class="n">with</span><span class="w"> </span><span class="n">open</span><span class="p">(</span><span class="n">config_path</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;w&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">f</span><span class="p">:</span>

<span class="w">        </span><span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">)</span>

<span class="n">def</span><span class="w"> </span><span class="n">_extract_edge_package</span><span class="p">(</span><span class="n">edge_package_zip_path</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">path_to_extract</span><span class="p">:</span><span class="w"> </span><span class="n">Path</span><span class="p">):</span>

<span class="w">    </span><span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">edge_package_zip_path</span><span class="p">)</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">path_to_extract</span><span class="p">)</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">path_to_extract</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s2">&quot;*.zip&quot;</span><span class="p">):</span>

<span class="w">        </span><span class="n">component_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">path_to_extract</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s2">&quot;components&quot;</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">f</span><span class="o">.</span><span class="n">stem</span>

<span class="w">        </span><span class="n">packages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">component_path</span><span class="p">,</span><span class="w"> </span><span class="n">PYTHON_PACKAGES_ZIP</span><span class="p">)</span>

<span class="w">        </span><span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">component_path</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">packages</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>

<span class="w">            </span><span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">component_path</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">PYTHON_PACKAGES_ZIP</span><span class="p">)</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">component_path</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">PYTHON_PACKAGES</span><span class="p">)</span>

<span class="w">            </span><span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">packages</span><span class="p">)</span>

<span class="w">        </span><span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">path_to_extract</span>

<span class="n">def</span><span class="w"> </span><span class="n">_copy_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span><span class="w"> </span><span class="n">Path</span><span class="p">,</span><span class="w"> </span><span class="n">from_dir</span><span class="p">:</span><span class="w"> </span><span class="n">Path</span><span class="p">,</span><span class="w"> </span><span class="n">to_dir</span><span class="p">:</span><span class="w"> </span><span class="n">Path</span><span class="p">):</span>

<span class="w">    </span><span class="n">new_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">to_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">file_path</span><span class="o">.</span><span class="n">relative_to</span><span class="p">(</span><span class="n">from_dir</span><span class="p">)</span>

<span class="w">    </span><span class="n">new_path</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="n">True</span><span class="p">,</span><span class="w"> </span><span class="n">exist_ok</span><span class="o">=</span><span class="n">True</span><span class="p">)</span>

<span class="w">    </span><span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span><span class="w"> </span><span class="n">to_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">file_path</span><span class="o">.</span><span class="n">relative_to</span><span class="p">(</span><span class="n">from_dir</span><span class="p">))</span>

<span class="n">def</span><span class="w"> </span><span class="n">create_delta_package</span><span class="p">(</span><span class="n">origin_edge_package_zip_path</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">new_edge_package_zip_path</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Creates a Delta Edge Configuration Package from two given Edge Configuration Packages.</span>

<span class="sd">    The created Delta Configuration Package is applicable to import into AI Inference Server,</span>

<span class="sd">    if the Original Edge Configuration Package is already imported there.</span>

<span class="sd">    The Delta Configuration Package only contains the additions and modifications</span>

<span class="sd">    in the New Edge Configuration Package compared to the Original one.</span>

<span class="sd">    That also means that no file deletion is possible in a deployed pipeline via this option.</span>

<span class="sd">    Please make sure that both of the given zip files come from a trusted source!</span>

<span class="sd">    Usage:</span>

<span class="sd">    ~~~python</span>

<span class="sd">    delta_package_path = deployment.create_delta_package(&#39;Edge-Config-edge-1.0.0.zip&#39;, &#39;Edge-Config-edge-1.1.0.zip&#39;)</span>

<span class="sd">    ~~~</span>

<span class="sd">    This method can be used from the command line, too.</span>

<span class="sd">    ```</span>

<span class="sd">    python -m simaticai create_delta_package &lt;origin_package.zip&gt; &lt;modified_package.zip&gt;</span>

<span class="sd">    ```</span>

<span class="sd">    Once the package is calculated, you will have an `Edge-Config-edge-delta-1.1.0.zip` file beside the updated package zip file.</span>

<span class="sd">    &lt;ul&gt;This package will contain</span>

<span class="sd">    &lt;li&gt;&lt;ul&gt;the three configuration file for the package;</span>

<span class="sd">        &lt;li&gt;pipeline_config.yml&lt;/li&gt;</span>

<span class="sd">        &lt;li&gt;runtime_config.yml&lt;/li&gt;</span>

<span class="sd">        &lt;li&gt;datalink_metadata.yml&lt;/li&gt;</span>

<span class="sd">    &lt;/li&gt;&lt;/ul&gt;</span>

<span class="sd">    &lt;li&gt;the newly added files,&lt;/li&gt;</span>

<span class="sd">    &lt;li&gt;and the updated files.&lt;/li&gt;</span>

<span class="sd">    &lt;/ul&gt;</span>

<span class="sd">    The package will not contain any information on the deleted files and they will be copied from the original pipeline.</span>

<span class="sd">    **Caution!**</span>

<span class="sd">    *If you change the version of a component in the pipeline, the delta package will contain all the files of the component because AI Inference Server identifies</span>

<span class="sd">    a component with a different version as a different component!*</span>

<span class="sd">    Args:</span>

<span class="sd">        origin_edge_package_zip_path (str): Path to the origin edge configuration package zip file.</span>

<span class="sd">        new_edge_package_zip_path (str): Path to the new edge configuration package zip file.</span>

<span class="sd">    Returns:</span>

<span class="sd">        os.PathLike: The path of the created delta edge package zip file.</span>

<span class="sd">    Raises:</span>

<span class="sd">        AssertionError:</span>

<span class="sd">            When:</span>

<span class="sd">            - either of the given edge packages is a delta package or</span>

<span class="sd">            - the names of the given edge packages differ or</span>

<span class="sd">            - the versions of the given edge packages are equal.</span>

<span class="sd">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="n">workdir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;aisdk_deltapack-&quot;</span><span class="p">))</span>

<span class="w">    </span><span class="n">delta_dir</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">workdir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s2">&quot;delta&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="n">delta_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="n">True</span><span class="p">)</span>

<span class="w">    </span><span class="n">origin_dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_extract_edge_package</span><span class="p">(</span><span class="n">origin_edge_package_zip_path</span><span class="p">,</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">workdir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s2">&quot;orig&quot;</span><span class="p">))</span>

<span class="w">    </span><span class="n">new_dir</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">_extract_edge_package</span><span class="p">(</span><span class="n">new_edge_package_zip_path</span><span class="p">,</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">workdir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s2">&quot;new&quot;</span><span class="p">))</span>

<span class="w">    </span><span class="n">origin_package_info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_get_pipeline_info</span><span class="p">(</span><span class="n">origin_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">PIPELINE_CONFIG</span><span class="p">)</span>

<span class="w">    </span><span class="n">new_package_info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_get_pipeline_info</span><span class="p">(</span><span class="n">new_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">PIPELINE_CONFIG</span><span class="p">)</span>

<span class="w">    </span><span class="n">_validate_delta_package_inputs</span><span class="p">(</span><span class="n">origin_package_info</span><span class="p">,</span><span class="w"> </span><span class="n">new_package_info</span><span class="p">)</span>

<span class="w">    </span><span class="n">files_in_new_package</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new_dir</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">files_in_new_package</span><span class="p">:</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">f</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>

<span class="w">            </span><span class="k">continue</span>

<span class="w">        </span><span class="n">orig_file_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">origin_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">f</span><span class="o">.</span><span class="n">relative_to</span><span class="p">(</span><span class="n">new_dir</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">orig_file_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>

<span class="w">            </span><span class="n">_copy_file</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">new_dir</span><span class="p">,</span><span class="w"> </span><span class="n">delta_dir</span><span class="p">)</span>

<span class="w">        </span><span class="k">else</span><span class="p">:</span>

<span class="w">            </span><span class="n">checksum_original</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">calc_sha</span><span class="p">(</span><span class="n">orig_file_path</span><span class="p">)</span>

<span class="w">            </span><span class="n">checksum_new</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">calc_sha</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">checksum_original</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">checksum_new</span><span class="p">:</span>

<span class="w">                </span><span class="n">_copy_file</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">new_dir</span><span class="p">,</span><span class="w"> </span><span class="n">delta_dir</span><span class="p">)</span>

<span class="w">    </span><span class="n">_change_pipeline_config</span><span class="p">(</span><span class="n">delta_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">PIPELINE_CONFIG</span><span class="p">,</span><span class="w"> </span><span class="n">origin_package_info</span><span class="p">[</span><span class="s2">&quot;dataFlowPipelineVersion&quot;</span><span class="p">])</span>

<span class="w">    </span><span class="n">new_edge_package_zip_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">new_edge_package_zip_path</span><span class="p">)</span>

<span class="w">    </span><span class="n">delta_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_zip_delta_package</span><span class="p">(</span><span class="n">delta_dir</span><span class="p">,</span><span class="w"> </span><span class="n">new_edge_package_zip_path</span><span class="p">)</span>

<span class="w">    </span><span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">workdir</span><span class="p">,</span><span class="w"> </span><span class="n">ignore_errors</span><span class="o">=</span><span class="n">True</span><span class="p">)</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">delta_path</span><span class="p">)</span>

<span class="n">def</span><span class="w"> </span><span class="n">_zip_delta_package</span><span class="p">(</span><span class="n">delta_dir</span><span class="p">:</span><span class="w"> </span><span class="n">Path</span><span class="p">,</span><span class="w"> </span><span class="n">new_package_path</span><span class="p">:</span><span class="w"> </span><span class="n">Path</span><span class="p">):</span>

<span class="w">    </span><span class="n">target_folder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new_package_path</span><span class="o">.</span><span class="n">parent</span>

<span class="w">    </span><span class="n">splitted_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">str</span><span class="p">(</span><span class="n">new_package_path</span><span class="o">.</span><span class="n">stem</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="n">target_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">splitted_name</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;_delta_&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">splitted_name</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:])</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">dir</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">delta_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s2">&quot;components&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">):</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">PYTHON_PACKAGES</span><span class="p">)</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>

<span class="w">            </span><span class="n">shutil</span><span class="o">.</span><span class="n">make_archive</span><span class="p">(</span><span class="n">dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">PYTHON_PACKAGES</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;zip&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">PYTHON_PACKAGES</span><span class="p">)</span>

<span class="w">            </span><span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">PYTHON_PACKAGES</span><span class="p">)</span>

<span class="w">        </span><span class="n">shutil</span><span class="o">.</span><span class="n">make_archive</span><span class="p">(</span><span class="n">dir</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;zip&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dir</span><span class="p">)</span>

<span class="w">        </span><span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">dir</span><span class="p">)</span>

<span class="w">    </span><span class="n">delta_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">shutil</span><span class="o">.</span><span class="n">make_archive</span><span class="p">(</span><span class="n">target_folder</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">target_name</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;zip&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">delta_dir</span><span class="p">)</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">delta_path</span>

<span class="k">class</span><span class="w"> </span><span class="n">_PipelinePage</span><span class="p">(</span><span class="n">markup</span><span class="o">.</span><span class="n">page</span><span class="p">):</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">pipeline</span><span class="p">:</span><span class="w"> </span><span class="n">Pipeline</span><span class="p">):</span>

<span class="w">        </span><span class="n">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="s1">&#39;strict_html&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">twotags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;section&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">init</span><span class="p">(</span>

<span class="w">            </span><span class="n">title</span><span class="o">=</span><span class="n">f</span><span class="s2">&quot;{pipeline.name} ({pipeline.version})&quot;</span><span class="p">,</span>

<span class="w">            </span><span class="n">doctype</span><span class="o">=</span><span class="s2">&quot;&lt;!DOCTYPE html&gt;&quot;</span><span class="p">,</span>

<span class="w">            </span><span class="n">charset</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span>

<span class="w">            </span><span class="n">lang</span><span class="o">=</span><span class="s2">&quot;en&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">section</span><span class="p">()</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">h1</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Pipeline {pipeline.name} ({pipeline.version})&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">pipeline</span><span class="o">.</span><span class="n">desc</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">(</span><span class="n">pipeline</span><span class="o">.</span><span class="n">desc</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">html_generate_parameters</span><span class="p">(</span><span class="n">pipeline</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">html_generate_pipeline_inputs</span><span class="p">(</span><span class="n">pipeline</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">html_generate_pipeline_outputs</span><span class="p">(</span><span class="n">pipeline</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">html_generate_io_wiring</span><span class="p">(</span><span class="n">pipeline</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">html_generate_timeshifting</span><span class="p">(</span><span class="n">pipeline</span><span class="p">)</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">pipeline</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">html_generate_components</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">section</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">html_generate_components</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">component</span><span class="p">:</span><span class="w"> </span><span class="n">Component</span><span class="p">):</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">hr</span><span class="p">()</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">section</span><span class="p">()</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">h1</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;{component.__class__.__name__} {component.name}&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">component</span><span class="o">.</span><span class="n">desc</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">desc</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">html_generate_component_inputs</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">html_generate_component_outputs</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">html_generate_metrics</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">issubclass</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span><span class="w"> </span><span class="n">PythonComponent</span><span class="p">):</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">html_generate_resources</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">html_generate_entrypoints</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">section</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">html_generate_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">pipeline</span><span class="p">:</span><span class="w"> </span><span class="n">Pipeline</span><span class="p">):</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">pipeline</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">strong</span><span class="p">(</span><span class="s2">&quot;Parameters&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">ul</span><span class="p">()</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">pipeline</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">li</span><span class="p">()</span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;{name} ({parameter[&#39;type&#39;]}, default: &#39;{parameter[&#39;defaultValue&#39;]}&#39;)&quot;</span><span class="p">)</span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">br</span><span class="p">()</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">parameter</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;desc&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">                    </span><span class="bp">self</span><span class="o">.</span><span class="n">span</span><span class="p">(</span><span class="n">parameter</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">])</span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">li</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">ul</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">html_generate_pipeline_inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">pipeline</span><span class="p">:</span><span class="w"> </span><span class="n">Pipeline</span><span class="p">):</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">pipeline</span><span class="o">.</span><span class="n">inputs</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">strong</span><span class="p">(</span><span class="s2">&quot;Inputs&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">ul</span><span class="p">()</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">pipeline</span><span class="o">.</span><span class="n">inputs</span><span class="p">:</span>

<span class="w">                </span><span class="n">input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pipeline</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">component</span><span class="p">]</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">li</span><span class="p">()</span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;{name} ({input[&#39;type&#39;]})&quot;</span><span class="p">)</span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">br</span><span class="p">()</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">input</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;desc&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">                    </span><span class="bp">self</span><span class="o">.</span><span class="n">span</span><span class="p">(</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">])</span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">li</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">ul</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">html_generate_pipeline_outputs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">pipeline</span><span class="p">:</span><span class="w"> </span><span class="n">Pipeline</span><span class="p">):</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">pipeline</span><span class="o">.</span><span class="n">outputs</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">strong</span><span class="p">(</span><span class="s2">&quot;Outputs&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">ul</span><span class="p">()</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">pipeline</span><span class="o">.</span><span class="n">outputs</span><span class="p">:</span>

<span class="w">                </span><span class="n">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pipeline</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">component</span><span class="p">]</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">li</span><span class="p">()</span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;{name} ({output[&#39;type&#39;]})&quot;</span><span class="p">)</span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">br</span><span class="p">()</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">output</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;desc&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">                    </span><span class="bp">self</span><span class="o">.</span><span class="n">span</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">])</span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">li</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">ul</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">html_generate_component_inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">component</span><span class="p">:</span><span class="w"> </span><span class="n">Component</span><span class="p">):</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">strong</span><span class="p">(</span><span class="s2">&quot;Inputs&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">ul</span><span class="p">()</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">component</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">li</span><span class="p">()</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;{name} ({input[&#39;type&#39;]})&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">br</span><span class="p">()</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">input</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;desc&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">span</span><span class="p">(</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">])</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">li</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">ul</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">html_generate_component_outputs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">component</span><span class="p">:</span><span class="w"> </span><span class="n">Component</span><span class="p">):</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">strong</span><span class="p">(</span><span class="s2">&quot;Outputs&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">ul</span><span class="p">()</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">component</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">li</span><span class="p">()</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;{name} ({output[&#39;type&#39;]})&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">br</span><span class="p">()</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">output</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;desc&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">span</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">])</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">li</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">ul</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">html_generate_io_wiring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">pipeline</span><span class="p">:</span><span class="w"> </span><span class="n">Pipeline</span><span class="p">):</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">pipeline</span><span class="o">.</span><span class="n">wiring</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">strong</span><span class="p">(</span><span class="s2">&quot;I/O Wiring&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">ul</span><span class="p">()</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">pipeline</span><span class="o">.</span><span class="n">inputs</span><span class="p">:</span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">li</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;{name} &amp;#8594; {component}.{name}&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">wire_hash</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">pipeline</span><span class="o">.</span><span class="n">wiring</span><span class="p">:</span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">li</span><span class="p">(</span><span class="n">wire_hash</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&amp;#8594;&quot;</span><span class="p">))</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">pipeline</span><span class="o">.</span><span class="n">outputs</span><span class="p">:</span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">li</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;{component}.{name} &amp;#8594; {name}&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">ul</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">html_generate_timeshifting</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">pipeline</span><span class="p">:</span><span class="w"> </span><span class="n">Pipeline</span><span class="p">):</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">pipeline</span><span class="o">.</span><span class="n">periodicity</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">strong</span><span class="p">(</span><span class="s2">&quot;Timeshifting&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">ul</span><span class="p">()</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">li</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Periodicity: {pipeline.periodicity} ms&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">ul</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">pipeline</span><span class="o">.</span><span class="n">timeshift_reference</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">strong</span><span class="p">(</span><span class="s2">&quot;References&quot;</span><span class="p">)</span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">ul</span><span class="p">()</span>

<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="n">ref</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">pipeline</span><span class="o">.</span><span class="n">timeshift_reference</span><span class="p">:</span>

<span class="w">                    </span><span class="bp">self</span><span class="o">.</span><span class="n">li</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">ul</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">html_generate_resources</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">component</span><span class="p">:</span><span class="w"> </span><span class="n">Component</span><span class="p">):</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">PythonComponent</span><span class="p">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">component</span><span class="o">.</span><span class="n">resources</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">resources</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">strong</span><span class="p">(</span><span class="s2">&quot;Resources&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">ul</span><span class="p">()</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">component</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">li</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;{base}/{path.name}&quot;</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;./&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">))</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">ul</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">html_generate_entrypoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">component</span><span class="p">:</span><span class="w"> </span><span class="n">Component</span><span class="p">):</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">PythonComponent</span><span class="p">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">component</span><span class="o">.</span><span class="n">entrypoint</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">strong</span><span class="p">(</span><span class="s2">&quot;Entrypoint&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">ul</span><span class="p">()</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">li</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">entrypoint</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">ul</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">html_generate_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">component</span><span class="p">:</span><span class="w"> </span><span class="n">Component</span><span class="p">):</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">PythonComponent</span><span class="p">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">component</span><span class="o">.</span><span class="n">metrics</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">metrics</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">strong</span><span class="p">(</span><span class="s2">&quot;Metrics&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">ul</span><span class="p">()</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">metric</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">component</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">li</span><span class="p">()</span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">metric</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;desc&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">                    </span><span class="bp">self</span><span class="o">.</span><span class="n">br</span><span class="p">()</span>

<span class="w">                    </span><span class="bp">self</span><span class="o">.</span><span class="n">span</span><span class="p">(</span><span class="n">metric</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">])</span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">li</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">ul</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="k">class</span><span class="w"> </span><span class="n">GPURuntimeComponent</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    The GPURuntimeComponent is used to define a component that runs on a GPU device.</span>

<span class="sd">    The component works only with ONNX models and can be used in an Inference Pipeline.</span>

<span class="sd">    Attributes:</span>

<span class="sd">        name (str): Component name.</span>

<span class="sd">        version (str): Component version.</span>

<span class="sd">        desc (str): Component description.</span>

<span class="sd">    Methods:</span>

<span class="sd">        use_model(self,</span>

<span class="sd">                    path: Union[Path, str], max_batch_size: int,</span>

<span class="sd">                    optimization: Optional[model_config.TensorRTOptimization] = None,</span>

<span class="sd">                    warmup: model_config.Warmup = None)</span>

<span class="sd">            Add an ONNX model file for the component.</span>

<span class="sd">        use_config(self, path: Union[Path, str])</span>

<span class="sd">            Use a custom config.pbtxt file instead of the autogenerated one.</span>

<span class="sd">        save(self, destination: Union[Path, str], validate = False)</span>

<span class="sd">            Saves the component to a folder structure, so it can be used as part of a pipeline configuration package.</span>

<span class="sd">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;inference&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;1&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Creates a new, empty GPU Runtime component.</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Component name. (default: inference)</span>

<span class="sd">            version (str): Component version. (default: 1)</span>

<span class="sd">            desc (str): Component description (optional)</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="o">=</span><span class="n">desc</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">version</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span><span class="p">:</span><span class="w"> </span><span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span><span class="w"> </span><span class="n">None</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">model_path</span><span class="p">:</span><span class="w"> </span><span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span><span class="w"> </span><span class="n">None</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">model_version</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;1&quot;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">:</span><span class="w"> </span><span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span><span class="w"> </span><span class="n">None</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">auto_config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="o">**</span><span class="n">super</span><span class="p">()</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(),</span>

<span class="w">            </span><span class="s1">&#39;version&#39;</span><span class="p">:</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;entrypoint&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;{self.model_version}/{self.entrypoint.name}&quot;</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;hwType&#39;</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;GPU&#39;</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;runtime&#39;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>

<span class="w">                </span><span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;gpuruntime&#39;</span><span class="p">,</span>

<span class="w">                </span><span class="s1">&#39;version&#39;</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;0.1.0&#39;</span><span class="p">,</span>

<span class="w">            </span><span class="p">}</span>

<span class="w">        </span><span class="p">}</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">use_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="p">:</span><span class="w"> </span><span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span><span class="w"> </span><span class="nb">str</span><span class="p">],</span>

<span class="w">                  </span><span class="n">max_batch_size</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">,</span>

<span class="w">                  </span><span class="n">optimization</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="n">model_config</span><span class="o">.</span><span class="n">TensorRTOptimization</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">,</span>

<span class="w">                  </span><span class="n">warmup</span><span class="p">:</span><span class="w"> </span><span class="n">model_config</span><span class="o">.</span><span class="n">Warmup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Add the ONNX model file for the component.</span>

<span class="sd">        Args:</span>

<span class="sd">            path (Union[Path, str]): The path to the ONNX model file.</span>

<span class="sd">            max_batch_size (int): The maximum batch size for the model.</span>

<span class="sd">            optimization (model_config.TensorRTOptimization, optional): The optimization configuration for the model. Defaults to None.</span>

<span class="sd">            warmup (model_config.Warmup, optional): The warmup configuration for the model. Defaults to None.</span>

<span class="sd">        Raises:</span>

<span class="sd">            AssertionError: If the specified model file is not found, has an invalid extension, or if max_batch_size is less than 0.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">path</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;specified model file not found: &#39;{path}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">path</span><span class="o">.</span><span class="n">suffix</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s2">&quot;.onnx&quot;</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;model file extension is not &#39;.onnx&#39;: &#39;{path}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">max_batch_size</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;max_batch_size must be greater or equal to 0&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;model.onnx&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">model_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">path</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Previously added configuration was removed. Component will use the default configuration unless you specify your own.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span>

<span class="w">        </span><span class="c1"># Remove old automatic variables</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">auto_config</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">auto_config</span><span class="o">.</span><span class="n">inputs</span><span class="p">:</span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">delete_input</span><span class="p">(</span><span class="k">var</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">auto_config</span><span class="o">.</span><span class="n">outputs</span><span class="p">:</span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">delete_output</span><span class="p">(</span><span class="k">var</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">auto_config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">model_config</span><span class="o">.</span><span class="n">ModelConfig</span><span class="p">(</span><span class="n">onnx_path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>

<span class="w">                                                    </span><span class="n">max_batch_size</span><span class="o">=</span><span class="n">max_batch_size</span><span class="p">,</span>

<span class="w">                                                    </span><span class="n">warmup</span><span class="o">=</span><span class="n">warmup</span><span class="p">,</span>

<span class="w">                                                    </span><span class="n">optimization</span><span class="o">=</span><span class="n">optimization</span><span class="p">)</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">auto_config</span><span class="o">.</span><span class="n">inputs</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">add_input</span><span class="p">(</span><span class="k">var</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span><span class="w"> </span><span class="k">var</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">])</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">auto_config</span><span class="o">.</span><span class="n">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="k">var</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span><span class="w"> </span><span class="k">var</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">])</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">use_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="p">:</span><span class="w"> </span><span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span><span class="w"> </span><span class="nb">str</span><span class="p">]):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Sets the configuration file to be used for inference.</span>

<span class="sd">        Intended usage is to use a custom configuration file instead of the autogenerated one.</span>

<span class="sd">        This way extra configurations can be added to the component, such as the execution accelerator.</span>

<span class="sd">        Args:</span>

<span class="sd">            path (Union[Path, str]): The path to the configuration file.</span>

<span class="sd">        Raises:</span>

<span class="sd">            AssertionError: If the specified config file is not found or has an invalid extension.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">path</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;specified config file not found: &#39;{path}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">path</span><span class="o">.</span><span class="n">suffix</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s2">&quot;.pbtxt&quot;</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;config file extension is not &#39;.pbtxt&#39;: &#39;{path}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">_validate_gpuruntime_config</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">path</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">destination</span><span class="p">:</span><span class="w"> </span><span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span><span class="w"> </span><span class="nb">str</span><span class="p">],</span><span class="w"> </span><span class="n">validate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Saves the component to a folder structure, so it can be used as part of a pipeline configuration package.</span>

<span class="sd">        The component folder contains the following:</span>

<span class="sd">        - An `.onnx` model file</span>

<span class="sd">        - A `.pbtxt` configuration file</span>

<span class="sd">        Args:</span>

<span class="sd">            destination (path-like): Target directory to which the component will be saved.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;An ONNX model file must be specified before the component can be saved.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">component_dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">name</span>

<span class="w">        </span><span class="n">component_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">True</span><span class="p">,</span><span class="w"> </span><span class="n">exist_ok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">True</span><span class="p">)</span>

<span class="w">        </span><span class="n">model_dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">component_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">model_version</span>

<span class="w">        </span><span class="n">model_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">True</span><span class="p">)</span>

<span class="w">        </span><span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_path</span><span class="p">,</span><span class="w"> </span><span class="n">model_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s2">&quot;model.onnx&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Configuration was not specified. Model will be saved with default configuration.&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="p">(</span><span class="n">component_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s2">&quot;config.pbtxt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;{self.auto_config}&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">else</span><span class="p">:</span>

<span class="w">            </span><span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">,</span><span class="w"> </span><span class="n">component_dir</span><span class="p">)</span>

<span class="n">def</span><span class="w"> </span><span class="n">_validate_gpuruntime_config</span><span class="p">(</span><span class="n">path</span><span class="p">:</span><span class="w"> </span><span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span><span class="w"> </span><span class="nb">str</span><span class="p">]):</span>

<span class="w">    </span><span class="n">with</span><span class="w"> </span><span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;r&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">file</span><span class="p">:</span>

<span class="w">        </span><span class="n">text_format</span><span class="o">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span><span class="w"> </span><span class="n">model_config_pb2</span><span class="o">.</span><span class="n">ModelConfig</span><span class="p">())</span>
</code></pre></div>

</details>
<h2 id="variables">Variables</h2>
<div class="codehilite"><pre><span></span><code><span class="n">DATALINK_METADATA</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">MSG_NOT_FOUND</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">PIPELINE_CONFIG</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">PIPELINE_SIZE_LIMIT</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">PYTHON_PACKAGES</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">PYTHON_PACKAGES_ZIP</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">README_HTML</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">REQUIREMENTS_TXT</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">RUNTIME_CONFIG</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">TELEMETRY_YAML</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">supported_types</span>
</code></pre></div>

<h2 id="functions">Functions</h2>
<h3 id="convert_package">convert_package</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">convert_package</span><span class="p">(</span>
    <span class="n">zip_path</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span>
</code></pre></div>

<p>@Deprecated, reason: only edge package generation will be supported in the future. Use Pipeline.export(...) instead.</p>
<p>Create an Edge Configuration Package from a given Pipeline Configuration Package.</p>
<p>If the input zip file is <code>{path}/{name}_{version}.zip</code>, the output file will be created as <code>{path}/{name}-edge_{version}.zip</code>.
Please make sure that the given zip file comes from a trusted source!</p>
<p>If a file with such a name already exists, it is overwritten.</p>
<p>First, this method verifies that the requirements identified by name and version are either included
in <code>PythonPackages.zip</code> or available on pypi.org for the target platform.</p>
<p>Currently, the supported edge devices run Linux on 64-bit x86 architecture, so the accepted Python libraries are restricted to the platform independent ones and packages built for 'x86_64' platforms.
AI Inference Server also provides a Python 3.10 and runtime environment, so the supported Python libraries are restricted to Python 3.10 and 3.11 compatible packages.</p>
<p>If for the target platform the required dependency is not available on pypi.org
and not present in <code>PythonPackages.zip</code>,  it will log the problem at ERROR level.
Then it downloads all dependencies (either direct or transitive), and creates a new zip
file, which is validated against the AI Inference Server's schema.
This functionality requires pip with version of 21.3.1 or greater.</p>
<p>This method can be used from the command line too.
Example usage:</p>
<div class="codehilite"><pre><span></span><code><span class="nx">python</span><span class="w"> </span><span class="o">-</span><span class="nx">m</span><span class="w"> </span><span class="nx">simaticai</span><span class="w"> </span><span class="nx">convert_package</span><span class="w"> </span><span class="p">&lt;</span><span class="nx">path_to_pipeline_configuration_package</span><span class="p">.</span><span class="nx">zip</span><span class="p">&gt;</span>
</code></pre></div>

<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>zip_path</td>
<td>path-like</td>
<td>path to the pipeline configuration package zip file.</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>os.PathLike</td>
<td>The path of the created zip file.</td>
</tr>
</tbody>
</table>
<p><strong>Raises:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>PipelineValidationError</td>
<td>If the validation fails. See the logger output for details.</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">convert_package</span><span class="p">(</span><span class="n">zip_path</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Path</span><span class="p">:</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    @Deprecated, reason: only edge package generation will be supported in the future. Use Pipeline.export(...) instead.</span>

<span class="sd">    Create an Edge Configuration Package from a given Pipeline Configuration Package.</span>

<span class="sd">    If the input zip file is `{path}/{name}_{version}.zip`, the output file will be created as `{path}/{name}-edge_{version}.zip`.</span>

<span class="sd">    Please make sure that the given zip file comes from a trusted source!</span>

<span class="sd">    If a file with such a name already exists, it is overwritten.</span>

<span class="sd">    First, this method verifies that the requirements identified by name and version are either included</span>

<span class="sd">    in `PythonPackages.zip` or available on pypi.org for the target platform.</span>

<span class="sd">    Currently, the supported edge devices run Linux on 64-bit x86 architecture, so the accepted Python libraries are restricted to the platform independent ones and packages built for &#39;x86_64&#39; platforms.</span>

<span class="sd">    AI Inference Server also provides a Python 3.10 and runtime environment, so the supported Python libraries are restricted to Python 3.10 and 3.11 compatible packages.</span>

<span class="sd">    If for the target platform the required dependency is not available on pypi.org</span>

<span class="sd">    and not present in `PythonPackages.zip`,  it will log the problem at ERROR level.</span>

<span class="sd">    Then it downloads all dependencies (either direct or transitive), and creates a new zip</span>

<span class="sd">    file, which is validated against the AI Inference Server&#39;s schema.</span>

<span class="sd">    This functionality requires pip with version of 21.3.1 or greater.</span>

<span class="sd">    This method can be used from the command line too.</span>

<span class="sd">    Example usage:</span>

<span class="sd">    ```</span>

<span class="sd">    python -m simaticai convert_package &lt;path_to_pipeline_configuration_package.zip&gt;</span>

<span class="sd">    ```</span>

<span class="sd">    Args:</span>

<span class="sd">        zip_path (path-like): path to the pipeline configuration package zip file.</span>

<span class="sd">    Returns:</span>

<span class="sd">        os.PathLike: The path of the created zip file.</span>

<span class="sd">    Exceptions:</span>

<span class="sd">        PipelineValidationError: If the validation fails. See the logger output for details.</span>

<span class="sd">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="n">zip_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">zip_path</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">zip_path</span><span class="o">.</span><span class="n">stem</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;The input zip file name must contain an underscore character.&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="n">with</span><span class="w"> </span><span class="n">tempfiles</span><span class="o">.</span><span class="n">OpenZipInTemp</span><span class="p">(</span><span class="n">zip_path</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">zip_dir</span><span class="p">:</span>

<span class="w">        </span><span class="n">top_level_items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">list</span><span class="p">(</span><span class="n">zip_dir</span><span class="o">.</span><span class="n">iterdir</span><span class="p">())</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">top_level_items</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;The Pipeline Configuration Package must contain a single top level directory.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">package_dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zip_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">top_level_items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="w">        </span><span class="n">runtime_dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zip_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s2">&quot;edge_config_package&quot;</span>

<span class="w">        </span><span class="n">runtime_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="n">True</span><span class="p">,</span><span class="w"> </span><span class="n">exist_ok</span><span class="o">=</span><span class="n">True</span><span class="p">)</span>

<span class="w">        </span><span class="n">config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yaml_helper</span><span class="o">.</span><span class="n">read_yaml</span><span class="p">(</span><span class="n">package_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">PIPELINE_CONFIG</span><span class="p">)</span>

<span class="w">        </span><span class="n">_validate_with_schema</span><span class="p">(</span><span class="s2">&quot;input pipeline_config.yml&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">config</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;pipeline.schema.json&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">runtime_config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_generate_runtime_config</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;dataFlowPipeline&#39;</span><span class="p">][</span><span class="s1">&#39;components&#39;</span><span class="p">]:</span>

<span class="w">            </span><span class="n">source_dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">package_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">component</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">component</span><span class="p">[</span><span class="s2">&quot;runtime&quot;</span><span class="p">][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;python&quot;</span><span class="p">:</span>

<span class="w">                </span><span class="n">python_version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">component</span><span class="p">[</span><span class="s1">&#39;runtime&#39;</span><span class="p">][</span><span class="s1">&#39;version&#39;</span><span class="p">]</span>

<span class="w">                </span><span class="n">try</span><span class="p">:</span>

<span class="w">                    </span><span class="n">python_version_validator</span><span class="p">(</span><span class="n">python_version</span><span class="p">)</span>

<span class="w">                </span><span class="n">except</span><span class="w"> </span><span class="n">ValueError</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">error</span><span class="p">:</span>

<span class="w">                    </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>

<span class="w">                </span><span class="n">_package_component_dependencies</span><span class="p">(</span><span class="n">source_dir</span><span class="p">,</span><span class="w"> </span><span class="n">python_version</span><span class="p">)</span>

<span class="w">                </span><span class="n">runtime_config</span><span class="p">[</span><span class="s2">&quot;runtimeConfiguration&quot;</span><span class="p">][</span><span class="s2">&quot;components&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>

<span class="w">                    </span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">component</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>

<span class="w">                    </span><span class="s2">&quot;device&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;IED1&quot;</span><span class="p">,</span>

<span class="w">                    </span><span class="s2">&quot;targetRuntime&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Python&quot;</span><span class="p">,</span>

<span class="w">                </span><span class="p">})</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">component</span><span class="p">[</span><span class="s2">&quot;runtime&quot;</span><span class="p">][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;gpuruntime&quot;</span><span class="p">:</span>

<span class="w">                </span><span class="n">runtime_config</span><span class="p">[</span><span class="s2">&quot;runtimeConfiguration&quot;</span><span class="p">][</span><span class="s2">&quot;components&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>

<span class="w">                    </span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">component</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>

<span class="w">                    </span><span class="s2">&quot;device&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;IED1&quot;</span><span class="p">,</span>

<span class="w">                    </span><span class="s2">&quot;targetRuntime&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;gpuruntime&quot;</span><span class="p">,</span>

<span class="w">                </span><span class="p">})</span>

<span class="w">            </span><span class="n">_package_component</span><span class="p">(</span><span class="n">source_dir</span><span class="p">,</span><span class="w"> </span><span class="n">runtime_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s1">&#39;components&#39;</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;{component[&#39;name&#39;]}_{component[&#39;version&#39;]}&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">package_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">PIPELINE_CONFIG</span><span class="p">),</span><span class="w"> </span><span class="nb">str</span><span class="p">(</span><span class="n">runtime_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">PIPELINE_CONFIG</span><span class="p">))</span>

<span class="w">        </span><span class="n">datalink_metadata_yaml</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">package_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">DATALINK_METADATA</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">datalink_metadata_yaml</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>

<span class="w">            </span><span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">datalink_metadata_yaml</span><span class="p">),</span><span class="w"> </span><span class="n">runtime_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">DATALINK_METADATA</span><span class="p">)</span>

<span class="w">        </span><span class="n">_validate_with_schema</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;generated {RUNTIME_CONFIG}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">runtime_config</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;runtime.schema.json&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">with</span><span class="w"> </span><span class="n">open</span><span class="p">(</span><span class="n">runtime_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">RUNTIME_CONFIG</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">file</span><span class="p">:</span>

<span class="w">            </span><span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">runtime_config</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="p">)</span>

<span class="w">        </span><span class="n">readme_html</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">package_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">README_HTML</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">readme_html</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>

<span class="w">            </span><span class="p">(</span><span class="n">runtime_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">README_HTML</span><span class="p">)</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">readme_html</span><span class="o">.</span><span class="n">read_text</span><span class="p">())</span>

<span class="w">        </span><span class="n">telemetry_yaml</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">package_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">TELEMETRY_YAML</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">telemetry_yaml</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>

<span class="w">            </span><span class="p">(</span><span class="n">runtime_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">TELEMETRY_YAML</span><span class="p">)</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">telemetry_yaml</span><span class="o">.</span><span class="n">read_text</span><span class="p">())</span>

<span class="w">        </span><span class="n">edge_package_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">shutil</span><span class="o">.</span><span class="n">make_archive</span><span class="p">(</span>

<span class="w">            </span><span class="c1"># One Pythonic Way to replace the last occurrence of &quot;_&quot; with &quot;-edge&quot;.</span>

<span class="w">            </span><span class="n">base_name</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">PurePath</span><span class="p">(</span><span class="n">zip_path</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s2">&quot;-edge_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">zip_path</span><span class="o">.</span><span class="n">stem</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">))),</span>

<span class="w">            </span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;zip&#39;</span><span class="p">,</span>

<span class="w">            </span><span class="n">root_dir</span><span class="o">=</span><span class="n">runtime_dir</span><span class="p">,</span>

<span class="w">            </span><span class="n">verbose</span><span class="o">=</span><span class="n">True</span><span class="p">,</span>

<span class="w">            </span><span class="n">logger</span><span class="o">=</span><span class="n">_logger</span><span class="p">))</span>

<span class="w">        </span><span class="n">sha256_hash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">calc_sha</span><span class="p">(</span><span class="n">edge_package_path</span><span class="p">)</span>

<span class="w">        </span><span class="n">sha_format</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;{sha256_hash}  {edge_package_path.name}&quot;</span>

<span class="w">        </span><span class="n">edge_package_path</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.sha256&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">sha_format</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">edge_package_path</span>
</code></pre></div>

</details>
<h3 id="create_delta_package">create_delta_package</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">create_delta_package</span><span class="p">(</span>
    <span class="n">origin_edge_package_zip_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">new_edge_package_zip_path</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span>
</code></pre></div>

<p>Creates a Delta Edge Configuration Package from two given Edge Configuration Packages.</p>
<p>The created Delta Configuration Package is applicable to import into AI Inference Server,
if the Original Edge Configuration Package is already imported there.
The Delta Configuration Package only contains the additions and modifications
in the New Edge Configuration Package compared to the Original one.
That also means that no file deletion is possible in a deployed pipeline via this option.
Please make sure that both of the given zip files come from a trusted source!</p>
<p>Usage:</p>
<div class="codehilite"><pre><span></span><code><span class="n">delta_package_path</span> <span class="o">=</span> <span class="n">deployment</span><span class="o">.</span><span class="n">create_delta_package</span><span class="p">(</span><span class="s1">&#39;Edge-Config-edge-1.0.0.zip&#39;</span><span class="p">,</span> <span class="s1">&#39;Edge-Config-edge-1.1.0.zip&#39;</span><span class="p">)</span>
</code></pre></div>

<p>This method can be used from the command line, too.</p>
<div class="codehilite"><pre><span></span><code><span class="nx">python</span><span class="w"> </span><span class="o">-</span><span class="nx">m</span><span class="w"> </span><span class="nx">simaticai</span><span class="w"> </span><span class="nx">create_delta_package</span><span class="w"> </span><span class="p">&lt;</span><span class="nx">origin_package</span><span class="p">.</span><span class="nx">zip</span><span class="p">&gt;</span><span class="w"> </span><span class="p">&lt;</span><span class="nx">modified_package</span><span class="p">.</span><span class="nx">zip</span><span class="p">&gt;</span>
</code></pre></div>

<p>Once the package is calculated, you will have an <code>Edge-Config-edge-delta-1.1.0.zip</code> file beside the updated package zip file.</p>
<ul>This package will contain
<li><ul>the three configuration file for the package;
    <li>pipeline_config.yml</li>
    <li>runtime_config.yml</li>
    <li>datalink_metadata.yml</li>
</li></ul>
<li>the newly added files,</li>
<li>and the updated files.</li>
</ul>
<p>The package will not contain any information on the deleted files and they will be copied from the original pipeline.</p>
<p><strong>Caution!</strong>
<em>If you change the version of a component in the pipeline, the delta package will contain all the files of the component because AI Inference Server identifies
a component with a different version as a different component!</em></p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>origin_edge_package_zip_path</td>
<td>str</td>
<td>Path to the origin edge configuration package zip file.</td>
<td>None</td>
</tr>
<tr>
<td>new_edge_package_zip_path</td>
<td>str</td>
<td>Path to the new edge configuration package zip file.</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>os.PathLike</td>
<td>The path of the created delta edge package zip file.</td>
</tr>
</tbody>
</table>
<p><strong>Raises:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>AssertionError</td>
<td>When:<br/>- either of the given edge packages is a delta package or<br/>- the names of the given edge packages differ or<br/>- the versions of the given edge packages are equal.</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_delta_package</span><span class="p">(</span><span class="n">origin_edge_package_zip_path</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">new_edge_package_zip_path</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>

<span class="w">    </span><span class="s2">&quot;&quot;&quot;</span>

<span class="s2">    Creates a Delta Edge Configuration Package from two given Edge Configuration Packages.</span>

<span class="s2">    The created Delta Configuration Package is applicable to import into AI Inference Server,</span>

<span class="s2">    if the Original Edge Configuration Package is already imported there.</span>

<span class="s2">    The Delta Configuration Package only contains the additions and modifications</span>

<span class="s2">    in the New Edge Configuration Package compared to the Original one.</span>

<span class="s2">    That also means that no file deletion is possible in a deployed pipeline via this option.</span>

<span class="s2">    Please make sure that both of the given zip files come from a trusted source!</span>

<span class="s2">    Usage:</span>

<span class="s2">    ~~~python</span>

<span class="s2">    delta_package_path = deployment.create_delta_package(&#39;Edge-Config-edge-1.0.0.zip&#39;, &#39;Edge-Config-edge-1.1.0.zip&#39;)</span>

<span class="s2">    ~~~</span>

<span class="s2">    This method can be used from the command line, too.</span>

<span class="s2">    ```</span>

<span class="s2">    python -m simaticai create_delta_package &lt;origin_package.zip&gt; &lt;modified_package.zip&gt;</span>

<span class="s2">    ```</span>

<span class="s2">    Once the package is calculated, you will have an `Edge-Config-edge-delta-1.1.0.zip` file beside the updated package zip file.</span>

<span class="s2">    &lt;ul&gt;This package will contain</span>

<span class="s2">    &lt;li&gt;&lt;ul&gt;the three configuration file for the package;</span>

<span class="s2">        &lt;li&gt;pipeline_config.yml&lt;/li&gt;</span>

<span class="s2">        &lt;li&gt;runtime_config.yml&lt;/li&gt;</span>

<span class="s2">        &lt;li&gt;datalink_metadata.yml&lt;/li&gt;</span>

<span class="s2">    &lt;/li&gt;&lt;/ul&gt;</span>

<span class="s2">    &lt;li&gt;the newly added files,&lt;/li&gt;</span>

<span class="s2">    &lt;li&gt;and the updated files.&lt;/li&gt;</span>

<span class="s2">    &lt;/ul&gt;</span>

<span class="s2">    The package will not contain any information on the deleted files and they will be copied from the original pipeline.</span>

<span class="s2">    **Caution!**</span>

<span class="s2">    *If you change the version of a component in the pipeline, the delta package will contain all the files of the component because AI Inference Server identifies</span>

<span class="s2">    a component with a different version as a different component!*</span>

<span class="s2">    Args:</span>

<span class="s2">        origin_edge_package_zip_path (str): Path to the origin edge configuration package zip file.</span>

<span class="s2">        new_edge_package_zip_path (str): Path to the new edge configuration package zip file.</span>

<span class="s2">    Returns:</span>

<span class="s2">        os.PathLike: The path of the created delta edge package zip file.</span>

<span class="s2">    Raises:</span>

<span class="s2">        AssertionError:</span>

<span class="s2">            When:</span>

<span class="s2">            - either of the given edge packages is a delta package or</span>

<span class="s2">            - the names of the given edge packages differ or</span>

<span class="s2">            - the versions of the given edge packages are equal.</span>

<span class="s2">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="n">workdir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;aisdk_deltapack-&quot;</span><span class="p">))</span>

<span class="w">    </span><span class="n">delta_dir</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">workdir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s2">&quot;delta&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="n">delta_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="w">    </span><span class="n">origin_dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_extract_edge_package</span><span class="p">(</span><span class="n">origin_edge_package_zip_path</span><span class="p">,</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">workdir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s2">&quot;orig&quot;</span><span class="p">))</span>

<span class="w">    </span><span class="n">new_dir</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">_extract_edge_package</span><span class="p">(</span><span class="n">new_edge_package_zip_path</span><span class="p">,</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">workdir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s2">&quot;new&quot;</span><span class="p">))</span>

<span class="w">    </span><span class="n">origin_package_info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_get_pipeline_info</span><span class="p">(</span><span class="n">origin_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">PIPELINE_CONFIG</span><span class="p">)</span>

<span class="w">    </span><span class="n">new_package_info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_get_pipeline_info</span><span class="p">(</span><span class="n">new_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">PIPELINE_CONFIG</span><span class="p">)</span>

<span class="w">    </span><span class="n">_validate_delta_package_inputs</span><span class="p">(</span><span class="n">origin_package_info</span><span class="p">,</span><span class="w"> </span><span class="n">new_package_info</span><span class="p">)</span>

<span class="w">    </span><span class="n">files_in_new_package</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new_dir</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">files_in_new_package</span><span class="p">:</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">f</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>

<span class="w">            </span><span class="k">continue</span>

<span class="w">        </span><span class="n">orig_file_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">origin_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">f</span><span class="o">.</span><span class="n">relative_to</span><span class="p">(</span><span class="n">new_dir</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">orig_file_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>

<span class="w">            </span><span class="n">_copy_file</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">new_dir</span><span class="p">,</span><span class="w"> </span><span class="n">delta_dir</span><span class="p">)</span>

<span class="w">        </span><span class="k">else</span><span class="p">:</span>

<span class="w">            </span><span class="n">checksum_original</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">calc_sha</span><span class="p">(</span><span class="n">orig_file_path</span><span class="p">)</span>

<span class="w">            </span><span class="n">checksum_new</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">calc_sha</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">checksum_original</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">checksum_new</span><span class="p">:</span>

<span class="w">                </span><span class="n">_copy_file</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">new_dir</span><span class="p">,</span><span class="w"> </span><span class="n">delta_dir</span><span class="p">)</span>

<span class="w">    </span><span class="n">_change_pipeline_config</span><span class="p">(</span><span class="n">delta_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">PIPELINE_CONFIG</span><span class="p">,</span><span class="w"> </span><span class="n">origin_package_info</span><span class="p">[</span><span class="s2">&quot;dataFlowPipelineVersion&quot;</span><span class="p">])</span>

<span class="w">    </span><span class="n">new_edge_package_zip_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">new_edge_package_zip_path</span><span class="p">)</span>

<span class="w">    </span><span class="n">delta_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_zip_delta_package</span><span class="p">(</span><span class="n">delta_dir</span><span class="p">,</span><span class="w"> </span><span class="n">new_edge_package_zip_path</span><span class="p">)</span>

<span class="w">    </span><span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">workdir</span><span class="p">,</span><span class="w"> </span><span class="n">ignore_errors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">delta_path</span><span class="p">)</span>
</code></pre></div>

</details>
<h3 id="find_dependencies">find_dependencies</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">find_dependencies</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">dependencies</span><span class="p">:</span> <span class="nb">dict</span>
<span class="p">)</span>
</code></pre></div>

<p>@Deprecated, reason: uses 'pip show' which only works for installed packages on the current platform.</p>
<p>Collects all dependencies of the Python module given with its <code>name</code> in the current Python environment.</p>
<p>All inherited dependencies will be added to the <code>dependencies</code> dictionary with the installed version of the module.
The method executes an OS command like <code>python -m pip show scikit-learn</code>.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>str</td>
<td>Name of the Python module to be searched through for its dependencies.</td>
<td>None</td>
</tr>
<tr>
<td>dependencies</td>
<td>dict</td>
<td>Dictionary to collect the dependencies with the module name as key, and the installed version as value.</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>dict</td>
<td>The <code>dependencies</code> dictionary with the collected module names and versions.</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">find_dependencies</span><span class="p">(</span><span class="k">name</span><span class="o">:</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">dependencies</span><span class="o">:</span><span class="w"> </span><span class="n">dict</span><span class="p">)</span><span class="o">:</span>

<span class="w">    </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span>

<span class="s2">    @Deprecated, reason: uses &#39;pip show&#39; which only works for installed packages on the current platform.</span>

<span class="s2">    Collects all dependencies of the Python module given with its `name` in the current Python environment.</span>

<span class="s2">    All inherited dependencies will be added to the `dependencies` dictionary with the installed version of the module.</span>

<span class="s2">    The method executes an OS command like `python -m pip show scikit-learn`.</span>

<span class="s2">    Args:</span>

<span class="s2">        name (str): Name of the Python module to be searched through for its dependencies.</span>

<span class="s2">        dependencies (dict): Dictionary to collect the dependencies with the module name as key, and the installed version as value.</span>

<span class="s2">    Returns:</span>

<span class="s2">        dict: The `dependencies` dictionary with the collected module names and versions.</span>

<span class="s2">    </span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">    </span><span class="n">cmd_line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[</span><span class="n">sys</span><span class="p">.</span><span class="n">executable</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;-m&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;pip&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;show&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="err">]</span>

<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">subprocess</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">cmd_line</span><span class="p">,</span><span class="w"> </span><span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="p">.</span><span class="n">PIPE</span><span class="p">,</span><span class="w"> </span><span class="kt">text</span><span class="o">=</span><span class="no">True</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="n">returncode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span>

<span class="w">        </span><span class="n">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Dependency {name} is not found and cannot be added.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">dependencies</span>

<span class="w">    </span><span class="n">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="n">splitlines</span><span class="p">()</span><span class="o">:</span>

<span class="w">        </span><span class="n">version_matches</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_version_matcher</span><span class="p">.</span><span class="k">match</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">version_matches</span><span class="o">:</span>

<span class="w">            </span><span class="n">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">version_matches</span><span class="p">.</span><span class="k">groups</span><span class="p">()</span><span class="err">[</span><span class="mi">0</span><span class="err">]</span><span class="p">.</span><span class="n">strip</span><span class="p">()</span>

<span class="w">        </span><span class="n">transitive_matches</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_transitive_matcher</span><span class="p">.</span><span class="k">match</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">transitive_matches</span><span class="o">:</span>

<span class="w">            </span><span class="n">transitives</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transitive_matches</span><span class="p">.</span><span class="k">groups</span><span class="p">()</span><span class="err">[</span><span class="mi">0</span><span class="err">]</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">dependency</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">transitives</span><span class="o">:</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">dependency</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">dependencies</span><span class="o">:</span>

<span class="w">                    </span><span class="n">find_dependencies</span><span class="p">(</span><span class="n">dependency</span><span class="p">,</span><span class="w"> </span><span class="n">dependencies</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="k">name</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">dependencies</span><span class="o">:</span>

<span class="w">        </span><span class="n">spec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pep508</span><span class="p">.</span><span class="n">Spec</span><span class="p">(</span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="err">[]</span><span class="p">,</span><span class="w"> </span><span class="err">[</span><span class="p">(</span><span class="s1">&#39;==&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">)</span><span class="err">]</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="err">[]</span><span class="p">,</span><span class="w"> </span><span class="k">None</span><span class="p">)</span>

<span class="w">        </span><span class="n">dependencies</span><span class="err">[</span><span class="k">name</span><span class="err">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spec</span>

<span class="w">        </span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;Found:&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">spec</span><span class="p">)</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">dependencies</span>
</code></pre></div>

</details>
<h3 id="python_version_validator">python_version_validator</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">python_version_validator</span><span class="p">(</span>
    <span class="n">version</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span>
</code></pre></div>

<p>Checks if Python version string is valid and describes supported version.</p>
<p>Only version 3.10 and 3.11 is supported. A patch version is optional and accepted but logs a warning.</p>
<p>Accepted syntaxes are:</p>
<div class="codehilite"><pre><span></span><code>- {major}.{minor}
- {major}.{minor}.{patch}
</code></pre></div>

<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>version</td>
<td>str</td>
<td>Python version string</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Raises:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>ValueError</td>
<td>if the provided version is not supported</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code>def python_version_validator(version: str):

    &quot;&quot;&quot;

    Checks if Python version string is valid and describes supported version.

    Only version 3.10 and 3.11 is supported. A patch version is optional and accepted but logs a warning.

    Accepted syntaxes are:

        <span class="k">-</span> {major}.{minor}

        <span class="k">-</span> {major}.{minor}.{patch}

    Args:

        version (str): Python version string

    Raises:

        ValueError: if the provided version is not supported

    &quot;&quot;&quot;

    supported_versions = [&quot;3.10&quot;, &quot;3.11&quot;]

    error_message = &quot;The defined python version is not supported. Currently supported Python versions are 3.10 and 3.11. Python version must be specified only with major and minor version, e.g. &#39;3.10&#39;.&quot;

    warning_message = &quot;&quot;&quot;Required Python version was specified with patch version.

                Please note that the patch digit of the required Python version is often not taken into account by the Python ecosystem,

                so there is no guarantee it has the desired effect.&quot;&quot;&quot;

    python_version_matcher = re.match(r&#39;^(3)\.(0|[1-9][0-9]*)\.?(0|[1-9][0-9]*)?$&#39;, str(version))

    major_minor_version = &quot;0.0&quot;

    has_patch_version = False

    if python_version_matcher is not None:

        major_minor_version = f&quot;{python_version_matcher.group(1)}.{python_version_matcher.group(2)}&quot;

        has_patch_version = python_version_matcher.group(3) is not None

    if major_minor_version not in supported_versions:

        raise ValueError(error_message)

    if has_patch_version:

        _logger.warning(warning_message)
</code></pre></div>

</details>
<h2 id="classes">Classes</h2>
<h3 id="component">Component</h3>
<p>Base class for pipeline components, with name, description, and a list of inputs and outputs.</p>
<p>A new component is created with the given name and an empty input and output list.</p>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Component</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">desc</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="p">)</span>
</code></pre></div>

<h4 id="attributes">Attributes</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>str</td>
<td>Name of the component</td>
<td>None</td>
</tr>
<tr>
<td>desc</td>
<td>str</td>
<td>Optional description of the component</td>
<td>None</td>
</tr>
<tr>
<td>inputs</td>
<td>dict</td>
<td>Dictionary of (name, type) pairs, which describe the input variables</td>
<td>None</td>
</tr>
<tr>
<td>outputs</td>
<td>dict</td>
<td>Dictionary of (name, type) pairs, which describe the output variables</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="n">Component</span><span class="p">:</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Base class for pipeline components, with name, description, and a list of inputs and outputs.</span>

<span class="sd">    A new component is created with the given name and an empty input and output list.</span>

<span class="sd">    Args:</span>

<span class="sd">        name (str): Name of the component</span>

<span class="sd">        desc (str): Optional description of the component</span>

<span class="sd">        inputs (dict): Dictionary of (name, type) pairs, which describe the input variables</span>

<span class="sd">        outputs (dict): Dictionary of (name, type) pairs, which describe the output variables</span>

<span class="sd">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="n">reserved_names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span>

<span class="w">    </span><span class="err">@</span><span class="n">dataclass</span>

<span class="w">    </span><span class="k">class</span><span class="w"> </span><span class="n">BatchInfo</span><span class="p">:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Batch information for the component.</span>

<span class="sd">        This attribute specifies whether the component can handle batch input or output data.</span>

<span class="sd">        When set to True, the component will receive data in the form of a list of dictionaries instead of a single dictionary.</span>

<span class="sd">        It is important to note that the input and output variables on the component should still be defined as if they are single variables.</span>

<span class="sd">        If the input of the pipeline is configured for batch processing, it is recommended not to configure timeshifting, as the list will have the same timestamp for all elements, potentially resulting in data loss.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">inputBatch</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span>

<span class="w">        </span><span class="n">outputBatch</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>

<span class="w">                </span><span class="s1">&#39;inputBatch&#39;</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Yes&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputBatch</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">True</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;No&#39;</span><span class="p">,</span>

<span class="w">                </span><span class="s1">&#39;outputBatch&#39;</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Yes&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputBatch</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">True</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;No&#39;</span>

<span class="w">            </span><span class="p">}</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Creates a new component with the given name and an empty input and output list.</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Name of the component.</span>

<span class="sd">            desc (str): Optional description of the component</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">desc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">desc</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">batch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">BatchInfo</span><span class="p">(</span><span class="n">False</span><span class="p">,</span><span class="w"> </span><span class="n">False</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb">str</span><span class="p">:</span>

<span class="w">        </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;[{self.__class__.__name__}] {self.name}</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">desc</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">:</span>

<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;{self.desc}</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Component Inputs:</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;&gt; {name} ({input[&#39;type&#39;]}){&#39;: &#39; + input[&#39;desc&#39;] if input.get(&#39;desc&#39;) is not None else &#39;&#39;}</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Component Outputs:</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;&lt; {name} ({output[&#39;type&#39;]}){&#39;: &#39; + output[&#39;desc&#39;] if output.get(&#39;desc&#39;) is not None else &#39;&#39;}</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">text</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">_type</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Adds a new input to the component with its type.</span>

<span class="sd">        Name of the variables cannot be reserved name like &#39;timestamp&#39;.</span>

<span class="sd">        Input variable &#39;timestamp&#39; is a prebuilt key in the payload and its value contains the timestamp when the payload is created by AI Inference Server.</span>

<span class="sd">        Types supported by AI Inference Server version 1.6 are contained in the `type_dictionary`. Newer AI Inference server version may support additional types.</span>

<span class="sd">        In case the type is not known by the AI SDK, a warning message will be printed.</span>

<span class="sd">        The most frequently used types are</span>

<span class="sd">        - String:</span>

<span class="sd">            Typically used for data received from Databus</span>

<span class="sd">        - Object:</span>

<span class="sd">            Object type variables are designed to receive from Vision Connect or transfer images between components</span>

<span class="sd">        - Numeric scalar types:</span>

<span class="sd">            Typically used for data received from S7 Connector</span>

<span class="sd">        The example payload below shows the format of image received from VCA Connector</span>

<span class="sd">        ```python</span>

<span class="sd">            payload = { &quot;image&quot;:</span>

<span class="sd">                {</span>

<span class="sd">                    &quot;resolutionWidth&quot;: image.width,</span>

<span class="sd">                    &quot;resolutionHeight&quot;: image.height,</span>

<span class="sd">                    &quot;mimeType&quot;: [&quot;image/raw&quot;],</span>

<span class="sd">                    &quot;dataType&quot;: &quot;uint8&quot;,</span>

<span class="sd">                    &quot;channelsPerPixel&quot;: 3,</span>

<span class="sd">                    &quot;image&quot;: _swap_bytes(image.tobytes())</span>

<span class="sd">                }</span>

<span class="sd">            }</span>

<span class="sd">        ```</span>

<span class="sd">        Between components the format is the same format as the format of Object as an output.</span>

<span class="sd">        ```python</span>

<span class="sd">            &quot;processedImage&quot;: {</span>

<span class="sd">                &quot;metadata&quot;: json.dumps( {</span>

<span class="sd">                                &quot;resolutionWidth&quot;: image.width,</span>

<span class="sd">                                &quot;resolutionHeight&quot;: image.height</span>

<span class="sd">                                }</span>

<span class="sd">                            ),</span>

<span class="sd">                &quot;bytes&quot;: image.tobytes()</span>

<span class="sd">            }</span>

<span class="sd">        ```</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Name of the new input.</span>

<span class="sd">            _type (str): Type of the new input.</span>

<span class="sd">            desc (str): Description of the input. (optional)</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Input &#39;{name}&#39; already exists.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">reserved_names</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Input &#39;{name}&#39; is a reserved keyword.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">_type</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">supported_types</span><span class="p">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;WARNING! Unknown type &#39;{_type}&#39; for input variable &#39;{name}&#39;. Please check if the target Inference Server supports this type.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">_type</span><span class="p">,</span>

<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">desc</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;desc&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">desc</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">change_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">_type</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Changes one of the inputs of the component.</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Name of the input to be changed.</span>

<span class="sd">            _type (str): New type of the input.</span>

<span class="sd">            desc (str): Description of the input. (optional)</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;There is no input with name &#39;{name}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">_type</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">supported_types</span><span class="p">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;WARNING! Unknown type &#39;{_type}&#39; for input variable &#39;{name}&#39;. Please check if the target Inference Server supports this type.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_type</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">desc</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;desc&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">desc</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">delete_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Deletes an input from the component by name.</span>

<span class="sd">        Once the package has been created with the given component, it is recommended not to change the component directly.</span>

<span class="sd">        Instead, all necessary methods to change it are available through the package to avoid component inconsistencies.</span>

<span class="sd">        It is recommended to use `package.delete_input_wire(...)` with default parameter `with_input=True`.</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Name of the input to be deleted.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Component &#39;{self.name}&#39; has no input &#39;{name}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">_type</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Adds a new output to the component.</span>

<span class="sd">        Types supported by AI Inference Server version 1.6 are contained in the `type_dictionary`. Newer AI Inference server version may support additional types.</span>

<span class="sd">        In case the type is not known by the AI SDK, a warning message will be printed.</span>

<span class="sd">        The most frequently used types are</span>

<span class="sd">        - String:</span>

<span class="sd">            Typically used for data to be sent to Databus</span>

<span class="sd">        - Object:</span>

<span class="sd">            Typically used for images to be sent to ZMQ Connector</span>

<span class="sd">        - Numeric scalar types:</span>

<span class="sd">            Typically used for data sent to S7 Connector</span>

<span class="sd">        For outputs of type `Object` the entrypoint must return with a `dictionary` containing two fields, where one field has type `str` and the other field has type `bytes`.</span>

<span class="sd">        The example below shows the required format, assuming that &#39;image&#39; is a PIL Image.</span>

<span class="sd">        ```python</span>

<span class="sd">            &quot;processedImage&quot;: {</span>

<span class="sd">                &quot;metadata&quot;: json.dumps( {</span>

<span class="sd">                                &quot;resolutionWidth&quot;: image.width,</span>

<span class="sd">                                &quot;resolutionHeight&quot;: image.height</span>

<span class="sd">                                }</span>

<span class="sd">                            ),</span>

<span class="sd">                &quot;bytes&quot;: image.tobytes()</span>

<span class="sd">            }</span>

<span class="sd">        ```</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Name of the new output.</span>

<span class="sd">            _type (str): Type of the new output.</span>

<span class="sd">            desc (str): Description of the output. (optional)</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Output &#39;{name}&#39; already exists&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">_type</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">supported_types</span><span class="p">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;WARNING! Unknown type &#39;{_type}&#39; for input variable &#39;{name}&#39;. Please check if the target Inference Server supports this type.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">_type</span><span class="p">,</span>

<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">desc</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;desc&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">desc</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">change_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">_type</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Changes one of the outputs of the component.</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Name of the output to be changed.</span>

<span class="sd">            _type (str): The new type of the output.</span>

<span class="sd">            desc (str): Description of the output. (optional)</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;There is no output with name &#39;{name}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">_type</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">supported_types</span><span class="p">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;WARNING! Unknown type &#39;{_type}&#39; for input variable &#39;{name}&#39;. Please check if the target Inference Server supports this type.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_type</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">desc</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;desc&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">desc</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">delete_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Deletes an output from the component by name.</span>

<span class="sd">        Once the package has been created with the given component, it is recommended not to change the component directly.</span>

<span class="sd">        Instead, all necessary methods to change it are available through the package to avoid component inconsistencies.</span>

<span class="sd">        Deleting an output which is represented in any wire will cause package inconsistency.</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Name of the output to be deleted.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Component &#39;{self.name}&#39; has no output &#39;{name}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">        </span><span class="n">inputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>

<span class="w">        </span><span class="n">inputs</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">[{</span>

<span class="w">            </span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">name</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">],</span>

<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">]</span>

<span class="w">        </span><span class="n">outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>

<span class="w">        </span><span class="n">outputs</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">[{</span>

<span class="w">            </span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">name</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">],</span>

<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">]</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;description&#39;</span><span class="p">:</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">desc</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;batch&#39;</span><span class="p">:</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">batch</span><span class="o">.</span><span class="n">dict</span><span class="p">(),</span>

<span class="w">            </span><span class="s1">&#39;inputType&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">inputs</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;outputType&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">outputs</span><span class="p">,</span>

<span class="w">        </span><span class="p">}</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Empty method for child classess to implement.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">pass</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">destination</span><span class="p">,</span><span class="w"> </span><span class="n">validate</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Empty method for child classess to implement.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">pass</span>
</code></pre></div>

</details>
<hr />
<h4 id="descendants">Descendants</h4>
<ul>
<li>simaticai.deployment.PythonComponent</li>
<li>simaticai.deployment.GPURuntimeComponent</li>
</ul>
<h4 id="class-variables">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">BatchInfo</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">reserved_names</span>
</code></pre></div>

<h4 id="methods">Methods</h4>
<h4 id="add_input">add_input</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">add_input</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">desc</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

<p>Adds a new input to the component with its type.</p>
<p>Name of the variables cannot be reserved name like 'timestamp'.
Input variable 'timestamp' is a prebuilt key in the payload and its value contains the timestamp when the payload is created by AI Inference Server.</p>
<p>Types supported by AI Inference Server version 1.6 are contained in the <code>type_dictionary</code>. Newer AI Inference server version may support additional types.
In case the type is not known by the AI SDK, a warning message will be printed.
The most frequently used types are
- String:
    Typically used for data received from Databus
- Object:
    Object type variables are designed to receive from Vision Connect or transfer images between components
- Numeric scalar types:
    Typically used for data received from S7 Connector</p>
<p>The example payload below shows the format of image received from VCA Connector</p>
<div class="codehilite"><pre><span></span><code>    <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;image&quot;</span><span class="p">:</span>
        <span class="p">{</span>
            <span class="s2">&quot;resolutionWidth&quot;</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
            <span class="s2">&quot;resolutionHeight&quot;</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
            <span class="s2">&quot;mimeType&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;image/raw&quot;</span><span class="p">],</span>
            <span class="s2">&quot;dataType&quot;</span><span class="p">:</span> <span class="s2">&quot;uint8&quot;</span><span class="p">,</span>
            <span class="s2">&quot;channelsPerPixel&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s2">&quot;image&quot;</span><span class="p">:</span> <span class="n">_swap_bytes</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">tobytes</span><span class="p">())</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div>

<p>Between components the format is the same format as the format of Object as an output.</p>
<div class="codehilite"><pre><span></span><code>    <span class="s2">&quot;processedImage&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span> <span class="p">{</span>
                        <span class="s2">&quot;resolutionWidth&quot;</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
                        <span class="s2">&quot;resolutionHeight&quot;</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">height</span>
                        <span class="p">}</span>
                    <span class="p">),</span>
        <span class="s2">&quot;bytes&quot;</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">tobytes</span><span class="p">()</span>
    <span class="p">}</span>
</code></pre></div>

<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>str</td>
<td>Name of the new input.</td>
<td>None</td>
</tr>
<tr>
<td>_type</td>
<td>str</td>
<td>Type of the new input.</td>
<td>None</td>
</tr>
<tr>
<td>desc</td>
<td>str</td>
<td>Description of the input. (optional)</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">_type</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Adds a new input to the component with its type.</span>

<span class="sd">        Name of the variables cannot be reserved name like &#39;timestamp&#39;.</span>

<span class="sd">        Input variable &#39;timestamp&#39; is a prebuilt key in the payload and its value contains the timestamp when the payload is created by AI Inference Server.</span>

<span class="sd">        Types supported by AI Inference Server version 1.6 are contained in the `type_dictionary`. Newer AI Inference server version may support additional types.</span>

<span class="sd">        In case the type is not known by the AI SDK, a warning message will be printed.</span>

<span class="sd">        The most frequently used types are</span>

<span class="sd">        - String:</span>

<span class="sd">            Typically used for data received from Databus</span>

<span class="sd">        - Object:</span>

<span class="sd">            Object type variables are designed to receive from Vision Connect or transfer images between components</span>

<span class="sd">        - Numeric scalar types:</span>

<span class="sd">            Typically used for data received from S7 Connector</span>

<span class="sd">        The example payload below shows the format of image received from VCA Connector</span>

<span class="sd">        ```python</span>

<span class="sd">            payload = { &quot;image&quot;:</span>

<span class="sd">                {</span>

<span class="sd">                    &quot;resolutionWidth&quot;: image.width,</span>

<span class="sd">                    &quot;resolutionHeight&quot;: image.height,</span>

<span class="sd">                    &quot;mimeType&quot;: [&quot;image/raw&quot;],</span>

<span class="sd">                    &quot;dataType&quot;: &quot;uint8&quot;,</span>

<span class="sd">                    &quot;channelsPerPixel&quot;: 3,</span>

<span class="sd">                    &quot;image&quot;: _swap_bytes(image.tobytes())</span>

<span class="sd">                }</span>

<span class="sd">            }</span>

<span class="sd">        ```</span>

<span class="sd">        Between components the format is the same format as the format of Object as an output.</span>

<span class="sd">        ```python</span>

<span class="sd">            &quot;processedImage&quot;: {</span>

<span class="sd">                &quot;metadata&quot;: json.dumps( {</span>

<span class="sd">                                &quot;resolutionWidth&quot;: image.width,</span>

<span class="sd">                                &quot;resolutionHeight&quot;: image.height</span>

<span class="sd">                                }</span>

<span class="sd">                            ),</span>

<span class="sd">                &quot;bytes&quot;: image.tobytes()</span>

<span class="sd">            }</span>

<span class="sd">        ```</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Name of the new input.</span>

<span class="sd">            _type (str): Type of the new input.</span>

<span class="sd">            desc (str): Description of the input. (optional)</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Input &#39;{name}&#39; already exists.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">reserved_names</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Input &#39;{name}&#39; is a reserved keyword.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">_type</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">supported_types</span><span class="p">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;WARNING! Unknown type &#39;{_type}&#39; for input variable &#39;{name}&#39;. Please check if the target Inference Server supports this type.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">_type</span><span class="p">,</span>

<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">desc</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;desc&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">desc</span>
</code></pre></div>

</details>
<h4 id="add_output">add_output</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">add_output</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">desc</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

<p>Adds a new output to the component.</p>
<p>Types supported by AI Inference Server version 1.6 are contained in the <code>type_dictionary</code>. Newer AI Inference server version may support additional types.
In case the type is not known by the AI SDK, a warning message will be printed.
The most frequently used types are
- String:
    Typically used for data to be sent to Databus
- Object:
    Typically used for images to be sent to ZMQ Connector
- Numeric scalar types:
    Typically used for data sent to S7 Connector</p>
<p>For outputs of type <code>Object</code> the entrypoint must return with a <code>dictionary</code> containing two fields, where one field has type <code>str</code> and the other field has type <code>bytes</code>.
The example below shows the required format, assuming that 'image' is a PIL Image.</p>
<div class="codehilite"><pre><span></span><code>    <span class="s2">&quot;processedImage&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span> <span class="p">{</span>
                        <span class="s2">&quot;resolutionWidth&quot;</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
                        <span class="s2">&quot;resolutionHeight&quot;</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">height</span>
                        <span class="p">}</span>
                    <span class="p">),</span>
        <span class="s2">&quot;bytes&quot;</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">tobytes</span><span class="p">()</span>
    <span class="p">}</span>
</code></pre></div>

<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>str</td>
<td>Name of the new output.</td>
<td>None</td>
</tr>
<tr>
<td>_type</td>
<td>str</td>
<td>Type of the new output.</td>
<td>None</td>
</tr>
<tr>
<td>desc</td>
<td>str</td>
<td>Description of the output. (optional)</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">_type</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Adds a new output to the component.</span>

<span class="sd">        Types supported by AI Inference Server version 1.6 are contained in the `type_dictionary`. Newer AI Inference server version may support additional types.</span>

<span class="sd">        In case the type is not known by the AI SDK, a warning message will be printed.</span>

<span class="sd">        The most frequently used types are</span>

<span class="sd">        - String:</span>

<span class="sd">            Typically used for data to be sent to Databus</span>

<span class="sd">        - Object:</span>

<span class="sd">            Typically used for images to be sent to ZMQ Connector</span>

<span class="sd">        - Numeric scalar types:</span>

<span class="sd">            Typically used for data sent to S7 Connector</span>

<span class="sd">        For outputs of type `Object` the entrypoint must return with a `dictionary` containing two fields, where one field has type `str` and the other field has type `bytes`.</span>

<span class="sd">        The example below shows the required format, assuming that &#39;image&#39; is a PIL Image.</span>

<span class="sd">        ```python</span>

<span class="sd">            &quot;processedImage&quot;: {</span>

<span class="sd">                &quot;metadata&quot;: json.dumps( {</span>

<span class="sd">                                &quot;resolutionWidth&quot;: image.width,</span>

<span class="sd">                                &quot;resolutionHeight&quot;: image.height</span>

<span class="sd">                                }</span>

<span class="sd">                            ),</span>

<span class="sd">                &quot;bytes&quot;: image.tobytes()</span>

<span class="sd">            }</span>

<span class="sd">        ```</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Name of the new output.</span>

<span class="sd">            _type (str): Type of the new output.</span>

<span class="sd">            desc (str): Description of the output. (optional)</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Output &#39;{name}&#39; already exists&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">_type</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">supported_types</span><span class="p">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;WARNING! Unknown type &#39;{_type}&#39; for input variable &#39;{name}&#39;. Please check if the target Inference Server supports this type.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">_type</span><span class="p">,</span>

<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">desc</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;desc&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">desc</span>
</code></pre></div>

</details>
<h4 id="change_input">change_input</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">change_input</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">desc</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

<p>Changes one of the inputs of the component.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>str</td>
<td>Name of the input to be changed.</td>
<td>None</td>
</tr>
<tr>
<td>_type</td>
<td>str</td>
<td>New type of the input.</td>
<td>None</td>
</tr>
<tr>
<td>desc</td>
<td>str</td>
<td>Description of the input. (optional)</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">change_input</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="nl">_type</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="k">desc</span><span class="err">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">str</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Changes one of the inputs of the component.</span>

<span class="ss">        Args:</span>

<span class="ss">            name (str): Name of the input to be changed.</span>

<span class="ss">            _type (str): New type of the input.</span>

<span class="ss">            desc (str): Description of the input. (optional)</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">inputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;There is no input with name &#39;{name}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">_type</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">supported_types</span><span class="p">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="p">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;WARNING! Unknown type &#39;{_type}&#39; for input variable &#39;{name}&#39;. Please check if the target Inference Server supports this type.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">inputs</span><span class="o">[</span><span class="n">name</span><span class="o">][</span><span class="n">&#39;type&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_type</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="k">desc</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">inputs</span><span class="o">[</span><span class="n">name</span><span class="o">][</span><span class="n">&#39;desc&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">desc</span>
</code></pre></div>

</details>
<h4 id="change_output">change_output</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">change_output</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">desc</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

<p>Changes one of the outputs of the component.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>str</td>
<td>Name of the output to be changed.</td>
<td>None</td>
</tr>
<tr>
<td>_type</td>
<td>str</td>
<td>The new type of the output.</td>
<td>None</td>
</tr>
<tr>
<td>desc</td>
<td>str</td>
<td>Description of the output. (optional)</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">change_output</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="nl">_type</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="k">desc</span><span class="err">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">str</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Changes one of the outputs of the component.</span>

<span class="ss">        Args:</span>

<span class="ss">            name (str): Name of the output to be changed.</span>

<span class="ss">            _type (str): The new type of the output.</span>

<span class="ss">            desc (str): Description of the output. (optional)</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;There is no output with name &#39;{name}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">_type</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">supported_types</span><span class="p">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="p">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;WARNING! Unknown type &#39;{_type}&#39; for input variable &#39;{name}&#39;. Please check if the target Inference Server supports this type.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">outputs</span><span class="o">[</span><span class="n">name</span><span class="o">][</span><span class="n">&#39;type&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_type</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="k">desc</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">inputs</span><span class="o">[</span><span class="n">name</span><span class="o">][</span><span class="n">&#39;desc&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">desc</span>
</code></pre></div>

</details>
<h4 id="delete_input">delete_input</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">delete_input</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span>
</code></pre></div>

<p>Deletes an input from the component by name.</p>
<p>Once the package has been created with the given component, it is recommended not to change the component directly.
Instead, all necessary methods to change it are available through the package to avoid component inconsistencies.
It is recommended to use <code>package.delete_input_wire(...)</code> with default parameter <code>with_input=True</code>.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>str</td>
<td>Name of the input to be deleted.</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nx">def</span><span class="w"> </span><span class="nx">delete_input</span><span class="p">(</span><span class="kp">self</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="p">:</span><span class="w"> </span><span class="nx">str</span><span class="p">):</span>

<span class="w">        </span><span class="s">&quot;&quot;&quot;</span>

<span class="s">        Deletes an input from the component by name.</span>

<span class="s">        Once the package has been created with the given component, it is recommended not to change the component directly.</span>

<span class="s">        Instead, all necessary methods to change it are available through the package to avoid component inconsistencies.</span>

<span class="s">        It is recommended to use `package.delete_input_wire(...)` with default parameter `with_input=True`.</span>

<span class="s">        Args:</span>

<span class="s">            name (str): Name of the input to be deleted.</span>

<span class="s">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="kp">self</span><span class="p">.</span><span class="nx">inputs</span><span class="p">:</span>

<span class="w">            </span><span class="nx">raise</span><span class="w"> </span><span class="nx">AssertionError</span><span class="p">(</span><span class="nx">f</span><span class="s">&quot;Component &#39;{self.name}&#39; has no input &#39;{name}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="kp">self</span><span class="p">.</span><span class="nx">inputs</span><span class="p">.</span><span class="nx">pop</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="delete_output">delete_output</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">delete_output</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span>
</code></pre></div>

<p>Deletes an output from the component by name.</p>
<p>Once the package has been created with the given component, it is recommended not to change the component directly.
Instead, all necessary methods to change it are available through the package to avoid component inconsistencies.
Deleting an output which is represented in any wire will cause package inconsistency.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>str</td>
<td>Name of the output to be deleted.</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nx">def</span><span class="w"> </span><span class="nx">delete_output</span><span class="p">(</span><span class="kp">self</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="p">:</span><span class="w"> </span><span class="nx">str</span><span class="p">):</span>

<span class="w">        </span><span class="s">&quot;&quot;&quot;</span>

<span class="s">        Deletes an output from the component by name.</span>

<span class="s">        Once the package has been created with the given component, it is recommended not to change the component directly.</span>

<span class="s">        Instead, all necessary methods to change it are available through the package to avoid component inconsistencies.</span>

<span class="s">        Deleting an output which is represented in any wire will cause package inconsistency.</span>

<span class="s">        Args:</span>

<span class="s">            name (str): Name of the output to be deleted.</span>

<span class="s">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="kp">self</span><span class="p">.</span><span class="nx">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="nx">raise</span><span class="w"> </span><span class="nx">AssertionError</span><span class="p">(</span><span class="nx">f</span><span class="s">&quot;Component &#39;{self.name}&#39; has no output &#39;{name}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="kp">self</span><span class="p">.</span><span class="nx">outputs</span><span class="p">.</span><span class="nx">pop</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="save">save</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">save</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">destination</span><span class="p">,</span>
    <span class="n">validate</span>
<span class="p">)</span>
</code></pre></div>

<p>Empty method for child classess to implement.</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nx">def</span><span class="w"> </span><span class="nx">save</span><span class="p">(</span><span class="kp">self</span><span class="p">,</span><span class="w"> </span><span class="nx">destination</span><span class="p">,</span><span class="w"> </span><span class="nx">validate</span><span class="p">):</span>

<span class="w">        </span><span class="s">&quot;&quot;&quot;</span>

<span class="s">        Empty method for child classess to implement.</span>

<span class="s">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="nx">pass</span>
</code></pre></div>

</details>
<h4 id="validate">validate</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">validate</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<p>Empty method for child classess to implement.</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nx">def</span><span class="w"> </span><span class="nx">validate</span><span class="p">(</span><span class="kp">self</span><span class="p">):</span>

<span class="w">        </span><span class="s">&quot;&quot;&quot;</span>

<span class="s">        Empty method for child classess to implement.</span>

<span class="s">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="nx">pass</span>
</code></pre></div>

</details>
<h3 id="gpuruntimecomponent">GPURuntimeComponent</h3>
<p>The GPURuntimeComponent is used to define a component that runs on a GPU device.</p>
<p>The component works only with ONNX models and can be used in an Inference Pipeline.</p>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">GPURuntimeComponent</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;inference&#39;</span><span class="p">,</span>
    <span class="n">version</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span>
    <span class="n">desc</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="p">)</span>
</code></pre></div>

<h4 id="attributes_1">Attributes</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>str</td>
<td>Component name.</td>
<td>None</td>
</tr>
<tr>
<td>version</td>
<td>str</td>
<td>Component version.</td>
<td>None</td>
</tr>
<tr>
<td>desc</td>
<td>str</td>
<td>Component description.</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nx">GPURuntimeComponent</span><span class="p">(</span><span class="nx">Component</span><span class="p">):</span>

<span class="w">    </span><span class="s">&quot;&quot;&quot;</span>

<span class="s">    The GPURuntimeComponent is used to define a component that runs on a GPU device.</span>

<span class="s">    The component works only with ONNX models and can be used in an Inference Pipeline.</span>

<span class="s">    Attributes:</span>

<span class="s">        name (str): Component name.</span>

<span class="s">        version (str): Component version.</span>

<span class="s">        desc (str): Component description.</span>

<span class="s">    Methods:</span>

<span class="s">        use_model(self,</span>

<span class="s">                    path: Union[Path, str], max_batch_size: int,</span>

<span class="s">                    optimization: Optional[model_config.TensorRTOptimization] = None,</span>

<span class="s">                    warmup: model_config.Warmup = None)</span>

<span class="s">            Add an ONNX model file for the component.</span>

<span class="s">        use_config(self, path: Union[Path, str])</span>

<span class="s">            Use a custom config.pbtxt file instead of the autogenerated one.</span>

<span class="s">        save(self, destination: Union[Path, str], validate = False)</span>

<span class="s">            Saves the component to a folder structure, so it can be used as part of a pipeline configuration package.</span>

<span class="s">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="nx">def</span><span class="w"> </span><span class="nx">__init__</span><span class="p">(</span><span class="kp">self</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="p">:</span><span class="w"> </span><span class="nx">str</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;inference&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">version</span><span class="p">:</span><span class="w"> </span><span class="nx">str</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">desc</span><span class="p">:</span><span class="w"> </span><span class="nx">str</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">):</span>

<span class="w">        </span><span class="s">&quot;&quot;&quot;</span>

<span class="s">        Creates a new, empty GPU Runtime component.</span>

<span class="s">        Args:</span>

<span class="s">            name (str): Component name. (default: inference)</span>

<span class="s">            version (str): Component version. (default: 1)</span>

<span class="s">            desc (str): Component description (optional)</span>

<span class="s">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="nx">super</span><span class="p">().</span><span class="nx">__init__</span><span class="p">(</span><span class="nx">name</span><span class="p">=</span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">desc</span><span class="p">=</span><span class="nx">desc</span><span class="p">)</span>

<span class="w">        </span><span class="kp">self</span><span class="p">.</span><span class="nx">version</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">version</span>

<span class="w">        </span><span class="kp">self</span><span class="p">.</span><span class="nx">entrypoint</span><span class="p">:</span><span class="w"> </span><span class="nx">Union</span><span class="p">[</span><span class="nx">Path</span><span class="p">,</span><span class="w"> </span><span class="nx">None</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">None</span>

<span class="w">        </span><span class="kp">self</span><span class="p">.</span><span class="nx">model_path</span><span class="p">:</span><span class="w"> </span><span class="nx">Union</span><span class="p">[</span><span class="nx">Path</span><span class="p">,</span><span class="w"> </span><span class="nx">None</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">None</span>

<span class="w">        </span><span class="kp">self</span><span class="p">.</span><span class="nx">model_version</span><span class="p">:</span><span class="w"> </span><span class="nx">str</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;1&quot;</span>

<span class="w">        </span><span class="kp">self</span><span class="p">.</span><span class="nx">config</span><span class="p">:</span><span class="w"> </span><span class="nx">Union</span><span class="p">[</span><span class="nx">Path</span><span class="p">,</span><span class="w"> </span><span class="nx">None</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">None</span>

<span class="w">        </span><span class="kp">self</span><span class="p">.</span><span class="nx">auto_config</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">None</span>

<span class="w">    </span><span class="nx">def</span><span class="w"> </span><span class="nx">_to_dict</span><span class="p">(</span><span class="kp">self</span><span class="p">):</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="o">**</span><span class="nx">super</span><span class="p">().</span><span class="nx">_to_dict</span><span class="p">(),</span>

<span class="w">            </span><span class="err">&#39;</span><span class="nx">version</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="kp">self</span><span class="p">.</span><span class="nx">version</span><span class="p">,</span>

<span class="w">            </span><span class="err">&#39;</span><span class="nx">entrypoint</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="nx">f</span><span class="s">&quot;{self.model_version}/{self.entrypoint.name}&quot;</span><span class="p">,</span>

<span class="w">            </span><span class="err">&#39;</span><span class="nx">hwType</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">GPU</span><span class="err">&#39;</span><span class="p">,</span>

<span class="w">            </span><span class="err">&#39;</span><span class="nx">runtime</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>

<span class="w">                </span><span class="err">&#39;</span><span class="k">type</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">gpuruntime</span><span class="err">&#39;</span><span class="p">,</span>

<span class="w">                </span><span class="err">&#39;</span><span class="nx">version</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;</span><span class="m m-Double">0.1.0</span><span class="err">&#39;</span><span class="p">,</span>

<span class="w">            </span><span class="p">}</span>

<span class="w">        </span><span class="p">}</span>

<span class="w">    </span><span class="nx">def</span><span class="w"> </span><span class="nx">use_model</span><span class="p">(</span><span class="kp">self</span><span class="p">,</span><span class="w"> </span><span class="nx">path</span><span class="p">:</span><span class="w"> </span><span class="nx">Union</span><span class="p">[</span><span class="nx">Path</span><span class="p">,</span><span class="w"> </span><span class="nx">str</span><span class="p">],</span>

<span class="w">                  </span><span class="nx">max_batch_size</span><span class="p">:</span><span class="w"> </span><span class="nx">int</span><span class="p">,</span>

<span class="w">                  </span><span class="nx">optimization</span><span class="p">:</span><span class="w"> </span><span class="nx">Optional</span><span class="p">[</span><span class="nx">model_config</span><span class="p">.</span><span class="nx">TensorRTOptimization</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">None</span><span class="p">,</span>

<span class="w">                  </span><span class="nx">warmup</span><span class="p">:</span><span class="w"> </span><span class="nx">model_config</span><span class="p">.</span><span class="nx">Warmup</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">None</span><span class="p">):</span>

<span class="w">        </span><span class="s">&quot;&quot;&quot;</span>

<span class="s">        Add the ONNX model file for the component.</span>

<span class="s">        Args:</span>

<span class="s">            path (Union[Path, str]): The path to the ONNX model file.</span>

<span class="s">            max_batch_size (int): The maximum batch size for the model.</span>

<span class="s">            optimization (model_config.TensorRTOptimization, optional): The optimization configuration for the model. Defaults to None.</span>

<span class="s">            warmup (model_config.Warmup, optional): The warmup configuration for the model. Defaults to None.</span>

<span class="s">        Raises:</span>

<span class="s">            AssertionError: If the specified model file is not found, has an invalid extension, or if max_batch_size is less than 0.</span>

<span class="s">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="nx">path</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">Path</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">is_file</span><span class="p">():</span>

<span class="w">            </span><span class="nx">raise</span><span class="w"> </span><span class="nx">AssertionError</span><span class="p">(</span><span class="nx">f</span><span class="s">&quot;specified model file not found: &#39;{path}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">suffix</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">&quot;.onnx&quot;</span><span class="p">:</span>

<span class="w">            </span><span class="nx">raise</span><span class="w"> </span><span class="nx">AssertionError</span><span class="p">(</span><span class="nx">f</span><span class="s">&quot;model file extension is not &#39;.onnx&#39;: &#39;{path}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nx">max_batch_size</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">            </span><span class="nx">raise</span><span class="w"> </span><span class="nx">AssertionError</span><span class="p">(</span><span class="s">&quot;max_batch_size must be greater or equal to 0&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="kp">self</span><span class="p">.</span><span class="nx">entrypoint</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">Path</span><span class="p">(</span><span class="s">&quot;model.onnx&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="kp">self</span><span class="p">.</span><span class="nx">model_path</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">path</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="kp">self</span><span class="p">.</span><span class="nx">config</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="nx">None</span><span class="p">:</span>

<span class="w">            </span><span class="nx">_logger</span><span class="p">.</span><span class="nx">warning</span><span class="p">(</span><span class="s">&quot;Previously added configuration was removed. Component will use the default configuration unless you specify your own.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="kp">self</span><span class="p">.</span><span class="nx">config</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">None</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="nx">Remove</span><span class="w"> </span><span class="nx">old</span><span class="w"> </span><span class="nx">automatic</span><span class="w"> </span><span class="nx">variables</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="kp">self</span><span class="p">.</span><span class="nx">auto_config</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="nx">None</span><span class="p">:</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="kp">self</span><span class="p">.</span><span class="nx">auto_config</span><span class="p">.</span><span class="nx">inputs</span><span class="p">:</span>

<span class="w">                </span><span class="kp">self</span><span class="p">.</span><span class="nx">delete_input</span><span class="p">(</span><span class="kd">var</span><span class="p">[</span><span class="s">&quot;name&quot;</span><span class="p">])</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="kp">self</span><span class="p">.</span><span class="nx">auto_config</span><span class="p">.</span><span class="nx">outputs</span><span class="p">:</span>

<span class="w">                </span><span class="kp">self</span><span class="p">.</span><span class="nx">delete_output</span><span class="p">(</span><span class="kd">var</span><span class="p">[</span><span class="s">&quot;name&quot;</span><span class="p">])</span>

<span class="w">        </span><span class="kp">self</span><span class="p">.</span><span class="nx">auto_config</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">model_config</span><span class="p">.</span><span class="nx">ModelConfig</span><span class="p">(</span><span class="nx">onnx_path</span><span class="p">=</span><span class="nx">path</span><span class="p">,</span>

<span class="w">                                                    </span><span class="nx">max_batch_size</span><span class="p">=</span><span class="nx">max_batch_size</span><span class="p">,</span>

<span class="w">                                                    </span><span class="nx">warmup</span><span class="p">=</span><span class="nx">warmup</span><span class="p">,</span>

<span class="w">                                                    </span><span class="nx">optimization</span><span class="p">=</span><span class="nx">optimization</span><span class="p">)</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="kp">self</span><span class="p">.</span><span class="nx">auto_config</span><span class="p">.</span><span class="nx">inputs</span><span class="p">:</span>

<span class="w">            </span><span class="kp">self</span><span class="p">.</span><span class="nx">add_input</span><span class="p">(</span><span class="kd">var</span><span class="p">[</span><span class="s">&quot;name&quot;</span><span class="p">],</span><span class="w"> </span><span class="kd">var</span><span class="p">[</span><span class="s">&quot;type&quot;</span><span class="p">])</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="kp">self</span><span class="p">.</span><span class="nx">auto_config</span><span class="p">.</span><span class="nx">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="kp">self</span><span class="p">.</span><span class="nx">add_output</span><span class="p">(</span><span class="kd">var</span><span class="p">[</span><span class="s">&quot;name&quot;</span><span class="p">],</span><span class="w"> </span><span class="kd">var</span><span class="p">[</span><span class="s">&quot;type&quot;</span><span class="p">])</span>

<span class="w">    </span><span class="nx">def</span><span class="w"> </span><span class="nx">use_config</span><span class="p">(</span><span class="kp">self</span><span class="p">,</span><span class="w"> </span><span class="nx">path</span><span class="p">:</span><span class="w"> </span><span class="nx">Union</span><span class="p">[</span><span class="nx">Path</span><span class="p">,</span><span class="w"> </span><span class="nx">str</span><span class="p">]):</span>

<span class="w">        </span><span class="s">&quot;&quot;&quot;</span>

<span class="s">        Sets the configuration file to be used for inference.</span>

<span class="s">        Intended usage is to use a custom configuration file instead of the autogenerated one.</span>

<span class="s">        This way extra configurations can be added to the component, such as the execution accelerator.</span>

<span class="s">        Args:</span>

<span class="s">            path (Union[Path, str]): The path to the configuration file.</span>

<span class="s">        Raises:</span>

<span class="s">            AssertionError: If the specified config file is not found or has an invalid extension.</span>

<span class="s">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="nx">path</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">Path</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">is_file</span><span class="p">():</span>

<span class="w">            </span><span class="nx">raise</span><span class="w"> </span><span class="nx">AssertionError</span><span class="p">(</span><span class="nx">f</span><span class="s">&quot;specified config file not found: &#39;{path}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">suffix</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">&quot;.pbtxt&quot;</span><span class="p">:</span>

<span class="w">            </span><span class="nx">raise</span><span class="w"> </span><span class="nx">AssertionError</span><span class="p">(</span><span class="nx">f</span><span class="s">&quot;config file extension is not &#39;.pbtxt&#39;: &#39;{path}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="nx">_validate_gpuruntime_config</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span>

<span class="w">        </span><span class="kp">self</span><span class="p">.</span><span class="nx">config</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">path</span>

<span class="w">    </span><span class="nx">def</span><span class="w"> </span><span class="nx">save</span><span class="p">(</span><span class="kp">self</span><span class="p">,</span><span class="w"> </span><span class="nx">destination</span><span class="p">:</span><span class="w"> </span><span class="nx">Union</span><span class="p">[</span><span class="nx">Path</span><span class="p">,</span><span class="w"> </span><span class="nx">str</span><span class="p">],</span><span class="w"> </span><span class="nx">validate</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">False</span><span class="p">):</span>

<span class="w">        </span><span class="s">&quot;&quot;&quot;</span>

<span class="s">        Saves the component to a folder structure, so it can be used as part of a pipeline configuration package.</span>

<span class="s">        The component folder contains the following:</span>

<span class="s">        - An `.onnx` model file</span>

<span class="s">        - A `.pbtxt` configuration file</span>

<span class="s">        Args:</span>

<span class="s">            destination (path-like): Target directory to which the component will be saved.</span>

<span class="s">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="kp">self</span><span class="p">.</span><span class="nx">entrypoint</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">None</span><span class="p">:</span>

<span class="w">            </span><span class="nx">raise</span><span class="w"> </span><span class="nx">AssertionError</span><span class="p">(</span><span class="s">&quot;An ONNX model file must be specified before the component can be saved.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="nx">component_dir</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">Path</span><span class="p">(</span><span class="nx">destination</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="kp">self</span><span class="p">.</span><span class="nx">name</span>

<span class="w">        </span><span class="nx">component_dir</span><span class="p">.</span><span class="nx">mkdir</span><span class="p">(</span><span class="nx">parents</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">True</span><span class="p">,</span><span class="w"> </span><span class="nx">exist_ok</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">True</span><span class="p">)</span>

<span class="w">        </span><span class="nx">model_dir</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">component_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="kp">self</span><span class="p">.</span><span class="nx">model_version</span>

<span class="w">        </span><span class="nx">model_dir</span><span class="p">.</span><span class="nx">mkdir</span><span class="p">(</span><span class="nx">exist_ok</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">True</span><span class="p">)</span>

<span class="w">        </span><span class="nx">shutil</span><span class="p">.</span><span class="nx">copy</span><span class="p">(</span><span class="kp">self</span><span class="p">.</span><span class="nx">model_path</span><span class="p">,</span><span class="w"> </span><span class="nx">model_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s">&quot;model.onnx&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="kp">self</span><span class="p">.</span><span class="nx">config</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">None</span><span class="p">:</span>

<span class="w">            </span><span class="nx">_logger</span><span class="p">.</span><span class="nx">warning</span><span class="p">(</span><span class="s">&quot;Configuration was not specified. Model will be saved with default configuration.&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="p">(</span><span class="nx">component_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s">&quot;config.pbtxt&quot;</span><span class="p">).</span><span class="nx">write_text</span><span class="p">(</span><span class="nx">f</span><span class="s">&quot;{self.auto_config}&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">else</span><span class="p">:</span>

<span class="w">            </span><span class="nx">shutil</span><span class="p">.</span><span class="nx">copy</span><span class="p">(</span><span class="kp">self</span><span class="p">.</span><span class="nx">config</span><span class="p">,</span><span class="w"> </span><span class="nx">component_dir</span><span class="p">)</span>
</code></pre></div>

</details>
<hr />
<h4 id="ancestors-in-mro">Ancestors (in MRO)</h4>
<ul>
<li>simaticai.deployment.Component</li>
</ul>
<h4 id="class-variables_1">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">BatchInfo</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">reserved_names</span>
</code></pre></div>

<h4 id="methods_1">Methods</h4>
<h4 id="add_input_1">add_input</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">add_input</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">desc</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

<p>Adds a new input to the component with its type.</p>
<p>Name of the variables cannot be reserved name like 'timestamp'.
Input variable 'timestamp' is a prebuilt key in the payload and its value contains the timestamp when the payload is created by AI Inference Server.</p>
<p>Types supported by AI Inference Server version 1.6 are contained in the <code>type_dictionary</code>. Newer AI Inference server version may support additional types.
In case the type is not known by the AI SDK, a warning message will be printed.
The most frequently used types are
- String:
    Typically used for data received from Databus
- Object:
    Object type variables are designed to receive from Vision Connect or transfer images between components
- Numeric scalar types:
    Typically used for data received from S7 Connector</p>
<p>The example payload below shows the format of image received from VCA Connector</p>
<div class="codehilite"><pre><span></span><code>    <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;image&quot;</span><span class="p">:</span>
        <span class="p">{</span>
            <span class="s2">&quot;resolutionWidth&quot;</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
            <span class="s2">&quot;resolutionHeight&quot;</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
            <span class="s2">&quot;mimeType&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;image/raw&quot;</span><span class="p">],</span>
            <span class="s2">&quot;dataType&quot;</span><span class="p">:</span> <span class="s2">&quot;uint8&quot;</span><span class="p">,</span>
            <span class="s2">&quot;channelsPerPixel&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s2">&quot;image&quot;</span><span class="p">:</span> <span class="n">_swap_bytes</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">tobytes</span><span class="p">())</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div>

<p>Between components the format is the same format as the format of Object as an output.</p>
<div class="codehilite"><pre><span></span><code>    <span class="s2">&quot;processedImage&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span> <span class="p">{</span>
                        <span class="s2">&quot;resolutionWidth&quot;</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
                        <span class="s2">&quot;resolutionHeight&quot;</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">height</span>
                        <span class="p">}</span>
                    <span class="p">),</span>
        <span class="s2">&quot;bytes&quot;</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">tobytes</span><span class="p">()</span>
    <span class="p">}</span>
</code></pre></div>

<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>str</td>
<td>Name of the new input.</td>
<td>None</td>
</tr>
<tr>
<td>_type</td>
<td>str</td>
<td>Type of the new input.</td>
<td>None</td>
</tr>
<tr>
<td>desc</td>
<td>str</td>
<td>Description of the input. (optional)</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">_type</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Adds a new input to the component with its type.</span>

<span class="sd">        Name of the variables cannot be reserved name like &#39;timestamp&#39;.</span>

<span class="sd">        Input variable &#39;timestamp&#39; is a prebuilt key in the payload and its value contains the timestamp when the payload is created by AI Inference Server.</span>

<span class="sd">        Types supported by AI Inference Server version 1.6 are contained in the `type_dictionary`. Newer AI Inference server version may support additional types.</span>

<span class="sd">        In case the type is not known by the AI SDK, a warning message will be printed.</span>

<span class="sd">        The most frequently used types are</span>

<span class="sd">        - String:</span>

<span class="sd">            Typically used for data received from Databus</span>

<span class="sd">        - Object:</span>

<span class="sd">            Object type variables are designed to receive from Vision Connect or transfer images between components</span>

<span class="sd">        - Numeric scalar types:</span>

<span class="sd">            Typically used for data received from S7 Connector</span>

<span class="sd">        The example payload below shows the format of image received from VCA Connector</span>

<span class="sd">        ```python</span>

<span class="sd">            payload = { &quot;image&quot;:</span>

<span class="sd">                {</span>

<span class="sd">                    &quot;resolutionWidth&quot;: image.width,</span>

<span class="sd">                    &quot;resolutionHeight&quot;: image.height,</span>

<span class="sd">                    &quot;mimeType&quot;: [&quot;image/raw&quot;],</span>

<span class="sd">                    &quot;dataType&quot;: &quot;uint8&quot;,</span>

<span class="sd">                    &quot;channelsPerPixel&quot;: 3,</span>

<span class="sd">                    &quot;image&quot;: _swap_bytes(image.tobytes())</span>

<span class="sd">                }</span>

<span class="sd">            }</span>

<span class="sd">        ```</span>

<span class="sd">        Between components the format is the same format as the format of Object as an output.</span>

<span class="sd">        ```python</span>

<span class="sd">            &quot;processedImage&quot;: {</span>

<span class="sd">                &quot;metadata&quot;: json.dumps( {</span>

<span class="sd">                                &quot;resolutionWidth&quot;: image.width,</span>

<span class="sd">                                &quot;resolutionHeight&quot;: image.height</span>

<span class="sd">                                }</span>

<span class="sd">                            ),</span>

<span class="sd">                &quot;bytes&quot;: image.tobytes()</span>

<span class="sd">            }</span>

<span class="sd">        ```</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Name of the new input.</span>

<span class="sd">            _type (str): Type of the new input.</span>

<span class="sd">            desc (str): Description of the input. (optional)</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Input &#39;{name}&#39; already exists.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">reserved_names</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Input &#39;{name}&#39; is a reserved keyword.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">_type</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">supported_types</span><span class="p">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;WARNING! Unknown type &#39;{_type}&#39; for input variable &#39;{name}&#39;. Please check if the target Inference Server supports this type.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">_type</span><span class="p">,</span>

<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">desc</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;desc&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">desc</span>
</code></pre></div>

</details>
<h4 id="add_output_1">add_output</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">add_output</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">desc</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

<p>Adds a new output to the component.</p>
<p>Types supported by AI Inference Server version 1.6 are contained in the <code>type_dictionary</code>. Newer AI Inference server version may support additional types.
In case the type is not known by the AI SDK, a warning message will be printed.
The most frequently used types are
- String:
    Typically used for data to be sent to Databus
- Object:
    Typically used for images to be sent to ZMQ Connector
- Numeric scalar types:
    Typically used for data sent to S7 Connector</p>
<p>For outputs of type <code>Object</code> the entrypoint must return with a <code>dictionary</code> containing two fields, where one field has type <code>str</code> and the other field has type <code>bytes</code>.
The example below shows the required format, assuming that 'image' is a PIL Image.</p>
<div class="codehilite"><pre><span></span><code>    <span class="s2">&quot;processedImage&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span> <span class="p">{</span>
                        <span class="s2">&quot;resolutionWidth&quot;</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
                        <span class="s2">&quot;resolutionHeight&quot;</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">height</span>
                        <span class="p">}</span>
                    <span class="p">),</span>
        <span class="s2">&quot;bytes&quot;</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">tobytes</span><span class="p">()</span>
    <span class="p">}</span>
</code></pre></div>

<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>str</td>
<td>Name of the new output.</td>
<td>None</td>
</tr>
<tr>
<td>_type</td>
<td>str</td>
<td>Type of the new output.</td>
<td>None</td>
</tr>
<tr>
<td>desc</td>
<td>str</td>
<td>Description of the output. (optional)</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">_type</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Adds a new output to the component.</span>

<span class="sd">        Types supported by AI Inference Server version 1.6 are contained in the `type_dictionary`. Newer AI Inference server version may support additional types.</span>

<span class="sd">        In case the type is not known by the AI SDK, a warning message will be printed.</span>

<span class="sd">        The most frequently used types are</span>

<span class="sd">        - String:</span>

<span class="sd">            Typically used for data to be sent to Databus</span>

<span class="sd">        - Object:</span>

<span class="sd">            Typically used for images to be sent to ZMQ Connector</span>

<span class="sd">        - Numeric scalar types:</span>

<span class="sd">            Typically used for data sent to S7 Connector</span>

<span class="sd">        For outputs of type `Object` the entrypoint must return with a `dictionary` containing two fields, where one field has type `str` and the other field has type `bytes`.</span>

<span class="sd">        The example below shows the required format, assuming that &#39;image&#39; is a PIL Image.</span>

<span class="sd">        ```python</span>

<span class="sd">            &quot;processedImage&quot;: {</span>

<span class="sd">                &quot;metadata&quot;: json.dumps( {</span>

<span class="sd">                                &quot;resolutionWidth&quot;: image.width,</span>

<span class="sd">                                &quot;resolutionHeight&quot;: image.height</span>

<span class="sd">                                }</span>

<span class="sd">                            ),</span>

<span class="sd">                &quot;bytes&quot;: image.tobytes()</span>

<span class="sd">            }</span>

<span class="sd">        ```</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Name of the new output.</span>

<span class="sd">            _type (str): Type of the new output.</span>

<span class="sd">            desc (str): Description of the output. (optional)</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Output &#39;{name}&#39; already exists&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">_type</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">supported_types</span><span class="p">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;WARNING! Unknown type &#39;{_type}&#39; for input variable &#39;{name}&#39;. Please check if the target Inference Server supports this type.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">_type</span><span class="p">,</span>

<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">desc</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;desc&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">desc</span>
</code></pre></div>

</details>
<h4 id="change_input_1">change_input</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">change_input</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">desc</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

<p>Changes one of the inputs of the component.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>str</td>
<td>Name of the input to be changed.</td>
<td>None</td>
</tr>
<tr>
<td>_type</td>
<td>str</td>
<td>New type of the input.</td>
<td>None</td>
</tr>
<tr>
<td>desc</td>
<td>str</td>
<td>Description of the input. (optional)</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">change_input</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="nl">_type</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="k">desc</span><span class="err">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">str</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Changes one of the inputs of the component.</span>

<span class="ss">        Args:</span>

<span class="ss">            name (str): Name of the input to be changed.</span>

<span class="ss">            _type (str): New type of the input.</span>

<span class="ss">            desc (str): Description of the input. (optional)</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">inputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;There is no input with name &#39;{name}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">_type</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">supported_types</span><span class="p">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="p">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;WARNING! Unknown type &#39;{_type}&#39; for input variable &#39;{name}&#39;. Please check if the target Inference Server supports this type.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">inputs</span><span class="o">[</span><span class="n">name</span><span class="o">][</span><span class="n">&#39;type&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_type</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="k">desc</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">inputs</span><span class="o">[</span><span class="n">name</span><span class="o">][</span><span class="n">&#39;desc&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">desc</span>
</code></pre></div>

</details>
<h4 id="change_output_1">change_output</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">change_output</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">desc</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

<p>Changes one of the outputs of the component.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>str</td>
<td>Name of the output to be changed.</td>
<td>None</td>
</tr>
<tr>
<td>_type</td>
<td>str</td>
<td>The new type of the output.</td>
<td>None</td>
</tr>
<tr>
<td>desc</td>
<td>str</td>
<td>Description of the output. (optional)</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">change_output</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="nl">_type</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="k">desc</span><span class="err">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">str</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Changes one of the outputs of the component.</span>

<span class="ss">        Args:</span>

<span class="ss">            name (str): Name of the output to be changed.</span>

<span class="ss">            _type (str): The new type of the output.</span>

<span class="ss">            desc (str): Description of the output. (optional)</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;There is no output with name &#39;{name}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">_type</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">supported_types</span><span class="p">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="p">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;WARNING! Unknown type &#39;{_type}&#39; for input variable &#39;{name}&#39;. Please check if the target Inference Server supports this type.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">outputs</span><span class="o">[</span><span class="n">name</span><span class="o">][</span><span class="n">&#39;type&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_type</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="k">desc</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">inputs</span><span class="o">[</span><span class="n">name</span><span class="o">][</span><span class="n">&#39;desc&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">desc</span>
</code></pre></div>

</details>
<h4 id="delete_input_1">delete_input</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">delete_input</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span>
</code></pre></div>

<p>Deletes an input from the component by name.</p>
<p>Once the package has been created with the given component, it is recommended not to change the component directly.
Instead, all necessary methods to change it are available through the package to avoid component inconsistencies.
It is recommended to use <code>package.delete_input_wire(...)</code> with default parameter <code>with_input=True</code>.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>str</td>
<td>Name of the input to be deleted.</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nx">def</span><span class="w"> </span><span class="nx">delete_input</span><span class="p">(</span><span class="kp">self</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="p">:</span><span class="w"> </span><span class="nx">str</span><span class="p">):</span>

<span class="w">        </span><span class="s">&quot;&quot;&quot;</span>

<span class="s">        Deletes an input from the component by name.</span>

<span class="s">        Once the package has been created with the given component, it is recommended not to change the component directly.</span>

<span class="s">        Instead, all necessary methods to change it are available through the package to avoid component inconsistencies.</span>

<span class="s">        It is recommended to use `package.delete_input_wire(...)` with default parameter `with_input=True`.</span>

<span class="s">        Args:</span>

<span class="s">            name (str): Name of the input to be deleted.</span>

<span class="s">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="kp">self</span><span class="p">.</span><span class="nx">inputs</span><span class="p">:</span>

<span class="w">            </span><span class="nx">raise</span><span class="w"> </span><span class="nx">AssertionError</span><span class="p">(</span><span class="nx">f</span><span class="s">&quot;Component &#39;{self.name}&#39; has no input &#39;{name}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="kp">self</span><span class="p">.</span><span class="nx">inputs</span><span class="p">.</span><span class="nx">pop</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="delete_output_1">delete_output</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">delete_output</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span>
</code></pre></div>

<p>Deletes an output from the component by name.</p>
<p>Once the package has been created with the given component, it is recommended not to change the component directly.
Instead, all necessary methods to change it are available through the package to avoid component inconsistencies.
Deleting an output which is represented in any wire will cause package inconsistency.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>str</td>
<td>Name of the output to be deleted.</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nx">def</span><span class="w"> </span><span class="nx">delete_output</span><span class="p">(</span><span class="kp">self</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="p">:</span><span class="w"> </span><span class="nx">str</span><span class="p">):</span>

<span class="w">        </span><span class="s">&quot;&quot;&quot;</span>

<span class="s">        Deletes an output from the component by name.</span>

<span class="s">        Once the package has been created with the given component, it is recommended not to change the component directly.</span>

<span class="s">        Instead, all necessary methods to change it are available through the package to avoid component inconsistencies.</span>

<span class="s">        Deleting an output which is represented in any wire will cause package inconsistency.</span>

<span class="s">        Args:</span>

<span class="s">            name (str): Name of the output to be deleted.</span>

<span class="s">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="kp">self</span><span class="p">.</span><span class="nx">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="nx">raise</span><span class="w"> </span><span class="nx">AssertionError</span><span class="p">(</span><span class="nx">f</span><span class="s">&quot;Component &#39;{self.name}&#39; has no output &#39;{name}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="kp">self</span><span class="p">.</span><span class="nx">outputs</span><span class="p">.</span><span class="nx">pop</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="save_1">save</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">save</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">destination</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
    <span class="n">validate</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</code></pre></div>

<p>Saves the component to a folder structure, so it can be used as part of a pipeline configuration package.</p>
<p>The component folder contains the following:</p>
<ul>
<li>An <code>.onnx</code> model file</li>
<li>A <code>.pbtxt</code> configuration file</li>
</ul>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>destination</td>
<td>path-like</td>
<td>Target directory to which the component will be saved.</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nx">def</span><span class="w"> </span><span class="nx">save</span><span class="p">(</span><span class="kp">self</span><span class="p">,</span><span class="w"> </span><span class="nx">destination</span><span class="p">:</span><span class="w"> </span><span class="nx">Union</span><span class="p">[</span><span class="nx">Path</span><span class="p">,</span><span class="w"> </span><span class="nx">str</span><span class="p">],</span><span class="w"> </span><span class="nx">validate</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">False</span><span class="p">):</span>

<span class="w">        </span><span class="s">&quot;&quot;&quot;</span>

<span class="s">        Saves the component to a folder structure, so it can be used as part of a pipeline configuration package.</span>

<span class="s">        The component folder contains the following:</span>

<span class="s">        - An `.onnx` model file</span>

<span class="s">        - A `.pbtxt` configuration file</span>

<span class="s">        Args:</span>

<span class="s">            destination (path-like): Target directory to which the component will be saved.</span>

<span class="s">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="kp">self</span><span class="p">.</span><span class="nx">entrypoint</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">None</span><span class="p">:</span>

<span class="w">            </span><span class="nx">raise</span><span class="w"> </span><span class="nx">AssertionError</span><span class="p">(</span><span class="s">&quot;An ONNX model file must be specified before the component can be saved.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="nx">component_dir</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">Path</span><span class="p">(</span><span class="nx">destination</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="kp">self</span><span class="p">.</span><span class="nx">name</span>

<span class="w">        </span><span class="nx">component_dir</span><span class="p">.</span><span class="nx">mkdir</span><span class="p">(</span><span class="nx">parents</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">True</span><span class="p">,</span><span class="w"> </span><span class="nx">exist_ok</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">True</span><span class="p">)</span>

<span class="w">        </span><span class="nx">model_dir</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">component_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="kp">self</span><span class="p">.</span><span class="nx">model_version</span>

<span class="w">        </span><span class="nx">model_dir</span><span class="p">.</span><span class="nx">mkdir</span><span class="p">(</span><span class="nx">exist_ok</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">True</span><span class="p">)</span>

<span class="w">        </span><span class="nx">shutil</span><span class="p">.</span><span class="nx">copy</span><span class="p">(</span><span class="kp">self</span><span class="p">.</span><span class="nx">model_path</span><span class="p">,</span><span class="w"> </span><span class="nx">model_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s">&quot;model.onnx&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="kp">self</span><span class="p">.</span><span class="nx">config</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">None</span><span class="p">:</span>

<span class="w">            </span><span class="nx">_logger</span><span class="p">.</span><span class="nx">warning</span><span class="p">(</span><span class="s">&quot;Configuration was not specified. Model will be saved with default configuration.&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="p">(</span><span class="nx">component_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s">&quot;config.pbtxt&quot;</span><span class="p">).</span><span class="nx">write_text</span><span class="p">(</span><span class="nx">f</span><span class="s">&quot;{self.auto_config}&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">else</span><span class="p">:</span>

<span class="w">            </span><span class="nx">shutil</span><span class="p">.</span><span class="nx">copy</span><span class="p">(</span><span class="kp">self</span><span class="p">.</span><span class="nx">config</span><span class="p">,</span><span class="w"> </span><span class="nx">component_dir</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="use_config">use_config</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">use_config</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
<span class="p">)</span>
</code></pre></div>

<p>Sets the configuration file to be used for inference.</p>
<p>Intended usage is to use a custom configuration file instead of the autogenerated one.
This way extra configurations can be added to the component, such as the execution accelerator.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>path</td>
<td>Union[Path, str]</td>
<td>The path to the configuration file.</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Raises:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>AssertionError</td>
<td>If the specified config file is not found or has an invalid extension.</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code>    def use_config(self, path: Union[Path, str]):

        &quot;&quot;&quot;

        Sets the configuration file to be used for inference.

        Intended usage is to use a custom configuration file instead of the autogenerated one.

        This way extra configurations can be added to the component, such as the execution accelerator.

        Args:

            path (Union[Path, str]): The path to the configuration file.

        Raises:

            AssertionError: If the specified config file is not found or has an invalid extension.

        &quot;&quot;&quot;

        path = Path(path)

        if not path.is_file():

            raise AssertionError(f&quot;specified config file not found: &#39;{path}&#39;&quot;)

        if path.suffix != &quot;.pbtxt&quot;:

            raise AssertionError(f&quot;config file extension is not &#39;.pbtxt&#39;: &#39;{path}&#39;&quot;)

        _validate_gpuruntime_config(path)

        self.config = path
</code></pre></div>

</details>
<h4 id="use_model">use_model</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">use_model</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
    <span class="n">max_batch_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">optimization</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">simaticai</span><span class="o">.</span><span class="n">helpers</span><span class="o">.</span><span class="n">model_config</span><span class="o">.</span><span class="n">TensorRTOptimization</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">warmup</span><span class="p">:</span> <span class="n">simaticai</span><span class="o">.</span><span class="n">helpers</span><span class="o">.</span><span class="n">model_config</span><span class="o">.</span><span class="n">Warmup</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

<p>Add the ONNX model file for the component.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>path</td>
<td>Union[Path, str]</td>
<td>The path to the ONNX model file.</td>
<td>None</td>
</tr>
<tr>
<td>max_batch_size</td>
<td>int</td>
<td>The maximum batch size for the model.</td>
<td>None</td>
</tr>
<tr>
<td>optimization</td>
<td>model_config.TensorRTOptimization</td>
<td>The optimization configuration for the model. Defaults to None.</td>
<td>None</td>
</tr>
<tr>
<td>warmup</td>
<td>model_config.Warmup</td>
<td>The warmup configuration for the model. Defaults to None.</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Raises:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>AssertionError</td>
<td>If the specified model file is not found, has an invalid extension, or if max_batch_size is less than 0.</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">use_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="p">:</span><span class="w"> </span><span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span><span class="w"> </span><span class="nb">str</span><span class="p">],</span>

<span class="w">                  </span><span class="n">max_batch_size</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">,</span>

<span class="w">                  </span><span class="n">optimization</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="n">model_config</span><span class="o">.</span><span class="n">TensorRTOptimization</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">,</span>

<span class="w">                  </span><span class="n">warmup</span><span class="p">:</span><span class="w"> </span><span class="n">model_config</span><span class="o">.</span><span class="n">Warmup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Add the ONNX model file for the component.</span>

<span class="sd">        Args:</span>

<span class="sd">            path (Union[Path, str]): The path to the ONNX model file.</span>

<span class="sd">            max_batch_size (int): The maximum batch size for the model.</span>

<span class="sd">            optimization (model_config.TensorRTOptimization, optional): The optimization configuration for the model. Defaults to None.</span>

<span class="sd">            warmup (model_config.Warmup, optional): The warmup configuration for the model. Defaults to None.</span>

<span class="sd">        Raises:</span>

<span class="sd">            AssertionError: If the specified model file is not found, has an invalid extension, or if max_batch_size is less than 0.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">path</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;specified model file not found: &#39;{path}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">path</span><span class="o">.</span><span class="n">suffix</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s2">&quot;.onnx&quot;</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;model file extension is not &#39;.onnx&#39;: &#39;{path}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">max_batch_size</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;max_batch_size must be greater or equal to 0&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;model.onnx&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">model_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">path</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Previously added configuration was removed. Component will use the default configuration unless you specify your own.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span>

<span class="w">        </span><span class="c1"># Remove old automatic variables</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">auto_config</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">auto_config</span><span class="o">.</span><span class="n">inputs</span><span class="p">:</span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">delete_input</span><span class="p">(</span><span class="k">var</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">auto_config</span><span class="o">.</span><span class="n">outputs</span><span class="p">:</span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">delete_output</span><span class="p">(</span><span class="k">var</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">auto_config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">model_config</span><span class="o">.</span><span class="n">ModelConfig</span><span class="p">(</span><span class="n">onnx_path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>

<span class="w">                                                    </span><span class="n">max_batch_size</span><span class="o">=</span><span class="n">max_batch_size</span><span class="p">,</span>

<span class="w">                                                    </span><span class="n">warmup</span><span class="o">=</span><span class="n">warmup</span><span class="p">,</span>

<span class="w">                                                    </span><span class="n">optimization</span><span class="o">=</span><span class="n">optimization</span><span class="p">)</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">auto_config</span><span class="o">.</span><span class="n">inputs</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">add_input</span><span class="p">(</span><span class="k">var</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span><span class="w"> </span><span class="k">var</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">])</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">auto_config</span><span class="o">.</span><span class="n">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="k">var</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span><span class="w"> </span><span class="k">var</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">])</span>
</code></pre></div>

</details>
<h4 id="validate_1">validate</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">validate</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<p>Empty method for child classess to implement.</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nx">def</span><span class="w"> </span><span class="nx">validate</span><span class="p">(</span><span class="kp">self</span><span class="p">):</span>

<span class="w">        </span><span class="s">&quot;&quot;&quot;</span>

<span class="s">        Empty method for child classess to implement.</span>

<span class="s">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="nx">pass</span>
</code></pre></div>

</details>
<h3 id="pipeline">Pipeline</h3>
<p><code>Pipeline</code> represents a pipeline configuration package with <code>Components</code> and wires to provide a data flow on the AI Inference Server.</p>
<p>The <code>Components</code> have inputs and outputs to transfer data to each other and the wires describe this data flow between them.
The package also contains configuration files required to deploy a pipeline on an Industrial Edge device.</p>
<p>A newly initialized <code>Pipeline</code> does not contain any <code>Component</code> or wire, only its name and version will be set.
The name and version together will define the name of the zip file when the package is saved.</p>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Pipeline</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">version</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">desc</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="p">)</span>
</code></pre></div>

<h4 id="attributes_2">Attributes</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>str</td>
<td>Name of the package</td>
<td>None</td>
</tr>
<tr>
<td>version</td>
<td>str</td>
<td>Version of the package</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="n">Pipeline</span><span class="p">:</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    `Pipeline` represents a pipeline configuration package with `Components` and wires to provide a data flow on the AI Inference Server.</span>

<span class="sd">    The `Components` have inputs and outputs to transfer data to each other and the wires describe this data flow between them.</span>

<span class="sd">    The package also contains configuration files required to deploy a pipeline on an Industrial Edge device.</span>

<span class="sd">    A newly initialized `Pipeline` does not contain any `Component` or wire, only its name and version will be set.</span>

<span class="sd">    The name and version together will define the name of the zip file when the package is saved.</span>

<span class="sd">    Args:</span>

<span class="sd">        name (str): Name of the package</span>

<span class="sd">        version (str): Version of the package</span>

<span class="sd">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="n">_wire_hash_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;{}.{} -&gt; {}.{}&quot;</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        A newly initialized `Pipeline` will contain no `Component` or wire, just its name and version will be set.</span>

<span class="sd">        The name and version will define together the name of the zip file when the package is saved.</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Name of the package</span>

<span class="sd">            desc (str): Package description (optional)</span>

<span class="sd">            version (str): Version of the package</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">desc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">desc</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">version</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">package_id</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">save_version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">save_package_id</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">author</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;AI SDK&#39;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">wiring</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">periodicity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">timeshift_reference</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">log_level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_set_log_level</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">log_level</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">):</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">log_level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">log_level</span>

<span class="w">        </span><span class="n">_logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_level</span><span class="p">)</span>

<span class="w">    </span><span class="err">@</span><span class="n">staticmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">from_components</span><span class="p">(</span><span class="n">components</span><span class="p">:</span><span class="w"> </span><span class="n">list</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s2">&quot;Pipeline&quot;</span><span class="p">:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Creates a pipeline configuration from the given components.</span>

<span class="sd">        The components are linked in a linear sequence with inputs and outputs auto-wired based on the name of the inputs and outputs of the components.</span>

<span class="sd">        The inputs of the first component will be wired as the pipeline inputs and the outputs of the last component will be wired as the pipeline outputs.</span>

<span class="sd">        The components must have unique names. Two or more versions of the same component can not be packaged simultaneously without renaming them.</span>

<span class="sd">        Args:</span>

<span class="sd">            components (list): List of PythonComponents</span>

<span class="sd">            name (str): Name of the pipeline</span>

<span class="sd">            version (str): Version information of the pipeline. (Optional)</span>

<span class="sd">        Returns:</span>

<span class="sd">            Pipeline: Pipeline object with the auto-wired components</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">pipeline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Pipeline</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="o">=</span><span class="n">desc</span><span class="p">)</span>

<span class="w">        </span><span class="n">first_component</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">components</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="w">        </span><span class="n">pipeline</span><span class="o">.</span><span class="n">add_component</span><span class="p">(</span><span class="n">first_component</span><span class="p">)</span>

<span class="w">        </span><span class="n">pipeline</span><span class="o">.</span><span class="n">inputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[(</span><span class="n">first_component</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">component_input</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">component_input</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">first_component</span><span class="o">.</span><span class="n">inputs</span><span class="p">]</span>

<span class="w">        </span><span class="n">pipeline</span><span class="o">.</span><span class="n">outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[(</span><span class="n">first_component</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">output</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">first_component</span><span class="o">.</span><span class="n">outputs</span><span class="p">]</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">components</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>

<span class="w">            </span><span class="n">pipeline</span><span class="o">.</span><span class="n">add_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">wire_component</span><span class="p">,</span><span class="w"> </span><span class="n">wire_name</span><span class="p">)</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">pipeline</span><span class="o">.</span><span class="n">outputs</span><span class="p">:</span>

<span class="w">                </span><span class="n">try</span><span class="p">:</span>

<span class="w">                    </span><span class="n">pipeline</span><span class="o">.</span><span class="n">add_wiring</span><span class="p">(</span><span class="n">wire_component</span><span class="p">,</span><span class="w"> </span><span class="n">wire_name</span><span class="p">,</span><span class="w"> </span><span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">wire_name</span><span class="p">)</span>

<span class="w">                </span><span class="n">except</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">e</span><span class="p">:</span>

<span class="w">                    </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Output variable {wire_component}.{wire_name} couldn&#39;t be auto-wired.</span><span class="se">\n</span><span class="s2">Cause: {e}&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="n">unwired_variables</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">f</span><span class="s1">&#39;{component.name}.{x}&#39;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">component</span><span class="o">.</span><span class="n">inputs</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">any</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;{component.name}.{x}&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">pipeline</span><span class="o">.</span><span class="n">wiring</span><span class="p">)]</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">unwired_variables</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">unwired_variables</span><span class="p">:</span>

<span class="w">                    </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Input variable {variable} couldn&#39;t be auto-wired.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="n">pipeline</span><span class="o">.</span><span class="n">outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[(</span><span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">output</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">component</span><span class="o">.</span><span class="n">outputs</span><span class="p">]</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">pipeline</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb">str</span><span class="p">:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Textual representation of the configured package.</span>

<span class="sd">        The method shows the `Components` with their inputs, outputs and parameters as well as the wiring between these `Components`.</span>

<span class="sd">        Returns:</span>

<span class="sd">            [str]: Textual representation of the package</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;[{self.__class__.__name__}] {self.name} ({self.version})</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">desc</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">:</span>

<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;{self.desc}</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Pipeline Parameters:</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;- {name} ({parameter[&#39;type&#39;]}, default: &#39;{parameter[&#39;defaultValue&#39;]}&#39;){(&#39;: &#39; + parameter[&#39;desc&#39;]) if parameter.get(&#39;desc&#39;) is not None else &#39;&#39;}</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Pipeline Inputs:</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">:</span>

<span class="w">                </span><span class="n">input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">component</span><span class="p">]</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;&gt; {name} ({input[&#39;type&#39;]}){&#39;: &#39; + input[&#39;desc&#39;] if input.get(&#39;desc&#39;) is not None else &#39;&#39;}</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Pipeline Outputs:</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">:</span>

<span class="w">                </span><span class="n">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">component</span><span class="p">]</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;&lt; {name} ({output[&#39;type&#39;]}){&#39;: &#39; + output[&#39;desc&#39;] if output.get(&#39;desc&#39;) is not None else &#39;&#39;}</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="n">metrics</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">metric</span><span class="p">,</span><span class="w"> </span><span class="n">component_name</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">component_name</span><span class="p">,</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">items</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">PythonComponent</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">metric</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">component</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Metrics:</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">metric</span><span class="p">,</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">metrics</span><span class="p">:</span>

<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;&lt; {name}{&#39;: &#39; + metric[&#39;desc&#39;] if metric.get(&#39;desc&#39;) is not None else &#39;&#39;}</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wiring</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">I/O Wiring:</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">:</span>

<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;  {name} -&gt; {component}.{name}</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">wire_hash</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">wiring</span><span class="p">:</span>

<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;  {wire_hash}</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">:</span>

<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;  {component}.{name} -&gt; {name}</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">metric</span><span class="p">,</span><span class="w"> </span><span class="n">component_name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">metrics</span><span class="p">:</span>

<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;  {component_name}.{name} -&gt; {name}</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">periodicity</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Timeshifting:</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;  Periodicity: {self.periodicity} ms</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timeshift_reference</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;  References:</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="n">ref</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">timeshift_reference</span><span class="p">:</span>

<span class="w">                    </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;  - {ref}</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>

<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">component</span><span class="o">.</span><span class="n">__repr__</span><span class="p">()</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">text</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Defines an input variable on the given component as a pipeline input.</span>

<span class="sd">        Args:</span>

<span class="sd">            component (str): Name of the component</span>

<span class="sd">            variable (str): Name of the input variable</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">try</span><span class="p">:</span>

<span class="w">            </span><span class="n">_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">component</span><span class="p">]</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span>

<span class="w">        </span><span class="n">except</span><span class="w"> </span><span class="n">KeyError</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;The component with input variable must exist in the pipeline.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">)</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;The pipeline input already exists.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">))</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">delete_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">component</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Deletes a pipeline input.</span>

<span class="sd">        Args:</span>

<span class="sd">            component (str): Name of the component</span>

<span class="sd">            variable (str): Name of the input variable</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">)</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;The pipeline input does not exist.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">remove</span><span class="p">((</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">))</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Defines an output variable on the given component as a pipeline output.</span>

<span class="sd">        Args:</span>

<span class="sd">            component (str): Name of the component</span>

<span class="sd">            variable (str): Name of the output variable</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">try</span><span class="p">:</span>

<span class="w">            </span><span class="n">_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">component</span><span class="p">]</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span>

<span class="w">        </span><span class="n">except</span><span class="w"> </span><span class="n">KeyError</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;The component with output variable must exist in the pipeline.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">)</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;The pipeline output already exists.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">))</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">delete_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">component</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Deletes a pipeline output.</span>

<span class="sd">        Args:</span>

<span class="sd">            component (str): Name of the component</span>

<span class="sd">            variable (str): Name of the input variable</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">)</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;The pipeline output does not exist.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">remove</span><span class="p">((</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">))</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_component</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">component</span><span class="p">:</span><span class="w"> </span><span class="n">Component</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Adds a `Component` to the pipeline configuration without any connection.</span>

<span class="sd">        The `Component` can be marked as an input or output component of the pipeline.</span>

<span class="sd">        When these parameters are True, the `Component` is responsible for input or output data of the pipeline.</span>

<span class="sd">        The component must have a unique name. Two or more versions of the same component can not be added to the same pipeline with the same component name.</span>

<span class="sd">        Args:</span>

<span class="sd">            component (Component): `Component` to be added</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Component with name {component.name} already exists. Please rename the component.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">component</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_wiring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">from_component</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">from_output</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">to_component</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">to_input</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Creates a one-to-one connection between the input and output of two components.</span>

<span class="sd">        The method checks if the connection is allowed with the following requirements:</span>

<span class="sd">        - The components exist with the given inputs/outputs</span>

<span class="sd">        - The given inputs and outputs are not connected to any wire</span>

<span class="sd">        - The types of the connected input and output are compatible</span>

<span class="sd">        Args:</span>

<span class="sd">            from_component (str): Name of the component which provides data to the `to_component`</span>

<span class="sd">            from_output (str): Name of the output variable of the `from_component`</span>

<span class="sd">            to_component (str): Name of the component which consumes data from the `from_component`</span>

<span class="sd">            to_input (str): Name of the input variable of the `to_component`</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">from_component</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;No component named &#39;{from_component}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">to_component</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;No component named &#39;{to_component}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">from_output</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">from_component</span><span class="p">]</span><span class="o">.</span><span class="n">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Component &#39;{from_component}&#39; has no output named &#39;{from_output}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">to_input</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">to_component</span><span class="p">]</span><span class="o">.</span><span class="n">inputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Component &#39;{to_component}&#39; has no input named &#39;{to_input}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">get_wire_for_input</span><span class="p">(</span><span class="n">to_component</span><span class="p">,</span><span class="w"> </span><span class="n">to_input</span><span class="p">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Input &#39;{to_input}&#39; of component &#39;{to_component}&#39; is already wired&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">_output_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">from_component</span><span class="p">]</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">from_output</span><span class="p">][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span>

<span class="w">        </span><span class="n">_input_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">to_component</span><span class="p">]</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">to_input</span><span class="p">][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">_output_type</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">_input_type</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;Output and input types do not match&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">wire_hash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_wire_hash_string</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">from_component</span><span class="p">,</span><span class="w"> </span><span class="n">from_output</span><span class="p">,</span><span class="w"> </span><span class="n">to_component</span><span class="p">,</span><span class="w"> </span><span class="n">to_input</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">wiring</span><span class="p">[</span><span class="n">wire_hash</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="s2">&quot;fromComponent&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">from_component</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;fromOutput&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">from_output</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;toComponent&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">to_component</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;toInput&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">to_input</span><span class="p">,</span>

<span class="w">        </span><span class="p">}</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">get_wire_for_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">component_name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">output_name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Searches for the wire which connects a component with `component_name` as data provider through its output with name output_name.</span>

<span class="sd">        Args:</span>

<span class="sd">            component_name (str): Name of the data provider component.</span>

<span class="sd">            output_name (str): Name of the output variable of `component_name`.</span>

<span class="sd">        Returns:</span>

<span class="sd">            [dict]: Wire which contains the data provider and receiver with their names and the names of their variables.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">wires</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">x</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">wiring</span><span class="o">.</span><span class="n">values</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;fromComponent&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">component_name</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;fromOutput&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">output_name</span><span class="p">]</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">wires</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">wires</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">None</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">get_wire_for_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">component_name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">input_name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Searches for the wire which connects a component with `component_name` as data consumer through its input with name `input_name`.</span>

<span class="sd">        Args:</span>

<span class="sd">            component_name (str): Name of the data consumer component.</span>

<span class="sd">            input_name (str): Name of the input variable of `component_name`.</span>

<span class="sd">        Returns:</span>

<span class="sd">            dict: Wire which contains the data provider and receiver with their names and the names of their variables.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">wires</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">x</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">wiring</span><span class="o">.</span><span class="n">values</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;toComponent&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">component_name</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;toInput&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">input_name</span><span class="p">]</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">wires</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">wires</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">None</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">delete_input_wire</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">component</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">with_input</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">True</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Deletes an existing connection between two components.</span>

<span class="sd">        The connection must be given with the name of the consumer component and its input variable.</span>

<span class="sd">        If an inter signal alignment reference variable is affected it cannot be deleted.</span>

<span class="sd">        By default, the input variable will be also deleted.</span>

<span class="sd">        Args:</span>

<span class="sd">            component (str): Name of the component which has the input given the name variable</span>

<span class="sd">            variable (str): Name of the input variable on the component which connected by the wire</span>

<span class="sd">            with_input (bool, optional): If set, the input variable will be also deleted from the component. Defaults to True.</span>

<span class="sd">        Raises:</span>

<span class="sd">            AssertionError: When the variable acts as inter signal alignment reference, it cannot be deleted, and an `AssertionError` will be raised.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">wire</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">get_wire_for_input</span><span class="p">(</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">wire</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;There is no wiring for input &#39;{variable}&#39; of component &#39;{component}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">timeshift_reference</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;Inter signal alignment reference variables can not be deleted.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">wire_hash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_wire_hash_string</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wire</span><span class="p">[</span><span class="s1">&#39;fromComponent&#39;</span><span class="p">],</span><span class="w"> </span><span class="n">wire</span><span class="p">[</span><span class="s1">&#39;fromOutput&#39;</span><span class="p">],</span><span class="w"> </span><span class="n">wire</span><span class="p">[</span><span class="s1">&#39;toComponent&#39;</span><span class="p">],</span><span class="w"> </span><span class="n">wire</span><span class="p">[</span><span class="s1">&#39;toInput&#39;</span><span class="p">])</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">wiring</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">wire_hash</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">with_input</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">component</span><span class="p">]</span><span class="o">.</span><span class="n">delete_input</span><span class="p">(</span><span class="n">variable</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_dependencies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">packages</span><span class="p">:</span><span class="w"> </span><span class="n">list</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        @Deprecated, reason: components can have different Python versions and/or platform, therefore it&#39;s better to specify dependencies on a case-by-case basis.</span>

<span class="sd">        Collects the given Python packages with their versions from the executing Python environment and add them to all components of type `PythonComponent`.</span>

<span class="sd">        This step is necessary in order to execute the pipeline configuration on the Edge side.</span>

<span class="sd">        The method can be called multiple times but each time the previously-collected dependencies are cleared.</span>

<span class="sd">        The reason for this is to ensure a consistent dependency list for the `requirements.txt` file when the package is saved.</span>

<span class="sd">        Args:</span>

<span class="sd">            packages (list): List of the necessary python packages to execute the script defined by self.entrypoint</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">python_components</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">name</span><span class="p">])</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">PythonComponent</span><span class="p">]</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">python_components</span><span class="p">:</span>

<span class="w">            </span><span class="n">component</span><span class="o">.</span><span class="n">add_dependencies</span><span class="p">(</span><span class="n">packages</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">set_timeshifting_periodicity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">periodicity</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Enables inter-signal alignment with the given sampling period.</span>

<span class="sd">        With inter-signal alignment enabled, the AI Inference Server collects data for different input variables before it triggers the model.</span>

<span class="sd">        By default, `startingPoint` property is set to `First timestamp`, which means that inter-signal alignment is started at the</span>

<span class="sd">        first incoming value for any input variable.</span>

<span class="sd">        This property can be changed to `Signal reference` by adding inter-signal alignment reference variables</span>

<span class="sd">        via the `add_timeshifting_reference(..)` method. In this case, inter-signal alignment is started when the first value arrives</span>

<span class="sd">        for the defined input variables.</span>

<span class="sd">        Args:</span>

<span class="sd">            periodicity (int): Periodicity time in milliseconds for the AI Inference Server to perform inter-signal alignment. Valid range is [10, 2^31).</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">periodicity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">(</span><span class="n">periodicity</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">periodicity</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">31</span><span class="p">))):</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;Inter signal alignment periodicity must be an integer and in range [10, 2^31)&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">periodicity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">periodicity</span>

<span class="w">        </span><span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Inter signal alignment periodicity has been set to {self.periodicity}.&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_timeshifting_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">reference</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Enables signal alignment mode `Signal reference` by declaring input variables as reference variables.</span>

<span class="sd">        Args:</span>

<span class="sd">            reference (str): Variable name to be added to `self.timeshift_reference` list.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">reference</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p">[</span><span class="n">name</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">]:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;There is no input variable defined with name &#39;{reference}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">reference</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">timeshift_reference</span><span class="p">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Reference variable with name &#39;{reference}&#39; has been already added.&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="k">return</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">timeshift_reference</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reference</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">remove_timeshifting_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">reference</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Removes previously-defined inter-signal alignment reference variables.</span>

<span class="sd">        If no reference variables remain, the `startingPoint` will be `First timestamp`.</span>

<span class="sd">        Args:</span>

<span class="sd">            reference (str): Variable name to be removed from `self.timeshift_reference` list.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">reference</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">timeshift_reference</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Reference variable with name {&#39;reference&#39;} does not exist.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">timeshift_reference</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">reference</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">get_pipeline_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Saves the information on the composed pipeline configuration package into a YAML file.</span>

<span class="sd">        This YAML file describes the components and the data flow between them for the AI Inference Server.</span>

<span class="sd">        The file is created in the `destination` folder with name `pipeline_config.yml`</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">save_version</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">save_version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">version</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">save_package_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">save_package_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">package_id</span>

<span class="w">        </span><span class="n">pipeline_inputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>

<span class="w">        </span><span class="n">pipeline_inputs</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">[{</span>

<span class="w">            </span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">name</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">component_name</span><span class="p">]</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>

<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">component_name</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">]</span>

<span class="w">        </span><span class="n">pipeline_outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>

<span class="w">        </span><span class="n">pipeline_outputs</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">[{</span>

<span class="w">            </span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">name</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">component_name</span><span class="p">]</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">],</span>

<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">component_name</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">]</span>

<span class="w">        </span><span class="n">pipeline_outputs</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">[{</span>

<span class="w">            </span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">name</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;String&#39;</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;topic&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;/siemens/edge/aiinference/{self.name}/{self.save_version}/metrics/{component_name}/{name}&quot;</span><span class="p">,</span>

<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">component_name</span><span class="p">,</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">items</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">PythonComponent</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">component</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>

<span class="w">        </span><span class="n">pipeline_dag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[{</span>

<span class="w">            </span><span class="s1">&#39;source&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;{wire[&#39;fromComponent&#39;]}.{wire[&#39;fromOutput&#39;]}&quot;</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;target&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;{wire[&#39;toComponent&#39;]}.{wire[&#39;toInput&#39;]}&quot;</span><span class="p">,</span>

<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">wire</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">wiring</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>

<span class="w">        </span><span class="n">pipeline_dag</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">[{</span>

<span class="w">            </span><span class="s1">&#39;source&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">f</span><span class="s1">&#39;Databus.{name}&#39;</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;target&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">f</span><span class="s1">&#39;{component_name}.{name}&#39;</span><span class="p">,</span>

<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">component_name</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">]</span>

<span class="w">        </span><span class="n">pipeline_dag</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">[{</span>

<span class="w">            </span><span class="s1">&#39;source&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">f</span><span class="s1">&#39;{component_name}.{name}&#39;</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;target&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">f</span><span class="s1">&#39;Databus.{name}&#39;</span><span class="p">,</span>

<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">component_name</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">]</span>

<span class="w">        </span><span class="n">pipeline_dag</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">[{</span>

<span class="w">            </span><span class="s1">&#39;source&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">f</span><span class="s1">&#39;{component_name}.{name}&#39;</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;target&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">f</span><span class="s1">&#39;Databus.{name}&#39;</span><span class="p">,</span>

<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">component_name</span><span class="p">,</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">items</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">PythonComponent</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">component</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>

<span class="w">        </span><span class="n">config_yml_content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="s1">&#39;fileFormatVersion&#39;</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;1.2.0&#39;</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;dataFlowPipelineInfo&#39;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>

<span class="w">                </span><span class="s1">&#39;author&#39;</span><span class="p">:</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">author</span><span class="p">,</span>

<span class="w">                </span><span class="s1">&#39;createdOn&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span>

<span class="w">                </span><span class="s1">&#39;dataFlowPipelineVersion&#39;</span><span class="p">:</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">save_version</span><span class="p">,</span>

<span class="w">                </span><span class="s1">&#39;description&#39;</span><span class="p">:</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">desc</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">desc</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Created by AI SDK&#39;</span><span class="p">,</span>

<span class="w">                </span><span class="s1">&#39;projectName&#39;</span><span class="p">:</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>

<span class="w">                </span><span class="s1">&#39;packageId&#39;</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_package_id</span><span class="p">)</span>

<span class="w">            </span><span class="p">},</span>

<span class="w">            </span><span class="s1">&#39;dataFlowPipeline&#39;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>

<span class="w">                </span><span class="s1">&#39;components&#39;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="n">component</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">()</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">values</span><span class="p">()],</span>

<span class="w">                </span><span class="s1">&#39;pipelineDag&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">pipeline_dag</span><span class="p">,</span>

<span class="w">                </span><span class="s1">&#39;pipelineInputs&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">pipeline_inputs</span><span class="p">,</span>

<span class="w">                </span><span class="s1">&#39;pipelineOutputs&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">pipeline_outputs</span><span class="p">,</span>

<span class="w">            </span><span class="p">},</span>

<span class="w">            </span><span class="s1">&#39;packageType&#39;</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;full&#39;</span>

<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">items</span><span class="p">())</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">            </span><span class="n">config_yml_content</span><span class="p">[</span><span class="s2">&quot;dataFlowPipeline&quot;</span><span class="p">][</span><span class="s2">&quot;pipelineParameters&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">parameter</span><span class="p">[</span><span class="s2">&quot;topicBased&quot;</span><span class="p">]:</span>

<span class="w">                    </span><span class="n">config_yml_content</span><span class="p">[</span><span class="s2">&quot;dataFlowPipeline&quot;</span><span class="p">][</span><span class="s2">&quot;pipelineParameters&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>

<span class="w">                        </span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">parameter</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">],</span>

<span class="w">                        </span><span class="s1">&#39;defaultValue&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">parameter</span><span class="p">[</span><span class="s1">&#39;defaultValue&#39;</span><span class="p">],</span>

<span class="w">                        </span><span class="s1">&#39;topicBased&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">parameter</span><span class="p">[</span><span class="s1">&#39;topicBased&#39;</span><span class="p">],</span><span class="w"> </span><span class="s1">&#39;valueTopic&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">parameter</span><span class="p">[</span><span class="s1">&#39;valueTopic&#39;</span><span class="p">]</span>

<span class="w">                    </span><span class="p">})</span>

<span class="w">                </span><span class="k">else</span><span class="p">:</span>

<span class="w">                    </span><span class="n">config_yml_content</span><span class="p">[</span><span class="s2">&quot;dataFlowPipeline&quot;</span><span class="p">][</span><span class="s2">&quot;pipelineParameters&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>

<span class="w">                        </span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">parameter</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">],</span>

<span class="w">                        </span><span class="s1">&#39;defaultValue&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">parameter</span><span class="p">[</span><span class="s1">&#39;defaultValue&#39;</span><span class="p">]</span>

<span class="w">                    </span><span class="p">})</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">config_yml_content</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">save_pipeline_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">destination</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Saves the information about the composed pipeline configuration package into a YAML file.</span>

<span class="sd">        This YAML file describes the components and the data flow between them for AI Inference Server.</span>

<span class="sd">        The file will be created in the `destination` folder with name `pipeline_config.yml`</span>

<span class="sd">        Args:</span>

<span class="sd">            destination (path-like): Path of the `destination` directory.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">with</span><span class="w"> </span><span class="n">open</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">PIPELINE_CONFIG</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;w&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">f</span><span class="p">:</span>

<span class="w">            </span><span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_pipeline_config</span><span class="p">(),</span><span class="w"> </span><span class="n">f</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">get_datalink_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        The method generates metadata information based on available information.</span>

<span class="sd">        Returns:</span>

<span class="sd">            dict: Dictionary with the necessary information for the AI Inference Server.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">timeshifting</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="s2">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">None</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;enabled&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">False</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;periodicity&quot;</span><span class="p">:</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">periodicity</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;startingPoint&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">None</span><span class="p">,</span>

<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">periodicity</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="n">timeshifting</span><span class="p">[</span><span class="s2">&quot;enabled&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">True</span>

<span class="w">            </span><span class="n">timeshifting</span><span class="p">[</span><span class="s2">&quot;startingPoint&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;First timestamp&#39;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timeshift_reference</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">            </span><span class="n">timeshifting</span><span class="p">[</span><span class="s2">&quot;startingPoint&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Signal reference&#39;</span>

<span class="w">        </span><span class="n">exported_metadata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="s2">&quot;fileFormatVersion&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">None</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">None</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;createdOn&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span>

<span class="w">            </span><span class="s2">&quot;updatedOn&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span>

<span class="w">            </span><span class="s2">&quot;timeShifting&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">timeshifting</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;inputs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>

<span class="w">                </span><span class="p">{</span>

<span class="w">                    </span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">_name</span><span class="p">,</span>

<span class="w">                    </span><span class="s1">&#39;mapping&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">None</span><span class="p">,</span>

<span class="w">                    </span><span class="s1">&#39;timeShiftingReference&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">_name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">timeshift_reference</span><span class="p">,</span>

<span class="w">                    </span><span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">_component</span><span class="p">]</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">_name</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>

<span class="w">                </span><span class="p">}</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">_component</span><span class="p">,</span><span class="w"> </span><span class="n">_name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span>

<span class="w">            </span><span class="p">]</span>

<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">exported_metadata</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">save_datalink_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">destination</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Saves metadata for pipeline input variables.</span>

<span class="sd">        This method saves metadata for the AI Inference Server into a YAML file.</span>

<span class="sd">        This metadata determines how the AI Inference Server feeds input to the pipeline, especially inter-signal alignment.</span>

<span class="sd">        The file is created in the `destination` folder with the name `datalink_metadata.yml`</span>

<span class="sd">        Args:</span>

<span class="sd">            destination (path-like): Path of the destination directory.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">with</span><span class="w"> </span><span class="n">open</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">DATALINK_METADATA</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;w&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">f</span><span class="p">:</span>

<span class="w">            </span><span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_datalink_metadata</span><span class="p">(),</span><span class="w"> </span><span class="n">f</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">save_telemetry_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">destination</span><span class="p">:</span><span class="w"> </span><span class="n">Path</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Save telemetry data to a specified destination.</span>

<span class="sd">        Args:</span>

<span class="sd">            destination (Path): The path where the telemetry data should be saved.</span>

<span class="sd">        Returns:</span>

<span class="sd">            None</span>

<span class="sd">        Raises:</span>

<span class="sd">            None</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">telemetry_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">TELEMETRY_YAML</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="p">[</span><span class="s2">&quot;platform&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="p">[</span><span class="s2">&quot;platform&quot;</span><span class="p">][</span><span class="s2">&quot;os&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="p">[</span><span class="s2">&quot;platform&quot;</span><span class="p">][</span><span class="s2">&quot;release&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">platform</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="p">[</span><span class="s2">&quot;platform&quot;</span><span class="p">][</span><span class="s2">&quot;python_version&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">platform</span><span class="o">.</span><span class="n">python_version</span><span class="p">()</span>

<span class="w">        </span><span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;locals: {locals()}&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="p">[</span><span class="s2">&quot;environment&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="p">[</span><span class="s2">&quot;environment&quot;</span><span class="p">][</span><span class="s2">&quot;jupyter&quot;</span><span class="p">]</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="n">any</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">locals</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;__IPYTHON__&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;get_ipython&quot;</span><span class="p">])</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="p">[</span><span class="s2">&quot;environment&quot;</span><span class="p">][</span><span class="s2">&quot;gitlab_ci&quot;</span><span class="p">]</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">True</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="s2">&quot;GITLAB_CI&quot;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">MSG_NOT_FOUND</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="p">[</span><span class="s2">&quot;environment&quot;</span><span class="p">][</span><span class="s2">&quot;azure_devops&quot;</span><span class="p">]</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">True</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="s2">&quot;TF_BUILD&quot;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">MSG_NOT_FOUND</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="p">[</span><span class="s2">&quot;environment&quot;</span><span class="p">][</span><span class="s2">&quot;github_actions&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">True</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="s2">&quot;GITHUB_ACTIONS&quot;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">MSG_NOT_FOUND</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="p">[</span><span class="s2">&quot;industrial_ai&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="p">[</span><span class="s2">&quot;industrial_ai&quot;</span><span class="p">][</span><span class="s2">&quot;simaticai&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MSG_NOT_FOUND</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="p">[</span><span class="s2">&quot;industrial_ai&quot;</span><span class="p">][</span><span class="s2">&quot;vep-template-sdk&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MSG_NOT_FOUND</span>

<span class="w">        </span><span class="n">try</span><span class="p">:</span>

<span class="w">            </span><span class="n">telemetry_data</span><span class="p">[</span><span class="s2">&quot;industrial_ai&quot;</span><span class="p">][</span><span class="s2">&quot;simaticai&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkg_resources</span><span class="o">.</span><span class="n">get_distribution</span><span class="p">(</span><span class="s2">&quot;simaticai&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">version</span>

<span class="w">        </span><span class="n">except</span><span class="w"> </span><span class="n">pkg_resources</span><span class="o">.</span><span class="n">DistributionNotFound</span><span class="p">:</span>

<span class="w">            </span><span class="k">pass</span>

<span class="w">        </span><span class="n">finally</span><span class="p">:</span>

<span class="w">            </span><span class="k">pass</span>

<span class="w">        </span><span class="n">try</span><span class="p">:</span>

<span class="w">            </span><span class="n">telemetry_data</span><span class="p">[</span><span class="s2">&quot;industrial_ai&quot;</span><span class="p">][</span><span class="s2">&quot;vep-template-sdk&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkg_resources</span><span class="o">.</span><span class="n">get_distribution</span><span class="p">(</span><span class="s2">&quot;vep-template-sdk&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">version</span>

<span class="w">        </span><span class="n">except</span><span class="w"> </span><span class="n">pkg_resources</span><span class="o">.</span><span class="n">DistributionNotFound</span><span class="p">:</span>

<span class="w">            </span><span class="k">pass</span>

<span class="w">        </span><span class="n">finally</span><span class="p">:</span>

<span class="w">            </span><span class="k">pass</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="p">[</span><span class="s2">&quot;pipeline&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="p">[</span><span class="s2">&quot;pipeline&quot;</span><span class="p">][</span><span class="s2">&quot;python_versions&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">list</span><span class="p">(</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">component</span><span class="p">]</span><span class="o">.</span><span class="n">python_version</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">component</span><span class="p">],</span><span class="w"> </span><span class="n">PythonComponent</span><span class="p">)))</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="p">[</span><span class="s2">&quot;pipeline&quot;</span><span class="p">][</span><span class="s2">&quot;file_extensions&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">list</span><span class="p">(</span><span class="n">set</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">suffix</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">f</span><span class="o">.</span><span class="n">suffix</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;.zip&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;.yml&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;.yaml&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;.html&quot;</span><span class="p">]))</span>

<span class="w">        </span><span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">telemetry_data</span><span class="p">,</span><span class="w"> </span><span class="n">open</span><span class="p">(</span><span class="n">telemetry_path</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;w&#39;</span><span class="p">))</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">save_readme_html</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">destination</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Saves a `README.html` in the `destination` folder that describes the pipeline.</span>

<span class="sd">        Args:</span>

<span class="sd">            destination (path-like): Path of the destination folder.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">pipelinePage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_PipelinePage</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<span class="w">        </span><span class="n">readme_html_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">README_HTML</span>

<span class="w">        </span><span class="n">readme_html_path</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">pipelinePage</span><span class="o">.</span><span class="n">__str__</span><span class="p">())</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">destination</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Validates whether the package configuration is compatible with the expected runtime environment.</span>

<span class="sd">        The method verifies:</span>

<span class="sd">        - If the package has at least one component</span>

<span class="sd">        - If all wires create connections between existing components and their variables</span>

<span class="sd">        - If metadata is defined and valid.</span>

<span class="sd">        - If a package with the same name already exists in the `destination` folder. In this case a warning message appears and the `save(..)` method overwrites the existing package.</span>

<span class="sd">        - If the package has multiple components and if they are using the same Python version</span>

<span class="sd">        Args:</span>

<span class="sd">            destination (str, optional): Path of the expected destination folder. Defaults to &quot;.&quot;.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;The package must have at least one component.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">batch</span><span class="o">.</span><span class="n">outputBatch</span><span class="p">:</span>

<span class="w">                </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;The component &#39;{name}&#39; has pipeline output defined with variable name &#39;{variable}&#39;. </span><span class="se">\</span>

<span class="w">                                      </span><span class="n">None</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">pipeline</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">allowed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">provide</span><span class="w"> </span><span class="n">batch</span><span class="w"> </span><span class="n">output</span><span class="o">.</span><span class="s2">&quot;)</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">wire_hash</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">wiring</span><span class="o">.</span><span class="n">copy</span><span class="p">():</span>

<span class="w">            </span><span class="n">wire</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">wiring</span><span class="p">[</span><span class="n">wire_hash</span><span class="p">]</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">_check_wiring</span><span class="p">(</span><span class="n">wire</span><span class="p">,</span><span class="w"> </span><span class="n">wire_hash</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">_check_timeshifting</span><span class="p">()</span>

<span class="w">        </span><span class="n">package_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;{self.name}_{self.version}&quot;</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;-&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">package_path</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Target folder ({package_path}) already exists! Unless changing the package name the package could be invalid and your files will be overwritten!&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">python_versions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">set</span><span class="p">()</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">component</span><span class="p">]</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">component</span><span class="p">],</span><span class="w"> </span><span class="n">PythonComponent</span><span class="p">):</span>

<span class="w">                </span><span class="n">python_versions</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">component</span><span class="p">]</span><span class="o">.</span><span class="n">python_version</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">python_versions</span><span class="p">)):</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;The use of multiple python version in a single pipeline is not recommended. We recommend using only one of the supported versions, which are Python 3.10 or 3.11.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Package &#39;{self.name}&#39; is valid and ready to save.&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_check_timeshifting</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timeshift_reference</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">periodicity</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;When using inter signal alignment reference variables, the periodicity must be set.&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_check_wiring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">wire</span><span class="p">,</span><span class="w"> </span><span class="n">wire_hash</span><span class="p">):</span>

<span class="w">        </span><span class="n">error_messages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">wire</span><span class="p">[</span><span class="s1">&#39;fromComponent&#39;</span><span class="p">]</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">:</span>

<span class="w">            </span><span class="n">error_messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;From component {wire[&#39;fromComponent&#39;]} does not exist&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">wire</span><span class="p">[</span><span class="s1">&#39;toComponent&#39;</span><span class="p">]</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">:</span>

<span class="w">            </span><span class="n">error_messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;To component {wire[&#39;toComponent&#39;]} does not exist&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">wire</span><span class="p">[</span><span class="s1">&#39;fromOutput&#39;</span><span class="p">]</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">wire</span><span class="p">[</span><span class="s1">&#39;fromComponent&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">error_messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Output variable {wire[&#39;fromOutput&#39;]} does not exist on component {wire[&#39;fromComponent&#39;]}&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">wire</span><span class="p">[</span><span class="s1">&#39;toInput&#39;</span><span class="p">]</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">wire</span><span class="p">[</span><span class="s1">&#39;toComponent&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">inputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">error_messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Input variable {wire[&#39;toInput&#39;]} does not exist on component {wire[&#39;toComponent&#39;]}&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">error_messages</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">            </span><span class="n">from_type_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">wire</span><span class="p">[</span><span class="s1">&#39;fromComponent&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">wire</span><span class="p">[</span><span class="s1">&#39;fromOutput&#39;</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>

<span class="w">            </span><span class="n">to_type_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">wire</span><span class="p">[</span><span class="s1">&#39;toComponent&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">wire</span><span class="p">[</span><span class="s1">&#39;toInput&#39;</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">from_type_</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">to_type_</span><span class="p">:</span>

<span class="w">                </span><span class="n">error_messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;The types of input and output variables does not match for wiring {wire_hash}.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">error_messages</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">wiring</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">wire_hash</span><span class="p">)</span>

<span class="w">            </span><span class="n">error_messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;The wire has been deleted, please check the variables and re-create the connection.&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">error_messages</span><span class="o">.</span><span class="n">__str__</span><span class="p">())</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">package_id</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Path</span><span class="p">:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        @Deprecated, reason: only edge package generation will be supported in the future. Use export instead.</span>

<span class="sd">        Saves the assembled package in a zip format.</span>

<span class="sd">        The name of the file is defined as `{package_name}_{package_version}.zip`.</span>

<span class="sd">        If a file with such a name already exists in the `destination` folder, it gets overwritten and a warning message appears.</span>

<span class="sd">        The package is also available as a subfolder on the destination path with the name `{package_name}_{package_version}`.</span>

<span class="sd">        If the assembled content does not meet the expected one, this content can be changed and simply packed into a zip file.</span>

<span class="sd">        The package contains files and folders in the following structure:</span>

<span class="sd">        - Package folder with name `{package_name}_{package_version}`</span>

<span class="sd">            - `datalink-metadata.yml`</span>

<span class="sd">            - `pipeline-config.yml`</span>

<span class="sd">            - Component folder with name `{component_name}`</span>

<span class="sd">            When the component is a `PythonComponent`, this folder contains:</span>

<span class="sd">            - `requirements.txt`</span>

<span class="sd">            - Entrypoint script defined by the entrypoint of the component</span>

<span class="sd">            - Extra files as added to the specified folders</span>

<span class="sd">            - Source folder with name `src` with necessary python scripts</span>

<span class="sd">        If a package ID is specified, and a package with the same ID and version is already present in the `destination` folder,</span>

<span class="sd">        an error is raised.</span>

<span class="sd">        Args:</span>

<span class="sd">            destination (str, optional): Target directory for saving the package. Defaults to &quot;.&quot;.</span>

<span class="sd">            package_id (UUID): The optional package ID. If None, a new UUID is generated.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>

<span class="w">        </span><span class="n">destination</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">package_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">package_id</span><span class="p">,</span><span class="w"> </span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">):</span>

<span class="w">            </span><span class="n">package_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">(</span><span class="n">package_id</span><span class="p">)</span>

<span class="w">        </span><span class="n">prev_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span>

<span class="w">        </span><span class="n">prev_id_version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span>

<span class="w">        </span><span class="n">prev_version</span><span class="p">,</span><span class="w"> </span><span class="n">prev_with_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_find_previous</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span><span class="w"> </span><span class="n">package_id</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">prev_with_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="n">prev_id_version</span><span class="p">,</span><span class="w"> </span><span class="n">prev_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prev_with_id</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">package_id</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">prev_id</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="p">(</span><span class="n">version</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">str</span><span class="p">(</span><span class="n">prev_id_version</span><span class="p">):</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">RuntimeError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;package with version &#39;{version or self.version}&#39; and id &#39;{package_id}&#39; already exists&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">save_version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="w"> </span>\

<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="w"> </span>\

<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="s2">&quot;1&quot;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">package_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">prev_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">package_id</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">prev_id</span><span class="w"> </span>\

<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="nb">str</span><span class="p">(</span><span class="n">prev_id_version</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">prev_id_version</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="w"> </span>\

<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="nb">str</span><span class="p">(</span><span class="n">prev_version</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">prev_version</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">prev_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="w"> </span>\

<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="s2">&quot;1&quot;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">save_package_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">package_id</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">package_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="w"> </span>\

<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="n">prev_id</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">prev_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="w"> </span>\

<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span>

<span class="w">        </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;-&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">package_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;{name}_{self.save_version}&quot;</span>

<span class="w">        </span><span class="n">package_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;{package_name}.zip&quot;</span>

<span class="w">        </span><span class="n">specified_version_is_decimal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">version</span><span class="o">.</span><span class="n">isdecimal</span><span class="p">()</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">isdecimal</span><span class="p">()</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">specified_version_is_decimal</span><span class="p">:</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">package_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>

<span class="w">                </span><span class="n">p_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_extract_package_id</span><span class="p">(</span><span class="n">package_file</span><span class="p">,</span><span class="w"> </span><span class="n">False</span><span class="p">)</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">p_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">p_id</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">package_id</span><span class="p">:</span>

<span class="w">                    </span><span class="n">raise</span><span class="w"> </span><span class="n">RuntimeError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;package with version &#39;{self.save_version}&#39; and id &#39;{self.save_package_id}&#39; already exists: &#39;{package_file}&#39;&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="n">edge_package_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;{name}-edge_{self.save_version}.zip&quot;</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">edge_package_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>

<span class="w">                </span><span class="n">p_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_extract_package_id</span><span class="p">(</span><span class="n">edge_package_file</span><span class="p">,</span><span class="w"> </span><span class="n">True</span><span class="p">)</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">p_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">p_id</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">package_id</span><span class="p">:</span>

<span class="w">                    </span><span class="n">raise</span><span class="w"> </span><span class="n">RuntimeError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;package with version &#39;{self.save_version}&#39; and id &#39;{self.save_package_id}&#39; already exists: &#39;{edge_package_file}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">destination</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">package_name</span>

<span class="w">        </span><span class="n">destination</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="n">True</span><span class="p">,</span><span class="w"> </span><span class="n">exist_ok</span><span class="o">=</span><span class="n">True</span><span class="p">)</span>

<span class="w">        </span><span class="c1"># Save</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">component</span><span class="p">]</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span><span class="w"> </span><span class="n">False</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">save_datalink_metadata</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">save_pipeline_config</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">save_readme_html</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">save_telemetry_data</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>

<span class="w">        </span><span class="n">zip_destination</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">shutil</span><span class="o">.</span><span class="n">make_archive</span><span class="p">(</span>

<span class="w">            </span><span class="n">base_name</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">destination</span><span class="o">.</span><span class="n">parent</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">package_name</span><span class="p">),</span><span class="w"> </span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;zip&#39;</span><span class="p">,</span>

<span class="w">            </span><span class="n">root_dir</span><span class="o">=</span><span class="n">destination</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span><span class="w"> </span><span class="n">base_dir</span><span class="o">=</span><span class="n">package_name</span><span class="p">,</span>

<span class="w">            </span><span class="n">verbose</span><span class="o">=</span><span class="n">True</span><span class="p">,</span><span class="w"> </span><span class="n">logger</span><span class="o">=</span><span class="n">_logger</span><span class="p">)</span>

<span class="w">        </span><span class="n">pipeline_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">zip_destination</span><span class="p">)</span><span class="w">  </span><span class="c1"># zipped package size in bytes</span>

<span class="w">        </span><span class="n">pipeline_size_GB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;{:.2f}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pipeline_size</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1000</span><span class="p">)</span>

<span class="w">        </span><span class="n">pipeline_size_limit_GB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;{:.2f}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PIPELINE_SIZE_LIMIT</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1000</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">pipeline_size</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">PIPELINE_SIZE_LIMIT</span><span class="p">:</span>

<span class="w">            </span><span class="n">error_msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;Pipeline size {pipeline_size} bytes ({pipeline_size_GB} GB) exceeds the limit of &quot;</span><span class="w"> </span>\

<span class="w">                        </span><span class="n">f</span><span class="s2">&quot;{PIPELINE_SIZE_LIMIT} bytes ({pipeline_size_limit_GB} GB). &quot;</span><span class="w"> </span>\

<span class="w">                        </span><span class="s2">&quot;Please remove unnecessary files and dependencies and try again.&quot;</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">RuntimeError</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">zip_destination</span><span class="p">)</span>

<span class="w">    </span><span class="c1"># TODO: reduce Cognitive complexity if possible</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_find_previous</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">destination</span><span class="p">:</span><span class="w"> </span><span class="n">Path</span><span class="p">,</span><span class="w"> </span><span class="n">package_id</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Tuple</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="nb nb-Type">int</span><span class="p">],</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb nb-Type">int</span><span class="p">,</span><span class="w"> </span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">]]]:</span>

<span class="w">        </span><span class="n">latest_version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span>

<span class="w">        </span><span class="n">latest_with_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">destination</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>

<span class="w">            </span><span class="n">package_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;-&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">destination</span><span class="o">.</span><span class="n">iterdir</span><span class="p">():</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>

<span class="w">                    </span><span class="k">continue</span>

<span class="w">                </span><span class="k">match</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">re</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;{package_name}(-edge)?_([1-9][0-9]*).zip&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">                    </span><span class="k">continue</span>

<span class="w">                </span><span class="n">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">(</span><span class="k">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

<span class="w">                </span><span class="n">pack_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_extract_package_id</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="k">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">)</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">pack_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="p">(</span><span class="n">package_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">pack_id</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">package_id</span><span class="p">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="p">(</span><span class="n">latest_with_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">latest_with_id</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">version</span><span class="p">):</span>

<span class="w">                    </span><span class="n">latest_with_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">version</span><span class="p">,</span><span class="w"> </span><span class="n">pack_id</span>

<span class="w">                </span><span class="k">elif</span><span class="w"> </span><span class="n">pack_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="p">(</span><span class="n">latest_version</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">latest_version</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">version</span><span class="p">):</span>

<span class="w">                    </span><span class="n">latest_version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">version</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">latest_version</span><span class="p">,</span><span class="w"> </span><span class="n">latest_with_id</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_extract_package_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">package_file</span><span class="p">:</span><span class="w"> </span><span class="n">Path</span><span class="p">,</span><span class="w"> </span><span class="n">is_edge_package</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">]:</span>

<span class="w">        </span><span class="n">try</span><span class="p">:</span>

<span class="w">            </span><span class="n">with</span><span class="w"> </span><span class="n">OpenZipInTemp</span><span class="p">(</span><span class="n">package_file</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">package_dir</span><span class="p">:</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">is_edge_package</span><span class="p">:</span>

<span class="w">                    </span><span class="n">package_dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">package_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">package_file</span><span class="o">.</span><span class="n">stem</span>

<span class="w">                </span><span class="n">with</span><span class="w"> </span><span class="n">open</span><span class="p">(</span><span class="n">package_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s1">&#39;pipeline_config.yml&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">config_file</span><span class="p">:</span>

<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">(</span><span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">config_file</span><span class="p">,</span><span class="w"> </span><span class="n">Loader</span><span class="o">=</span><span class="n">yaml</span><span class="o">.</span><span class="n">SafeLoader</span><span class="p">)[</span><span class="s2">&quot;dataFlowPipelineInfo&quot;</span><span class="p">][</span><span class="s2">&quot;packageId&quot;</span><span class="p">])</span>

<span class="w">        </span><span class="n">except</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">e</span><span class="p">:</span>

<span class="w">            </span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Could not extract Package ID from &#39;{package_file}&#39;: {e}&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="k">export</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">package_id</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Path</span><span class="p">:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Export a runnable pipeline package.</span>

<span class="sd">        Args:</span>

<span class="sd">            destination (str): optional target directory for saving the package. Defaults to &quot;.&quot;.</span>

<span class="sd">            package_id (UUID): optional package ID. If None, a new UUID is generated.</span>

<span class="sd">            version (str): optional version. If None, an automatic version number is generated.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">config_package</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span>

<span class="w">        </span><span class="n">try</span><span class="p">:</span>

<span class="w">            </span><span class="n">config_package</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span><span class="w"> </span><span class="n">package_id</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">)</span>

<span class="w">            </span><span class="n">runtime_package</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">convert_package</span><span class="p">(</span><span class="n">config_package</span><span class="p">)</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">runtime_package</span>

<span class="w">        </span><span class="n">finally</span><span class="p">:</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">config_package</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">                </span><span class="n">Path</span><span class="p">(</span><span class="n">config_package</span><span class="p">)</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">missing_ok</span><span class="o">=</span><span class="n">True</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_parameter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">default_value</span><span class="p">,</span><span class="w"> </span><span class="n">type_name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;String&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">topic_based</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Adds a parameter to the pipeline configuration, which alters the behavior of the pipeline.</span>

<span class="sd">        The parameter&#39;s default value and its properties are saved in the pipeline configuration</span>

<span class="sd">        and the value of the parameter can later be changed on AI Inference Server.</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Name of the parameter</span>

<span class="sd">            desc (str): Description of the parameter (optional)</span>

<span class="sd">            type_name (str, optional): Data type of the parameter. Defaults to &quot;String&quot;.</span>

<span class="sd">            default_value (str): Default value of the parameter</span>

<span class="sd">            topic_based (bool, optional): If true, the parameter can be updated from a message queue.</span>

<span class="sd">        Raises:</span>

<span class="sd">            ValueError:</span>

<span class="sd">                When:</span>

<span class="sd">                - the default value of the parameter is not of the specified data type (`type_name`) or</span>

<span class="sd">                - the specified data type itself is not an allowed data type (not a part of `parameter_types` dict) or</span>

<span class="sd">                - the specified data type is not given in the right format or</span>

<span class="sd">                - the type of the given `topic_based` parameter is not `bool`.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">parameter_types</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="s2">&quot;String&quot;</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;str&#39;</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;Integer&quot;</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;int&#39;</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;Double&quot;</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;float&#39;</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;Boolean&quot;</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;bool&#39;</span>

<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">default_value_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">type</span><span class="p">(</span><span class="n">default_value</span><span class="p">)</span><span class="o">.</span><span class="n">__name__</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">type_name</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">parameter_types</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;The given value type is not supported. Please use one of these: {parameter_types.keys()}&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">default_value_type</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">parameter_types</span><span class="p">[</span><span class="n">type_name</span><span class="p">]:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;The given value type does not match the type of &#39;{type_name}&#39;. Please use the correct one from these: {list(parameter_types.keys())}&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">topic_based</span><span class="p">,</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="p">):</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="s2">&quot;Type of the given `topic_based` parameter is not `bool`.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">name</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">type_name</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;defaultValue&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">default_value</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;topicBased&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">topic_based</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;valueTopic&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">None</span>

<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">desc</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;desc&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">desc</span>
</code></pre></div>

</details>
<hr />
<h4 id="static-methods">Static methods</h4>
<h4 id="from_components">from_components</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">from_components</span><span class="p">(</span>
    <span class="n">components</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">version</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">desc</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Pipeline&#39;</span>
</code></pre></div>

<p>Creates a pipeline configuration from the given components.</p>
<p>The components are linked in a linear sequence with inputs and outputs auto-wired based on the name of the inputs and outputs of the components.
The inputs of the first component will be wired as the pipeline inputs and the outputs of the last component will be wired as the pipeline outputs.
The components must have unique names. Two or more versions of the same component can not be packaged simultaneously without renaming them.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>components</td>
<td>list</td>
<td>List of PythonComponents</td>
<td>None</td>
</tr>
<tr>
<td>name</td>
<td>str</td>
<td>Name of the pipeline</td>
<td>None</td>
</tr>
<tr>
<td>version</td>
<td>str</td>
<td>Version information of the pipeline. (Optional)</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Pipeline</td>
<td>Pipeline object with the auto-wired components</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@staticmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">from_components</span><span class="p">(</span><span class="nl">components</span><span class="p">:</span><span class="w"> </span><span class="n">list</span><span class="p">,</span><span class="w"> </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="nl">version</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">str</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="k">desc</span><span class="err">:</span><span class="w"> </span><span class="nf">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="ss">&quot;Pipeline&quot;</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Creates a pipeline configuration from the given components.</span>

<span class="ss">        The components are linked in a linear sequence with inputs and outputs auto-wired based on the name of the inputs and outputs of the components.</span>

<span class="ss">        The inputs of the first component will be wired as the pipeline inputs and the outputs of the last component will be wired as the pipeline outputs.</span>

<span class="ss">        The components must have unique names. Two or more versions of the same component can not be packaged simultaneously without renaming them.</span>

<span class="ss">        Args:</span>

<span class="ss">            components (list): List of PythonComponents</span>

<span class="ss">            name (str): Name of the pipeline</span>

<span class="ss">            version (str): Version information of the pipeline. (Optional)</span>

<span class="ss">        Returns:</span>

<span class="ss">            Pipeline: Pipeline object with the auto-wired components</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">pipeline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Pipeline</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">,</span><span class="w"> </span><span class="k">desc</span><span class="o">=</span><span class="k">desc</span><span class="p">)</span>

<span class="w">        </span><span class="n">first_component</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">components</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>

<span class="w">        </span><span class="n">pipeline</span><span class="p">.</span><span class="n">add_component</span><span class="p">(</span><span class="n">first_component</span><span class="p">)</span>

<span class="w">        </span><span class="n">pipeline</span><span class="p">.</span><span class="n">inputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">(first_component.name, component_input) for component_input in first_component.inputs</span><span class="o">]</span>

<span class="w">        </span><span class="n">pipeline</span><span class="p">.</span><span class="n">outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">(first_component.name, output) for output in first_component.outputs</span><span class="o">]</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">components</span><span class="o">[</span><span class="n">1:</span><span class="o">]</span><span class="err">:</span>

<span class="w">            </span><span class="n">pipeline</span><span class="p">.</span><span class="n">add_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">wire_component</span><span class="p">,</span><span class="w"> </span><span class="n">wire_name</span><span class="p">)</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">pipeline</span><span class="p">.</span><span class="nl">outputs</span><span class="p">:</span>

<span class="w">                </span><span class="k">try</span><span class="err">:</span>

<span class="w">                    </span><span class="n">pipeline</span><span class="p">.</span><span class="n">add_wiring</span><span class="p">(</span><span class="n">wire_component</span><span class="p">,</span><span class="w"> </span><span class="n">wire_name</span><span class="p">,</span><span class="w"> </span><span class="n">component</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">wire_name</span><span class="p">)</span>

<span class="w">                </span><span class="ow">except</span><span class="w"> </span><span class="k">Exception</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">e</span><span class="p">:</span>

<span class="w">                    </span><span class="n">_logger</span><span class="p">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;Output variable {wire_component}.{wire_name} couldn&#39;t be auto-wired.\nCause: {e}&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="n">unwired_variables</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">f&#39;{component.name}.{x}&#39; for x in component.inputs if not any(s.endswith(f&#39;{component.name}.{x}&#39;) for s in pipeline.wiring)</span><span class="o">]</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">unwired_variables</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="err">:</span>

<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="k">variable</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">unwired_variables</span><span class="p">:</span>

<span class="w">                    </span><span class="n">_logger</span><span class="p">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;Input variable {variable} couldn&#39;t be auto-wired.\n&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="n">pipeline</span><span class="p">.</span><span class="n">outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">(component.name, output) for output in component.outputs</span><span class="o">]</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">pipeline</span>
</code></pre></div>

</details>
<h4 id="methods_2">Methods</h4>
<h4 id="add_component">add_component</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">add_component</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">component</span><span class="p">:</span> <span class="n">simaticai</span><span class="o">.</span><span class="n">deployment</span><span class="o">.</span><span class="n">Component</span>
<span class="p">)</span>
</code></pre></div>

<p>Adds a <code>Component</code> to the pipeline configuration without any connection.</p>
<p>The <code>Component</code> can be marked as an input or output component of the pipeline.
When these parameters are True, the <code>Component</code> is responsible for input or output data of the pipeline.
The component must have a unique name. Two or more versions of the same component can not be added to the same pipeline with the same component name.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>component</td>
<td>Component</td>
<td><code>Component</code> to be added</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_component</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">component</span><span class="o">:</span><span class="w"> </span><span class="k">Component</span><span class="p">)</span><span class="o">:</span>

<span class="w">        </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span>

<span class="s2">        Adds a `Component` to the pipeline configuration without any connection.</span>

<span class="s2">        The `Component` can be marked as an input or output component of the pipeline.</span>

<span class="s2">        When these parameters are True, the `Component` is responsible for input or output data of the pipeline.</span>

<span class="s2">        The component must have a unique name. Two or more versions of the same component can not be added to the same pipeline with the same component name.</span>

<span class="s2">        Args:</span>

<span class="s2">            component (Component): `Component` to be added</span>

<span class="s2">        </span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="k">component</span><span class="p">.</span><span class="k">name</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">components</span><span class="o">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Component with name {component.name} already exists. Please rename the component.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">components</span><span class="err">[</span><span class="k">component</span><span class="p">.</span><span class="k">name</span><span class="err">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">component</span>
</code></pre></div>

</details>
<h4 id="add_dependencies">add_dependencies</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">add_dependencies</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">packages</span><span class="p">:</span> <span class="nb">list</span>
<span class="p">)</span>
</code></pre></div>

<p>@Deprecated, reason: components can have different Python versions and/or platform, therefore it's better to specify dependencies on a case-by-case basis.</p>
<p>Collects the given Python packages with their versions from the executing Python environment and add them to all components of type <code>PythonComponent</code>.
This step is necessary in order to execute the pipeline configuration on the Edge side.
The method can be called multiple times but each time the previously-collected dependencies are cleared.
The reason for this is to ensure a consistent dependency list for the <code>requirements.txt</code> file when the package is saved.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>packages</td>
<td>list</td>
<td>List of the necessary python packages to execute the script defined by self.entrypoint</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_dependencies</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">packages</span><span class="p">:</span><span class="w"> </span><span class="n">list</span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        @Deprecated, reason: components can have different Python versions and/or platform, therefore it&#39;s better to specify dependencies on a case-by-case basis.</span>

<span class="ss">        Collects the given Python packages with their versions from the executing Python environment and add them to all components of type `PythonComponent`.</span>

<span class="ss">        This step is necessary in order to execute the pipeline configuration on the Edge side.</span>

<span class="ss">        The method can be called multiple times but each time the previously-collected dependencies are cleared.</span>

<span class="ss">        The reason for this is to ensure a consistent dependency list for the `requirements.txt` file when the package is saved.</span>

<span class="ss">        Args:</span>

<span class="ss">            packages (list): List of the necessary python packages to execute the script defined by self.entrypoint</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">python_components</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">self.components[name</span><span class="o">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">components</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">type</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">components</span><span class="o">[</span><span class="n">name</span><span class="o">]</span><span class="p">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">PythonComponent</span><span class="err">]</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">python_components</span><span class="p">:</span>

<span class="w">            </span><span class="n">component</span><span class="p">.</span><span class="n">add_dependencies</span><span class="p">(</span><span class="n">packages</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="add_input_2">add_input</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">add_input</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">component</span><span class="p">,</span>
    <span class="n">variable</span>
<span class="p">)</span>
</code></pre></div>

<p>Defines an input variable on the given component as a pipeline input.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>component</td>
<td>str</td>
<td>Name of the component</td>
<td>None</td>
</tr>
<tr>
<td>variable</td>
<td>str</td>
<td>Name of the input variable</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_input</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="k">variable</span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Defines an input variable on the given component as a pipeline input.</span>

<span class="ss">        Args:</span>

<span class="ss">            component (str): Name of the component</span>

<span class="ss">            variable (str): Name of the input variable</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">try</span><span class="err">:</span>

<span class="w">            </span><span class="n">_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">components</span><span class="o">[</span><span class="n">component</span><span class="o">]</span><span class="p">.</span><span class="n">inputs</span><span class="o">[</span><span class="n">variable</span><span class="o">]</span>

<span class="w">        </span><span class="ow">except</span><span class="w"> </span><span class="nl">KeyError</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="ss">&quot;The component with input variable must exist in the pipeline.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">inputs</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">inputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[]</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="k">variable</span><span class="p">)</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">inputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="ss">&quot;The pipeline input already exists.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">inputs</span><span class="p">.</span><span class="n">append</span><span class="p">((</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="k">variable</span><span class="p">))</span>
</code></pre></div>

</details>
<h4 id="add_output_2">add_output</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">add_output</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">component</span><span class="p">,</span>
    <span class="n">variable</span>
<span class="p">)</span>
</code></pre></div>

<p>Defines an output variable on the given component as a pipeline output.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>component</td>
<td>str</td>
<td>Name of the component</td>
<td>None</td>
</tr>
<tr>
<td>variable</td>
<td>str</td>
<td>Name of the output variable</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_output</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="k">variable</span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Defines an output variable on the given component as a pipeline output.</span>

<span class="ss">        Args:</span>

<span class="ss">            component (str): Name of the component</span>

<span class="ss">            variable (str): Name of the output variable</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">try</span><span class="err">:</span>

<span class="w">            </span><span class="n">_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">components</span><span class="o">[</span><span class="n">component</span><span class="o">]</span><span class="p">.</span><span class="n">outputs</span><span class="o">[</span><span class="n">variable</span><span class="o">]</span>

<span class="w">        </span><span class="ow">except</span><span class="w"> </span><span class="nl">KeyError</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="ss">&quot;The component with output variable must exist in the pipeline.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">outputs</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[]</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="k">variable</span><span class="p">)</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="ss">&quot;The pipeline output already exists.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">outputs</span><span class="p">.</span><span class="n">append</span><span class="p">((</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="k">variable</span><span class="p">))</span>
</code></pre></div>

</details>
<h4 id="add_parameter">add_parameter</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">add_parameter</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">,</span>
    <span class="n">default_value</span><span class="p">,</span>
    <span class="n">type_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;String&#39;</span><span class="p">,</span>
    <span class="n">topic_based</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">desc</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

<p>Adds a parameter to the pipeline configuration, which alters the behavior of the pipeline.</p>
<p>The parameter's default value and its properties are saved in the pipeline configuration
and the value of the parameter can later be changed on AI Inference Server.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>str</td>
<td>Name of the parameter</td>
<td>None</td>
</tr>
<tr>
<td>desc</td>
<td>str</td>
<td>Description of the parameter (optional)</td>
<td>None</td>
</tr>
<tr>
<td>type_name</td>
<td>str</td>
<td>Data type of the parameter. Defaults to "String".</td>
<td>"String"</td>
</tr>
<tr>
<td>default_value</td>
<td>str</td>
<td>Default value of the parameter</td>
<td>None</td>
</tr>
<tr>
<td>topic_based</td>
<td>bool</td>
<td>If true, the parameter can be updated from a message queue.</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Raises:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>ValueError</td>
<td>When:<br/>- the default value of the parameter is not of the specified data type (<code>type_name</code>) or<br/>- the specified data type itself is not an allowed data type (not a part of <code>parameter_types</code> dict) or<br/>- the specified data type is not given in the right format or<br/>- the type of the given <code>topic_based</code> parameter is not <code>bool</code>.</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_parameter</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="n">default_value</span><span class="p">,</span><span class="w"> </span><span class="n">type_name</span><span class="o">:</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;String&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">topic_based</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="k">desc</span><span class="o">:</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">)</span><span class="o">:</span>

<span class="w">        </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span>

<span class="s2">        Adds a parameter to the pipeline configuration, which alters the behavior of the pipeline.</span>

<span class="s2">        The parameter&#39;s default value and its properties are saved in the pipeline configuration</span>

<span class="s2">        and the value of the parameter can later be changed on AI Inference Server.</span>

<span class="s2">        Args:</span>

<span class="s2">            name (str): Name of the parameter</span>

<span class="s2">            desc (str): Description of the parameter (optional)</span>

<span class="s2">            type_name (str, optional): Data type of the parameter. Defaults to &quot;</span><span class="k">String</span><span class="s2">&quot;.</span>

<span class="s2">            default_value (str): Default value of the parameter</span>

<span class="s2">            topic_based (bool, optional): If true, the parameter can be updated from a message queue.</span>

<span class="s2">        Raises:</span>

<span class="s2">            ValueError:</span>

<span class="s2">                When:</span>

<span class="s2">                - the default value of the parameter is not of the specified data type (`type_name`) or</span>

<span class="s2">                - the specified data type itself is not an allowed data type (not a part of `parameter_types` dict) or</span>

<span class="s2">                - the specified data type is not given in the right format or</span>

<span class="s2">                - the type of the given `topic_based` parameter is not `bool`.</span>

<span class="s2">        </span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="n">parameter_types</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span>

<span class="w">            </span><span class="s2">&quot;String&quot;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;str&#39;</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;Integer&quot;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;int&#39;</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;Double&quot;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;float&#39;</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;Boolean&quot;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;bool&#39;</span>

<span class="w">        </span><span class="err">}</span>

<span class="w">        </span><span class="n">default_value_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">type</span><span class="p">(</span><span class="n">default_value</span><span class="p">).</span><span class="n">__name__</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">type_name</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">parameter_types</span><span class="p">.</span><span class="k">keys</span><span class="p">()</span><span class="o">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;The given value type is not supported. Please use one of these: {parameter_types.keys()}&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">default_value_type</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">parameter_types</span><span class="err">[</span><span class="n">type_name</span><span class="err">]</span><span class="o">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;The given value type does not match the type of &#39;{type_name}&#39;. Please use the correct one from these: {list(parameter_types.keys())}&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">topic_based</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="p">)</span><span class="o">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="s2">&quot;Type of the given `topic_based` parameter is not `bool`.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">parameters</span><span class="err">[</span><span class="k">name</span><span class="err">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span>

<span class="w">            </span><span class="s2">&quot;name&quot;</span><span class="o">:</span><span class="w"> </span><span class="k">name</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;type&quot;</span><span class="o">:</span><span class="w"> </span><span class="n">type_name</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;defaultValue&quot;</span><span class="o">:</span><span class="w"> </span><span class="n">default_value</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;topicBased&quot;</span><span class="o">:</span><span class="w"> </span><span class="n">topic_based</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;valueTopic&quot;</span><span class="o">:</span><span class="w"> </span><span class="k">None</span>

<span class="w">        </span><span class="err">}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="k">desc</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">None</span><span class="o">:</span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">parameters</span><span class="err">[</span><span class="k">name</span><span class="err">][</span><span class="s2">&quot;desc&quot;</span><span class="err">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">desc</span>
</code></pre></div>

</details>
<h4 id="add_timeshifting_reference">add_timeshifting_reference</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">add_timeshifting_reference</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">reference</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span>
</code></pre></div>

<p>Enables signal alignment mode <code>Signal reference</code> by declaring input variables as reference variables.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>reference</td>
<td>str</td>
<td>Variable name to be added to <code>self.timeshift_reference</code> list.</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_timeshifting_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">reference</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Enables signal alignment mode `Signal reference` by declaring input variables as reference variables.</span>

<span class="sd">        Args:</span>

<span class="sd">            reference (str): Variable name to be added to `self.timeshift_reference` list.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">reference</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p">[</span><span class="n">name</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">]:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;There is no input variable defined with name &#39;{reference}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">reference</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">timeshift_reference</span><span class="p">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Reference variable with name &#39;{reference}&#39; has been already added.&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="k">return</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">timeshift_reference</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reference</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="add_wiring">add_wiring</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">add_wiring</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">from_component</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">from_output</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">to_component</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">to_input</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span>
</code></pre></div>

<p>Creates a one-to-one connection between the input and output of two components.</p>
<p>The method checks if the connection is allowed with the following requirements:</p>
<ul>
<li>The components exist with the given inputs/outputs</li>
<li>The given inputs and outputs are not connected to any wire</li>
<li>The types of the connected input and output are compatible</li>
</ul>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>from_component</td>
<td>str</td>
<td>Name of the component which provides data to the <code>to_component</code></td>
<td>None</td>
</tr>
<tr>
<td>from_output</td>
<td>str</td>
<td>Name of the output variable of the <code>from_component</code></td>
<td>None</td>
</tr>
<tr>
<td>to_component</td>
<td>str</td>
<td>Name of the component which consumes data from the <code>from_component</code></td>
<td>None</td>
</tr>
<tr>
<td>to_input</td>
<td>str</td>
<td>Name of the input variable of the <code>to_component</code></td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_wiring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">from_component</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">from_output</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">to_component</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">to_input</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Creates a one-to-one connection between the input and output of two components.</span>

<span class="sd">        The method checks if the connection is allowed with the following requirements:</span>

<span class="sd">        - The components exist with the given inputs/outputs</span>

<span class="sd">        - The given inputs and outputs are not connected to any wire</span>

<span class="sd">        - The types of the connected input and output are compatible</span>

<span class="sd">        Args:</span>

<span class="sd">            from_component (str): Name of the component which provides data to the `to_component`</span>

<span class="sd">            from_output (str): Name of the output variable of the `from_component`</span>

<span class="sd">            to_component (str): Name of the component which consumes data from the `from_component`</span>

<span class="sd">            to_input (str): Name of the input variable of the `to_component`</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">from_component</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;No component named &#39;{from_component}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">to_component</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;No component named &#39;{to_component}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">from_output</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">from_component</span><span class="p">]</span><span class="o">.</span><span class="n">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Component &#39;{from_component}&#39; has no output named &#39;{from_output}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">to_input</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">to_component</span><span class="p">]</span><span class="o">.</span><span class="n">inputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Component &#39;{to_component}&#39; has no input named &#39;{to_input}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">get_wire_for_input</span><span class="p">(</span><span class="n">to_component</span><span class="p">,</span><span class="w"> </span><span class="n">to_input</span><span class="p">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Input &#39;{to_input}&#39; of component &#39;{to_component}&#39; is already wired&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">_output_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">from_component</span><span class="p">]</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">from_output</span><span class="p">][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span>

<span class="w">        </span><span class="n">_input_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">to_component</span><span class="p">]</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">to_input</span><span class="p">][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">_output_type</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">_input_type</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;Output and input types do not match&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">wire_hash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_wire_hash_string</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">from_component</span><span class="p">,</span><span class="w"> </span><span class="n">from_output</span><span class="p">,</span><span class="w"> </span><span class="n">to_component</span><span class="p">,</span><span class="w"> </span><span class="n">to_input</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">wiring</span><span class="p">[</span><span class="n">wire_hash</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="s2">&quot;fromComponent&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">from_component</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;fromOutput&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">from_output</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;toComponent&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">to_component</span><span class="p">,</span>

<span class="w">            </span><span class="s2">&quot;toInput&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">to_input</span><span class="p">,</span>

<span class="w">        </span><span class="p">}</span>
</code></pre></div>

</details>
<h4 id="delete_input_2">delete_input</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">delete_input</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">component</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">variable</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span>
</code></pre></div>

<p>Deletes a pipeline input.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>component</td>
<td>str</td>
<td>Name of the component</td>
<td>None</td>
</tr>
<tr>
<td>variable</td>
<td>str</td>
<td>Name of the input variable</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">delete_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">component</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Deletes a pipeline input.</span>

<span class="sd">        Args:</span>

<span class="sd">            component (str): Name of the component</span>

<span class="sd">            variable (str): Name of the input variable</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">)</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;The pipeline input does not exist.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">remove</span><span class="p">((</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">))</span>
</code></pre></div>

</details>
<h4 id="delete_input_wire">delete_input_wire</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">delete_input_wire</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">component</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">variable</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">with_input</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span>
</code></pre></div>

<p>Deletes an existing connection between two components.</p>
<p>The connection must be given with the name of the consumer component and its input variable.
If an inter signal alignment reference variable is affected it cannot be deleted.
By default, the input variable will be also deleted.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>component</td>
<td>str</td>
<td>Name of the component which has the input given the name variable</td>
<td>None</td>
</tr>
<tr>
<td>variable</td>
<td>str</td>
<td>Name of the input variable on the component which connected by the wire</td>
<td>None</td>
</tr>
<tr>
<td>with_input</td>
<td>bool</td>
<td>If set, the input variable will be also deleted from the component. Defaults to True.</td>
<td>True</td>
</tr>
</tbody>
</table>
<p><strong>Raises:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>AssertionError</td>
<td>When the variable acts as inter signal alignment reference, it cannot be deleted, and an <code>AssertionError</code> will be raised.</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">delete_input_wire</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">component</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">with_input</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">True</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Deletes an existing connection between two components.</span>

<span class="sd">        The connection must be given with the name of the consumer component and its input variable.</span>

<span class="sd">        If an inter signal alignment reference variable is affected it cannot be deleted.</span>

<span class="sd">        By default, the input variable will be also deleted.</span>

<span class="sd">        Args:</span>

<span class="sd">            component (str): Name of the component which has the input given the name variable</span>

<span class="sd">            variable (str): Name of the input variable on the component which connected by the wire</span>

<span class="sd">            with_input (bool, optional): If set, the input variable will be also deleted from the component. Defaults to True.</span>

<span class="sd">        Raises:</span>

<span class="sd">            AssertionError: When the variable acts as inter signal alignment reference, it cannot be deleted, and an `AssertionError` will be raised.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">wire</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">get_wire_for_input</span><span class="p">(</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">wire</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;There is no wiring for input &#39;{variable}&#39; of component &#39;{component}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">timeshift_reference</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;Inter signal alignment reference variables can not be deleted.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">wire_hash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_wire_hash_string</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wire</span><span class="p">[</span><span class="s1">&#39;fromComponent&#39;</span><span class="p">],</span><span class="w"> </span><span class="n">wire</span><span class="p">[</span><span class="s1">&#39;fromOutput&#39;</span><span class="p">],</span><span class="w"> </span><span class="n">wire</span><span class="p">[</span><span class="s1">&#39;toComponent&#39;</span><span class="p">],</span><span class="w"> </span><span class="n">wire</span><span class="p">[</span><span class="s1">&#39;toInput&#39;</span><span class="p">])</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">wiring</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">wire_hash</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">with_input</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">component</span><span class="p">]</span><span class="o">.</span><span class="n">delete_input</span><span class="p">(</span><span class="n">variable</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="delete_output_2">delete_output</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">delete_output</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">component</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">variable</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span>
</code></pre></div>

<p>Deletes a pipeline output.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>component</td>
<td>str</td>
<td>Name of the component</td>
<td>None</td>
</tr>
<tr>
<td>variable</td>
<td>str</td>
<td>Name of the input variable</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">delete_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">component</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Deletes a pipeline output.</span>

<span class="sd">        Args:</span>

<span class="sd">            component (str): Name of the component</span>

<span class="sd">            variable (str): Name of the input variable</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">)</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;The pipeline output does not exist.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">remove</span><span class="p">((</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">))</span>
</code></pre></div>

</details>
<h4 id="export">export</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">export</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">destination</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
    <span class="n">package_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">version</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span>
</code></pre></div>

<p>Export a runnable pipeline package.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>destination</td>
<td>str</td>
<td>optional target directory for saving the package. Defaults to ".".</td>
<td>"."</td>
</tr>
<tr>
<td>package_id</td>
<td>UUID</td>
<td>optional package ID. If None, a new UUID is generated.</td>
<td>None</td>
</tr>
<tr>
<td>version</td>
<td>str</td>
<td>optional version. If None, an automatic version number is generated.</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">export</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;.&quot;</span><span class="p">,</span><span class="w"> </span><span class="nl">package_id</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">uuid.UUID</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="nl">version</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">str</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">Path</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Export a runnable pipeline package.</span>

<span class="ss">        Args:</span>

<span class="ss">            destination (str): optional target directory for saving the package. Defaults to &quot;</span><span class="p">.</span><span class="ss">&quot;.</span>

<span class="ss">            package_id (UUID): optional package ID. If None, a new UUID is generated.</span>

<span class="ss">            version (str): optional version. If None, an automatic version number is generated.</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">config_package</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span>

<span class="w">        </span><span class="k">try</span><span class="err">:</span>

<span class="w">            </span><span class="n">config_package</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="k">save</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span><span class="w"> </span><span class="n">package_id</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">)</span>

<span class="w">            </span><span class="n">runtime_package</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">convert_package</span><span class="p">(</span><span class="n">config_package</span><span class="p">)</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">runtime_package</span>

<span class="w">        </span><span class="nl">finally</span><span class="p">:</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">config_package</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">                </span><span class="k">Path</span><span class="p">(</span><span class="n">config_package</span><span class="p">).</span><span class="n">unlink</span><span class="p">(</span><span class="n">missing_ok</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="get_datalink_metadata">get_datalink_metadata</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_datalink_metadata</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<p>The method generates metadata information based on available information.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>dict</td>
<td>Dictionary with the necessary information for the AI Inference Server.</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">get_datalink_metadata</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        The method generates metadata information based on available information.</span>

<span class="ss">        Returns:</span>

<span class="ss">            dict: Dictionary with the necessary information for the AI Inference Server.</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">timeshifting</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span>

<span class="w">            </span><span class="ss">&quot;id&quot;</span><span class="err">:</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">            </span><span class="ss">&quot;enabled&quot;</span><span class="err">:</span><span class="w"> </span><span class="k">False</span><span class="p">,</span>

<span class="w">            </span><span class="ss">&quot;periodicity&quot;</span><span class="err">:</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">periodicity</span><span class="p">,</span>

<span class="w">            </span><span class="ss">&quot;startingPoint&quot;</span><span class="err">:</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">        </span><span class="err">}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">periodicity</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="n">timeshifting</span><span class="o">[</span><span class="n">&quot;enabled&quot;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span>

<span class="w">            </span><span class="n">timeshifting</span><span class="o">[</span><span class="n">&quot;startingPoint&quot;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;First timestamp&#39;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">timeshift_reference</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="err">:</span>

<span class="w">            </span><span class="n">timeshifting</span><span class="o">[</span><span class="n">&quot;startingPoint&quot;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Signal reference&#39;</span>

<span class="w">        </span><span class="n">exported_metadata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span>

<span class="w">            </span><span class="ss">&quot;fileFormatVersion&quot;</span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;1.0.0&quot;</span><span class="p">,</span>

<span class="w">            </span><span class="ss">&quot;id&quot;</span><span class="err">:</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">            </span><span class="ss">&quot;version&quot;</span><span class="err">:</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">            </span><span class="ss">&quot;createdOn&quot;</span><span class="err">:</span><span class="w"> </span><span class="nc">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">(),</span>

<span class="w">            </span><span class="ss">&quot;updatedOn&quot;</span><span class="err">:</span><span class="w"> </span><span class="nc">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">(),</span>

<span class="w">            </span><span class="ss">&quot;timeShifting&quot;</span><span class="err">:</span><span class="w"> </span><span class="n">timeshifting</span><span class="p">,</span>

<span class="w">            </span><span class="ss">&quot;inputs&quot;</span><span class="err">:</span><span class="w"> </span><span class="o">[</span>

<span class="n">                {</span>

<span class="n">                    &#39;name&#39;: _name,</span>

<span class="n">                    &#39;mapping&#39;: None,</span>

<span class="n">                    &#39;timeShiftingReference&#39;: _name in self.timeshift_reference,</span>

<span class="n">                    &#39;type&#39;: self.components[_component</span><span class="o">]</span><span class="p">.</span><span class="n">inputs</span><span class="o">[</span><span class="n">_name</span><span class="o">][</span><span class="n">&#39;type&#39;</span><span class="o">]</span>

<span class="w">                </span><span class="err">}</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">_component</span><span class="p">,</span><span class="w"> </span><span class="n">_name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">inputs</span>

<span class="w">            </span><span class="err">]</span>

<span class="w">        </span><span class="err">}</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">exported_metadata</span>
</code></pre></div>

</details>
<h4 id="get_pipeline_config">get_pipeline_config</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_pipeline_config</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<p>Saves the information on the composed pipeline configuration package into a YAML file.</p>
<p>This YAML file describes the components and the data flow between them for the AI Inference Server.
The file is created in the <code>destination</code> folder with name <code>pipeline_config.yml</code></p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">get_pipeline_config</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Saves the information on the composed pipeline configuration package into a YAML file.</span>

<span class="ss">        This YAML file describes the components and the data flow between them for the AI Inference Server.</span>

<span class="ss">        The file is created in the `destination` folder with name `pipeline_config.yml`</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">save_version</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">save_version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">version</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">save_package_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">save_package_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">package_id</span>

<span class="w">        </span><span class="n">pipeline_inputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[]</span>

<span class="w">        </span><span class="n">pipeline_inputs</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="o">[</span><span class="n">{</span>

<span class="n">            &#39;name&#39;: name,</span>

<span class="n">            &#39;type&#39;: self.components[component_name</span><span class="o">]</span><span class="p">.</span><span class="n">inputs</span><span class="o">[</span><span class="n">name</span><span class="o">][</span><span class="n">&#39;type&#39;</span><span class="o">]</span>

<span class="w">        </span><span class="err">}</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">component_name</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">inputs</span><span class="err">]</span>

<span class="w">        </span><span class="n">pipeline_outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[]</span>

<span class="w">        </span><span class="n">pipeline_outputs</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="o">[</span><span class="n">{</span>

<span class="n">            &#39;name&#39;: name,</span>

<span class="n">            &#39;type&#39;: self.components[component_name</span><span class="o">]</span><span class="p">.</span><span class="n">outputs</span><span class="o">[</span><span class="n">name</span><span class="o">][</span><span class="n">&#39;type&#39;</span><span class="o">]</span><span class="p">,</span>

<span class="w">        </span><span class="err">}</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">component_name</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">outputs</span><span class="err">]</span>

<span class="w">        </span><span class="n">pipeline_outputs</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="o">[</span><span class="n">{</span>

<span class="n">            &#39;name&#39;: name,</span>

<span class="n">            &#39;type&#39;: &#39;String&#39;,</span>

<span class="n">            &#39;topic&#39;: f&quot;/siemens/edge/aiinference/{self.name}/{self.save_version}/metrics/{component_name}/{name}&quot;,</span>

<span class="n">        } for component_name, component in self.components.items() if isinstance(component, PythonComponent) for name in component.metrics.keys()</span><span class="o">]</span>

<span class="w">        </span><span class="n">pipeline_dag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">{</span>

<span class="n">            &#39;source&#39;: f&quot;{wire[&#39;fromComponent&#39;</span><span class="o">]</span><span class="err">}</span><span class="p">.</span><span class="err">{</span><span class="n">wire</span><span class="o">[</span><span class="n">&#39;fromOutput&#39;</span><span class="o">]</span><span class="err">}</span><span class="ss">&quot;,</span>

<span class="ss">            &#39;target&#39;: f&quot;</span><span class="err">{</span><span class="n">wire</span><span class="o">[</span><span class="n">&#39;toComponent&#39;</span><span class="o">]</span><span class="err">}</span><span class="p">.</span><span class="err">{</span><span class="n">wire</span><span class="o">[</span><span class="n">&#39;toInput&#39;</span><span class="o">]</span><span class="err">}</span><span class="ss">&quot;,</span>

<span class="ss">        } for wire in self.wiring.values()]</span>

<span class="ss">        pipeline_dag += [{</span>

<span class="ss">            &#39;source&#39;: f&#39;Databus.{name}&#39;,</span>

<span class="ss">            &#39;target&#39;: f&#39;{component_name}.{name}&#39;,</span>

<span class="ss">        } for component_name, name in self.inputs]</span>

<span class="ss">        pipeline_dag += [{</span>

<span class="ss">            &#39;source&#39;: f&#39;{component_name}.{name}&#39;,</span>

<span class="ss">            &#39;target&#39;: f&#39;Databus.{name}&#39;,</span>

<span class="ss">        } for component_name, name in self.outputs]</span>

<span class="ss">        pipeline_dag += [{</span>

<span class="ss">            &#39;source&#39;: f&#39;{component_name}.{name}&#39;,</span>

<span class="ss">            &#39;target&#39;: f&#39;Databus.{name}&#39;,</span>

<span class="ss">        } for component_name, component in self.components.items() if isinstance(component, PythonComponent) for name in component.metrics.keys()]</span>

<span class="ss">        config_yml_content = {</span>

<span class="ss">            &#39;fileFormatVersion&#39;: &#39;1.2.0&#39;,</span>

<span class="ss">            &#39;dataFlowPipelineInfo&#39;: {</span>

<span class="ss">                &#39;author&#39;: self.author,</span>

<span class="ss">                &#39;createdOn&#39;: datetime.now(),</span>

<span class="ss">                &#39;dataFlowPipelineVersion&#39;: self.save_version,</span>

<span class="ss">                &#39;description&#39;: self.desc if self.desc else &#39;Created by AI SDK&#39;,</span>

<span class="ss">                &#39;projectName&#39;: self.name,</span>

<span class="ss">                &#39;packageId&#39;: str(self.save_package_id)</span>

<span class="ss">            },</span>

<span class="ss">            &#39;dataFlowPipeline&#39;: {</span>

<span class="ss">                &#39;components&#39;: [component._to_dict() for component in self.components.values()],</span>

<span class="ss">                &#39;pipelineDag&#39;: pipeline_dag,</span>

<span class="ss">                &#39;pipelineInputs&#39;: pipeline_inputs,</span>

<span class="ss">                &#39;pipelineOutputs&#39;: pipeline_outputs,</span>

<span class="ss">            },</span>

<span class="ss">            &#39;packageType&#39;: &#39;full&#39;</span>

<span class="ss">        }</span>

<span class="ss">        if len(self.parameters.items()) != 0:</span>

<span class="ss">            config_yml_content[&quot;</span><span class="n">dataFlowPipeline</span><span class="ss">&quot;][&quot;</span><span class="n">pipelineParameters</span><span class="ss">&quot;] = []</span>

<span class="ss">            for name, parameter in self.parameters.items():</span>

<span class="ss">                if parameter[&quot;</span><span class="n">topicBased</span><span class="ss">&quot;]:</span>

<span class="ss">                    config_yml_content[&quot;</span><span class="n">dataFlowPipeline</span><span class="ss">&quot;][&quot;</span><span class="n">pipelineParameters</span><span class="ss">&quot;].append({</span>

<span class="ss">                        &#39;name&#39;: name, &#39;type&#39;: parameter[&#39;type&#39;],</span>

<span class="ss">                        &#39;defaultValue&#39;: parameter[&#39;defaultValue&#39;],</span>

<span class="ss">                        &#39;topicBased&#39;: parameter[&#39;topicBased&#39;], &#39;valueTopic&#39;: parameter[&#39;valueTopic&#39;]</span>

<span class="ss">                    })</span>

<span class="ss">                else:</span>

<span class="ss">                    config_yml_content[&quot;</span><span class="n">dataFlowPipeline</span><span class="ss">&quot;][&quot;</span><span class="n">pipelineParameters</span><span class="err">&quot;]</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="err">{</span>

<span class="w">                        </span><span class="s1">&#39;name&#39;</span><span class="err">:</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;type&#39;</span><span class="err">:</span><span class="w"> </span><span class="k">parameter</span><span class="o">[</span><span class="n">&#39;type&#39;</span><span class="o">]</span><span class="p">,</span>

<span class="w">                        </span><span class="s1">&#39;defaultValue&#39;</span><span class="err">:</span><span class="w"> </span><span class="k">parameter</span><span class="o">[</span><span class="n">&#39;defaultValue&#39;</span><span class="o">]</span>

<span class="w">                    </span><span class="err">}</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">config_yml_content</span>
</code></pre></div>

</details>
<h4 id="get_wire_for_input">get_wire_for_input</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_wire_for_input</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">component_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">input_name</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span>
</code></pre></div>

<p>Searches for the wire which connects a component with <code>component_name</code> as data consumer through its input with name <code>input_name</code>.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>component_name</td>
<td>str</td>
<td>Name of the data consumer component.</td>
<td>None</td>
</tr>
<tr>
<td>input_name</td>
<td>str</td>
<td>Name of the input variable of <code>component_name</code>.</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>dict</td>
<td>Wire which contains the data provider and receiver with their names and the names of their variables.</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">get_wire_for_input</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">component_name</span><span class="o">:</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">input_name</span><span class="o">:</span><span class="w"> </span><span class="n">str</span><span class="p">)</span><span class="o">:</span>

<span class="w">        </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span>

<span class="s2">        Searches for the wire which connects a component with `component_name` as data consumer through its input with name `input_name`.</span>

<span class="s2">        Args:</span>

<span class="s2">            component_name (str): Name of the data consumer component.</span>

<span class="s2">            input_name (str): Name of the input variable of `component_name`.</span>

<span class="s2">        Returns:</span>

<span class="s2">            dict: Wire which contains the data provider and receiver with their names and the names of their variables.</span>

<span class="s2">        </span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="n">wires</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[</span><span class="n">x</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">wiring</span><span class="p">.</span><span class="k">values</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">x</span><span class="err">[</span><span class="s2">&quot;toComponent&quot;</span><span class="err">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">component_name</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">x</span><span class="err">[</span><span class="s2">&quot;toInput&quot;</span><span class="err">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">input_name</span><span class="err">]</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">wires</span><span class="err">[</span><span class="mi">0</span><span class="err">]</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">wires</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">None</span>
</code></pre></div>

</details>
<h4 id="get_wire_for_output">get_wire_for_output</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_wire_for_output</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">component_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">output_name</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span>
</code></pre></div>

<p>Searches for the wire which connects a component with <code>component_name</code> as data provider through its output with name output_name.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>component_name</td>
<td>str</td>
<td>Name of the data provider component.</td>
<td>None</td>
</tr>
<tr>
<td>output_name</td>
<td>str</td>
<td>Name of the output variable of <code>component_name</code>.</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>[dict]</td>
<td>Wire which contains the data provider and receiver with their names and the names of their variables.</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">get_wire_for_output</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">component_name</span><span class="o">:</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">output_name</span><span class="o">:</span><span class="w"> </span><span class="n">str</span><span class="p">)</span><span class="o">:</span>

<span class="w">        </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span>

<span class="s2">        Searches for the wire which connects a component with `component_name` as data provider through its output with name output_name.</span>

<span class="s2">        Args:</span>

<span class="s2">            component_name (str): Name of the data provider component.</span>

<span class="s2">            output_name (str): Name of the output variable of `component_name`.</span>

<span class="s2">        Returns:</span>

<span class="s2">            [dict]: Wire which contains the data provider and receiver with their names and the names of their variables.</span>

<span class="s2">        </span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="n">wires</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[</span><span class="n">x</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">wiring</span><span class="p">.</span><span class="k">values</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">x</span><span class="err">[</span><span class="s2">&quot;fromComponent&quot;</span><span class="err">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">component_name</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">x</span><span class="err">[</span><span class="s2">&quot;fromOutput&quot;</span><span class="err">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">output_name</span><span class="err">]</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">wires</span><span class="err">[</span><span class="mi">0</span><span class="err">]</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">wires</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">None</span>
</code></pre></div>

</details>
<h4 id="remove_timeshifting_reference">remove_timeshifting_reference</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">remove_timeshifting_reference</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">reference</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span>
</code></pre></div>

<p>Removes previously-defined inter-signal alignment reference variables.</p>
<p>If no reference variables remain, the <code>startingPoint</code> will be <code>First timestamp</code>.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>reference</td>
<td>str</td>
<td>Variable name to be removed from <code>self.timeshift_reference</code> list.</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">remove_timeshifting_reference</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">reference</span><span class="o">:</span><span class="w"> </span><span class="n">str</span><span class="p">)</span><span class="o">:</span>

<span class="w">        </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span>

<span class="s2">        Removes previously-defined inter-signal alignment reference variables.</span>

<span class="s2">        If no reference variables remain, the `startingPoint` will be `First timestamp`.</span>

<span class="s2">        Args:</span>

<span class="s2">            reference (str): Variable name to be removed from `self.timeshift_reference` list.</span>

<span class="s2">        </span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="k">reference</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">timeshift_reference</span><span class="o">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Reference variable with name {&#39;reference&#39;} does not exist.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">timeshift_reference</span><span class="p">.</span><span class="k">remove</span><span class="p">(</span><span class="k">reference</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="save_2">save</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">save</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">destination</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
    <span class="n">package_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">version</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span>
</code></pre></div>

<p>@Deprecated, reason: only edge package generation will be supported in the future. Use export instead.</p>
<p>Saves the assembled package in a zip format.
The name of the file is defined as <code>{package_name}_{package_version}.zip</code>.
If a file with such a name already exists in the <code>destination</code> folder, it gets overwritten and a warning message appears.</p>
<p>The package is also available as a subfolder on the destination path with the name <code>{package_name}_{package_version}</code>.
If the assembled content does not meet the expected one, this content can be changed and simply packed into a zip file.</p>
<p>The package contains files and folders in the following structure:</p>
<ul>
<li>
<p>Package folder with name <code>{package_name}_{package_version}</code></p>
<ul>
<li><code>datalink-metadata.yml</code></li>
<li><code>pipeline-config.yml</code></li>
<li>Component folder with name <code>{component_name}</code></li>
</ul>
<p>When the component is a <code>PythonComponent</code>, this folder contains:</p>
<ul>
<li><code>requirements.txt</code></li>
<li>Entrypoint script defined by the entrypoint of the component</li>
<li>Extra files as added to the specified folders</li>
<li>Source folder with name <code>src</code> with necessary python scripts</li>
</ul>
</li>
</ul>
<p>If a package ID is specified, and a package with the same ID and version is already present in the <code>destination</code> folder,
an error is raised.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>destination</td>
<td>str</td>
<td>Target directory for saving the package. Defaults to ".".</td>
<td>"."</td>
</tr>
<tr>
<td>package_id</td>
<td>UUID</td>
<td>The optional package ID. If None, a new UUID is generated.</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">save</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">package_id</span><span class="o">:</span><span class="w"> </span><span class="k">Optional</span><span class="err">[</span><span class="n">uuid</span><span class="p">.</span><span class="n">UUID</span><span class="err">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="o">:</span><span class="w"> </span><span class="k">Optional</span><span class="err">[</span><span class="n">str</span><span class="err">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">Path</span><span class="o">:</span>

<span class="w">        </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span>

<span class="s2">        @Deprecated, reason: only edge package generation will be supported in the future. Use export instead.</span>

<span class="s2">        Saves the assembled package in a zip format.</span>

<span class="s2">        The name of the file is defined as `{package_name}_{package_version}.zip`.</span>

<span class="s2">        If a file with such a name already exists in the `destination` folder, it gets overwritten and a warning message appears.</span>

<span class="s2">        The package is also available as a subfolder on the destination path with the name `{package_name}_{package_version}`.</span>

<span class="s2">        If the assembled content does not meet the expected one, this content can be changed and simply packed into a zip file.</span>

<span class="s2">        The package contains files and folders in the following structure:</span>

<span class="s2">        - Package folder with name `{package_name}_{package_version}`</span>

<span class="s2">            - `datalink-metadata.yml`</span>

<span class="s2">            - `pipeline-config.yml`</span>

<span class="s2">            - Component folder with name `{component_name}`</span>

<span class="s2">            When the component is a `PythonComponent`, this folder contains:</span>

<span class="s2">            - `requirements.txt`</span>

<span class="s2">            - Entrypoint script defined by the entrypoint of the component</span>

<span class="s2">            - Extra files as added to the specified folders</span>

<span class="s2">            - Source folder with name `src` with necessary python scripts</span>

<span class="s2">        If a package ID is specified, and a package with the same ID and version is already present in the `destination` folder,</span>

<span class="s2">        an error is raised.</span>

<span class="s2">        Args:</span>

<span class="s2">            destination (str, optional): Target directory for saving the package. Defaults to &quot;</span><span class="p">.</span><span class="s2">&quot;.</span>

<span class="s2">            package_id (UUID): The optional package ID. If None, a new UUID is generated.</span>

<span class="s2">        </span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">validate</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>

<span class="w">        </span><span class="n">destination</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">Path</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">package_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">package_id</span><span class="p">,</span><span class="w"> </span><span class="n">uuid</span><span class="p">.</span><span class="n">UUID</span><span class="p">)</span><span class="o">:</span>

<span class="w">            </span><span class="n">package_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uuid</span><span class="p">.</span><span class="nf">UUID</span><span class="p">(</span><span class="n">package_id</span><span class="p">)</span>

<span class="w">        </span><span class="n">prev_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span>

<span class="w">        </span><span class="n">prev_id_version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span>

<span class="w">        </span><span class="n">prev_version</span><span class="p">,</span><span class="w"> </span><span class="n">prev_with_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_find_previous</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span><span class="w"> </span><span class="n">package_id</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">prev_with_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">None</span><span class="o">:</span>

<span class="w">            </span><span class="n">prev_id_version</span><span class="p">,</span><span class="w"> </span><span class="n">prev_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prev_with_id</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">package_id</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">prev_id</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="n">version</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">version</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">str</span><span class="p">(</span><span class="n">prev_id_version</span><span class="p">)</span><span class="o">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">RuntimeError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;package with version &#39;{version or self.version}&#39; and id &#39;{package_id}&#39; already exists&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">save_version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="err">\</span>

<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">version</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">version</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="err">\</span>

<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="s2">&quot;1&quot;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">package_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">prev_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">package_id</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">prev_id</span><span class="w"> </span><span class="err">\</span>

<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="n">str</span><span class="p">(</span><span class="n">prev_id_version</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">prev_id_version</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="err">\</span>

<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="n">str</span><span class="p">(</span><span class="n">prev_version</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">prev_version</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">prev_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="err">\</span>

<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="s2">&quot;1&quot;</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">save_package_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">package_id</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">package_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="err">\</span>

<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="n">prev_id</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">prev_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="err">\</span>

<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="n">uuid</span><span class="p">.</span><span class="n">uuid4</span><span class="p">()</span>

<span class="w">        </span><span class="k">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="k">name</span><span class="p">.</span><span class="k">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;-&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">package_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;{name}_{self.save_version}&quot;</span>

<span class="w">        </span><span class="n">package_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;{package_name}.zip&quot;</span>

<span class="w">        </span><span class="n">specified_version_is_decimal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">version</span><span class="p">.</span><span class="n">isdecimal</span><span class="p">()</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">version</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">version</span><span class="p">.</span><span class="n">isdecimal</span><span class="p">()</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">specified_version_is_decimal</span><span class="o">:</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">package_file</span><span class="p">.</span><span class="k">exists</span><span class="p">()</span><span class="o">:</span>

<span class="w">                </span><span class="n">p_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_extract_package_id</span><span class="p">(</span><span class="n">package_file</span><span class="p">,</span><span class="w"> </span><span class="no">False</span><span class="p">)</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">p_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">p_id</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">package_id</span><span class="o">:</span>

<span class="w">                    </span><span class="n">raise</span><span class="w"> </span><span class="n">RuntimeError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;package with version &#39;{self.save_version}&#39; and id &#39;{self.save_package_id}&#39; already exists: &#39;{package_file}&#39;&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="n">edge_package_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;{name}-edge_{self.save_version}.zip&quot;</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">edge_package_file</span><span class="p">.</span><span class="k">exists</span><span class="p">()</span><span class="o">:</span>

<span class="w">                </span><span class="n">p_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_extract_package_id</span><span class="p">(</span><span class="n">edge_package_file</span><span class="p">,</span><span class="w"> </span><span class="no">True</span><span class="p">)</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">p_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">p_id</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">package_id</span><span class="o">:</span>

<span class="w">                    </span><span class="n">raise</span><span class="w"> </span><span class="n">RuntimeError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;package with version &#39;{self.save_version}&#39; and id &#39;{self.save_package_id}&#39; already exists: &#39;{edge_package_file}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">destination</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">package_name</span>

<span class="w">        </span><span class="n">destination</span><span class="p">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="no">True</span><span class="p">,</span><span class="w"> </span><span class="n">exist_ok</span><span class="o">=</span><span class="no">True</span><span class="p">)</span>

<span class="w">        </span><span class="c1"># Save</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="k">component</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">components</span><span class="o">:</span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">components</span><span class="err">[</span><span class="k">component</span><span class="err">]</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span><span class="w"> </span><span class="no">False</span><span class="p">)</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">save_datalink_metadata</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">save_pipeline_config</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">save_readme_html</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">save_telemetry_data</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>

<span class="w">        </span><span class="n">zip_destination</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">shutil</span><span class="p">.</span><span class="n">make_archive</span><span class="p">(</span>

<span class="w">            </span><span class="n">base_name</span><span class="o">=</span><span class="n">str</span><span class="p">(</span><span class="n">destination</span><span class="p">.</span><span class="n">parent</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">package_name</span><span class="p">),</span><span class="w"> </span><span class="k">format</span><span class="o">=</span><span class="s1">&#39;zip&#39;</span><span class="p">,</span>

<span class="w">            </span><span class="n">root_dir</span><span class="o">=</span><span class="n">destination</span><span class="p">.</span><span class="n">parent</span><span class="p">,</span><span class="w"> </span><span class="n">base_dir</span><span class="o">=</span><span class="n">package_name</span><span class="p">,</span>

<span class="w">            </span><span class="n">verbose</span><span class="o">=</span><span class="no">True</span><span class="p">,</span><span class="w"> </span><span class="n">logger</span><span class="o">=</span><span class="n">_logger</span><span class="p">)</span>

<span class="w">        </span><span class="n">pipeline_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">os</span><span class="p">.</span><span class="k">path</span><span class="p">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">zip_destination</span><span class="p">)</span><span class="w">  </span><span class="c1"># zipped package size in bytes</span>

<span class="w">        </span><span class="n">pipeline_size_GB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;{:.2f}&quot;</span><span class="p">.</span><span class="k">format</span><span class="p">(</span><span class="n">pipeline_size</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1000</span><span class="p">)</span>

<span class="w">        </span><span class="n">pipeline_size_limit_GB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;{:.2f}&quot;</span><span class="p">.</span><span class="k">format</span><span class="p">(</span><span class="n">PIPELINE_SIZE_LIMIT</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1000</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">pipeline_size</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">PIPELINE_SIZE_LIMIT</span><span class="o">:</span>

<span class="w">            </span><span class="n">error_msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;Pipeline size {pipeline_size} bytes ({pipeline_size_GB} GB) exceeds the limit of &quot;</span><span class="w"> </span><span class="err">\</span>

<span class="w">                        </span><span class="n">f</span><span class="s2">&quot;{PIPELINE_SIZE_LIMIT} bytes ({pipeline_size_limit_GB} GB). &quot;</span><span class="w"> </span><span class="err">\</span>

<span class="w">                        </span><span class="s2">&quot;Please remove unnecessary files and dependencies and try again.&quot;</span>

<span class="w">            </span><span class="n">_logger</span><span class="p">.</span><span class="k">error</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">RuntimeError</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">Path</span><span class="p">(</span><span class="n">zip_destination</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="save_datalink_metadata">save_datalink_metadata</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">save_datalink_metadata</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">destination</span>
<span class="p">)</span>
</code></pre></div>

<p>Saves metadata for pipeline input variables.</p>
<p>This method saves metadata for the AI Inference Server into a YAML file.
This metadata determines how the AI Inference Server feeds input to the pipeline, especially inter-signal alignment.
The file is created in the <code>destination</code> folder with the name <code>datalink_metadata.yml</code></p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>destination</td>
<td>path-like</td>
<td>Path of the destination directory.</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">save_datalink_metadata</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">destination</span><span class="p">)</span><span class="o">:</span>

<span class="w">        </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span>

<span class="s2">        Saves metadata for pipeline input variables.</span>

<span class="s2">        This method saves metadata for the AI Inference Server into a YAML file.</span>

<span class="s2">        This metadata determines how the AI Inference Server feeds input to the pipeline, especially inter-signal alignment.</span>

<span class="s2">        The file is created in the `destination` folder with the name `datalink_metadata.yml`</span>

<span class="s2">        Args:</span>

<span class="s2">            destination (path-like): Path of the destination directory.</span>

<span class="s2">        </span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">with</span><span class="w"> </span><span class="k">open</span><span class="p">(</span><span class="k">Path</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">DATALINK_METADATA</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;w&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">f</span><span class="o">:</span>

<span class="w">            </span><span class="n">yaml</span><span class="p">.</span><span class="n">dump</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">get_datalink_metadata</span><span class="p">(),</span><span class="w"> </span><span class="n">f</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="save_pipeline_config">save_pipeline_config</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">save_pipeline_config</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">destination</span>
<span class="p">)</span>
</code></pre></div>

<p>Saves the information about the composed pipeline configuration package into a YAML file.</p>
<p>This YAML file describes the components and the data flow between them for AI Inference Server.
The file will be created in the <code>destination</code> folder with name <code>pipeline_config.yml</code></p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>destination</td>
<td>path-like</td>
<td>Path of the <code>destination</code> directory.</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">save_pipeline_config</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">destination</span><span class="p">)</span><span class="o">:</span>

<span class="w">        </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span>

<span class="s2">        Saves the information about the composed pipeline configuration package into a YAML file.</span>

<span class="s2">        This YAML file describes the components and the data flow between them for AI Inference Server.</span>

<span class="s2">        The file will be created in the `destination` folder with name `pipeline_config.yml`</span>

<span class="s2">        Args:</span>

<span class="s2">            destination (path-like): Path of the `destination` directory.</span>

<span class="s2">        </span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">with</span><span class="w"> </span><span class="k">open</span><span class="p">(</span><span class="k">Path</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">PIPELINE_CONFIG</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;w&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">f</span><span class="o">:</span>

<span class="w">            </span><span class="n">yaml</span><span class="p">.</span><span class="n">dump</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">get_pipeline_config</span><span class="p">(),</span><span class="w"> </span><span class="n">f</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="save_readme_html">save_readme_html</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">save_readme_html</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">destination</span>
<span class="p">)</span>
</code></pre></div>

<p>Saves a <code>README.html</code> in the <code>destination</code> folder that describes the pipeline.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>destination</td>
<td>path-like</td>
<td>Path of the destination folder.</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">save_readme_html</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">destination</span><span class="p">)</span><span class="o">:</span>

<span class="w">        </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span>

<span class="s2">        Saves a `README.html` in the `destination` folder that describes the pipeline.</span>

<span class="s2">        Args:</span>

<span class="s2">            destination (path-like): Path of the destination folder.</span>

<span class="s2">        </span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="n">pipelinePage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_PipelinePage</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>

<span class="w">        </span><span class="n">readme_html_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">Path</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">README_HTML</span>

<span class="w">        </span><span class="n">readme_html_path</span><span class="p">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">pipelinePage</span><span class="p">.</span><span class="n">__str__</span><span class="p">())</span>
</code></pre></div>

</details>
<h4 id="save_telemetry_data">save_telemetry_data</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">save_telemetry_data</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">destination</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span>
<span class="p">)</span>
</code></pre></div>

<p>Save telemetry data to a specified destination.</p>
<p>Args:
    destination (Path): The path where the telemetry data should be saved.</p>
<p>Returns:
    None</p>
<p>Raises:
    None</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">save_telemetry_data</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">destination</span><span class="p">:</span><span class="w"> </span><span class="k">Path</span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Save telemetry data to a specified destination.</span>

<span class="ss">        Args:</span>

<span class="ss">            destination (Path): The path where the telemetry data should be saved.</span>

<span class="ss">        Returns:</span>

<span class="ss">            None</span>

<span class="ss">        Raises:</span>

<span class="ss">            None</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">telemetry_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">TELEMETRY_YAML</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{}</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="o">[</span><span class="n">&quot;platform&quot;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{}</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="o">[</span><span class="n">&quot;platform&quot;</span><span class="o">][</span><span class="n">&quot;os&quot;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">platform</span><span class="p">.</span><span class="k">system</span><span class="p">()</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="o">[</span><span class="n">&quot;platform&quot;</span><span class="o">][</span><span class="n">&quot;release&quot;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">platform</span><span class="p">.</span><span class="k">release</span><span class="p">()</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="o">[</span><span class="n">&quot;platform&quot;</span><span class="o">][</span><span class="n">&quot;python_version&quot;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">platform</span><span class="p">.</span><span class="n">python_version</span><span class="p">()</span>

<span class="w">        </span><span class="n">_logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;locals: {locals()}&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="o">[</span><span class="n">&quot;environment&quot;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{}</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="o">[</span><span class="n">&quot;environment&quot;</span><span class="o">][</span><span class="n">&quot;jupyter&quot;</span><span class="o">]</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="ow">any</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">locals</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">[</span><span class="n">&quot;__IPYTHON__&quot;, &quot;get_ipython&quot;</span><span class="o">]</span><span class="p">)</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="o">[</span><span class="n">&quot;environment&quot;</span><span class="o">][</span><span class="n">&quot;gitlab_ci&quot;</span><span class="o">]</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ss">&quot;GITLAB_CI&quot;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">MSG_NOT_FOUND</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="o">[</span><span class="n">&quot;environment&quot;</span><span class="o">][</span><span class="n">&quot;azure_devops&quot;</span><span class="o">]</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ss">&quot;TF_BUILD&quot;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">MSG_NOT_FOUND</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="o">[</span><span class="n">&quot;environment&quot;</span><span class="o">][</span><span class="n">&quot;github_actions&quot;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ss">&quot;GITHUB_ACTIONS&quot;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">MSG_NOT_FOUND</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="o">[</span><span class="n">&quot;industrial_ai&quot;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{}</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="o">[</span><span class="n">&quot;industrial_ai&quot;</span><span class="o">][</span><span class="n">&quot;simaticai&quot;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MSG_NOT_FOUND</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="o">[</span><span class="n">&quot;industrial_ai&quot;</span><span class="o">][</span><span class="n">&quot;vep-template-sdk&quot;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MSG_NOT_FOUND</span>

<span class="w">        </span><span class="k">try</span><span class="err">:</span>

<span class="w">            </span><span class="n">telemetry_data</span><span class="o">[</span><span class="n">&quot;industrial_ai&quot;</span><span class="o">][</span><span class="n">&quot;simaticai&quot;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkg_resources</span><span class="p">.</span><span class="n">get_distribution</span><span class="p">(</span><span class="ss">&quot;simaticai&quot;</span><span class="p">).</span><span class="n">version</span>

<span class="w">        </span><span class="ow">except</span><span class="w"> </span><span class="n">pkg_resources</span><span class="p">.</span><span class="nl">DistributionNotFound</span><span class="p">:</span>

<span class="w">            </span><span class="n">pass</span>

<span class="w">        </span><span class="nl">finally</span><span class="p">:</span>

<span class="w">            </span><span class="n">pass</span>

<span class="w">        </span><span class="k">try</span><span class="err">:</span>

<span class="w">            </span><span class="n">telemetry_data</span><span class="o">[</span><span class="n">&quot;industrial_ai&quot;</span><span class="o">][</span><span class="n">&quot;vep-template-sdk&quot;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkg_resources</span><span class="p">.</span><span class="n">get_distribution</span><span class="p">(</span><span class="ss">&quot;vep-template-sdk&quot;</span><span class="p">).</span><span class="n">version</span>

<span class="w">        </span><span class="ow">except</span><span class="w"> </span><span class="n">pkg_resources</span><span class="p">.</span><span class="nl">DistributionNotFound</span><span class="p">:</span>

<span class="w">            </span><span class="n">pass</span>

<span class="w">        </span><span class="nl">finally</span><span class="p">:</span>

<span class="w">            </span><span class="n">pass</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="o">[</span><span class="n">&quot;pipeline&quot;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{}</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="o">[</span><span class="n">&quot;pipeline&quot;</span><span class="o">][</span><span class="n">&quot;python_versions&quot;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">list</span><span class="p">(</span><span class="k">set</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">components</span><span class="o">[</span><span class="n">component</span><span class="o">]</span><span class="p">.</span><span class="n">python_version</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">components</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">components</span><span class="o">[</span><span class="n">component</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">PythonComponent</span><span class="p">)))</span>

<span class="w">        </span><span class="n">telemetry_data</span><span class="o">[</span><span class="n">&quot;pipeline&quot;</span><span class="o">][</span><span class="n">&quot;file_extensions&quot;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">list</span><span class="p">(</span><span class="k">set</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">suffix</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">Path</span><span class="p">(</span><span class="n">destination</span><span class="p">).</span><span class="n">rglob</span><span class="p">(</span><span class="ss">&quot;*&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">suffix</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">[</span><span class="n">&quot;&quot;, &quot;.zip&quot;, &quot;.yml&quot;, &quot;.yaml&quot;, &quot;.html&quot;</span><span class="o">]</span><span class="p">))</span>

<span class="w">        </span><span class="n">yaml</span><span class="p">.</span><span class="k">dump</span><span class="p">(</span><span class="n">telemetry_data</span><span class="p">,</span><span class="w"> </span><span class="k">open</span><span class="p">(</span><span class="n">telemetry_path</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;w&#39;</span><span class="p">))</span>
</code></pre></div>

</details>
<h4 id="set_timeshifting_periodicity">set_timeshifting_periodicity</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">set_timeshifting_periodicity</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">periodicity</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span>
</code></pre></div>

<p>Enables inter-signal alignment with the given sampling period.</p>
<p>With inter-signal alignment enabled, the AI Inference Server collects data for different input variables before it triggers the model.
By default, <code>startingPoint</code> property is set to <code>First timestamp</code>, which means that inter-signal alignment is started at the
first incoming value for any input variable.</p>
<p>This property can be changed to <code>Signal reference</code> by adding inter-signal alignment reference variables
via the <code>add_timeshifting_reference(..)</code> method. In this case, inter-signal alignment is started when the first value arrives
for the defined input variables.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>periodicity</td>
<td>int</td>
<td>Periodicity time in milliseconds for the AI Inference Server to perform inter-signal alignment. Valid range is [10, 2^31).</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="k">set</span><span class="n">_timeshifting_periodicity</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">periodicity</span><span class="o">:</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="o">:</span>

<span class="w">        </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span>

<span class="s2">        Enables inter-signal alignment with the given sampling period.</span>

<span class="s2">        With inter-signal alignment enabled, the AI Inference Server collects data for different input variables before it triggers the model.</span>

<span class="s2">        By default, `startingPoint` property is set to `First timestamp`, which means that inter-signal alignment is started at the</span>

<span class="s2">        first incoming value for any input variable.</span>

<span class="s2">        This property can be changed to `Signal reference` by adding inter-signal alignment reference variables</span>

<span class="s2">        via the `add_timeshifting_reference(..)` method. In this case, inter-signal alignment is started when the first value arrives</span>

<span class="s2">        for the defined input variables.</span>

<span class="s2">        Args:</span>

<span class="s2">            periodicity (int): Periodicity time in milliseconds for the AI Inference Server to perform inter-signal alignment. Valid range is [10, 2^31).</span>

<span class="s2">        </span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="n">periodicity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">int</span><span class="p">(</span><span class="n">periodicity</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">periodicity</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="p">(</span><span class="n">math</span><span class="p">.</span><span class="nf">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">31</span><span class="p">)))</span><span class="o">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;Inter signal alignment periodicity must be an integer and in range [10, 2^31)&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">periodicity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">periodicity</span>

<span class="w">        </span><span class="n">_logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Inter signal alignment periodicity has been set to {self.periodicity}.&quot;</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="validate_2">validate</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">validate</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">destination</span><span class="o">=</span><span class="s1">&#39;.&#39;</span>
<span class="p">)</span>
</code></pre></div>

<p>Validates whether the package configuration is compatible with the expected runtime environment.</p>
<p>The method verifies:</p>
<ul>
<li>If the package has at least one component</li>
<li>If all wires create connections between existing components and their variables</li>
<li>If metadata is defined and valid.</li>
<li>If a package with the same name already exists in the <code>destination</code> folder. In this case a warning message appears and the <code>save(..)</code> method overwrites the existing package.</li>
<li>If the package has multiple components and if they are using the same Python version</li>
</ul>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>destination</td>
<td>str</td>
<td>Path of the expected destination folder. Defaults to ".".</td>
<td>"."</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">validate</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">destination</span><span class="o">=</span><span class="ss">&quot;.&quot;</span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Validates whether the package configuration is compatible with the expected runtime environment.</span>

<span class="ss">        The method verifies:</span>

<span class="ss">        - If the package has at least one component</span>

<span class="ss">        - If all wires create connections between existing components and their variables</span>

<span class="ss">        - If metadata is defined and valid.</span>

<span class="ss">        - If a package with the same name already exists in the `destination` folder. In this case a warning message appears and the `save(..)` method overwrites the existing package.</span>

<span class="ss">        - If the package has multiple components and if they are using the same Python version</span>

<span class="ss">        Args:</span>

<span class="ss">            destination (str, optional): Path of the expected destination folder. Defaults to &quot;</span><span class="p">.</span><span class="ss">&quot;.</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">components</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="ss">&quot;The package must have at least one component.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="k">variable</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">components</span><span class="o">[</span><span class="n">name</span><span class="o">]</span><span class="p">.</span><span class="n">batch</span><span class="p">.</span><span class="nl">outputBatch</span><span class="p">:</span>

<span class="w">                </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;The component &#39;{name}&#39; has pipeline output defined with variable name &#39;{variable}&#39;. \</span>

<span class="ss">                                      None of component with pipeline output is allowed to provide batch output.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">wire_hash</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">wiring</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span><span class="err">:</span>

<span class="w">            </span><span class="n">wire</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">wiring</span><span class="o">[</span><span class="n">wire_hash</span><span class="o">]</span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">_check_wiring</span><span class="p">(</span><span class="n">wire</span><span class="p">,</span><span class="w"> </span><span class="n">wire_hash</span><span class="p">)</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_check_timeshifting</span><span class="p">()</span>

<span class="w">        </span><span class="n">package_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">Path</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">f</span><span class="ss">&quot;{self.name}_{self.version}&quot;</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="ss">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;-&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">package_path</span><span class="p">.</span><span class="n">is_dir</span><span class="p">()</span><span class="err">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="p">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;Target folder ({package_path}) already exists! Unless changing the package name the package could be invalid and your files will be overwritten!&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">python_versions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">set</span><span class="p">()</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">components</span><span class="p">:</span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">components</span><span class="o">[</span><span class="n">component</span><span class="o">]</span><span class="p">.</span><span class="n">validate</span><span class="p">()</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">components</span><span class="o">[</span><span class="n">component</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">PythonComponent</span><span class="p">)</span><span class="err">:</span>

<span class="w">                </span><span class="n">python_versions</span><span class="p">.</span><span class="k">add</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">components</span><span class="o">[</span><span class="n">component</span><span class="o">]</span><span class="p">.</span><span class="n">python_version</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">python_versions</span><span class="p">))</span><span class="err">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="p">.</span><span class="n">warning</span><span class="p">(</span><span class="ss">&quot;The use of multiple python version in a single pipeline is not recommended. We recommend using only one of the supported versions, which are Python 3.10 or 3.11.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">_logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;Package &#39;{self.name}&#39; is valid and ready to save.&quot;</span><span class="p">)</span>
</code></pre></div>

</details>
<h3 id="pythoncomponent">PythonComponent</h3>
<p>A pipeline component implemented using Python scripts and libraries.</p>
<p>A <code>PythonComponent</code> wraps Python code resource files such as saved models into a structured folder, which can be added to a pipeline
configuration package.</p>
<p>For a comprehensive overview on how to wrap ML models into Python components, we recommend you refer to
the AI SDK User Manual, especially the guideline for writing pipeline components. We also recommend you
study the example Python components in the E2E Tutorials for the AI SDK.</p>
<p>A new <code>PythonComponent</code> is empty.</p>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">PythonComponent</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;inference&#39;</span><span class="p">,</span>
    <span class="n">version</span><span class="o">=</span><span class="s1">&#39;0.0.1&#39;</span><span class="p">,</span>
    <span class="n">python_version</span><span class="o">=</span><span class="s1">&#39;3.10&#39;</span><span class="p">,</span>
    <span class="n">desc</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="p">)</span>
</code></pre></div>

<h4 id="attributes_3">Attributes</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>str</td>
<td>Component name. (default: inference)</td>
<td>None</td>
</tr>
<tr>
<td>desc</td>
<td>str</td>
<td>Component description (optional)</td>
<td>None</td>
</tr>
<tr>
<td>version</td>
<td>str</td>
<td>Component version. (default: 0.0.1)</td>
<td>None</td>
</tr>
<tr>
<td>python_version</td>
<td>str</td>
<td>Python version on the target AI Inference Server. At the moment of writing, the current version supports Python 3.10 and 3.11.</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="n">PythonComponent</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    A pipeline component implemented using Python scripts and libraries.</span>

<span class="sd">    A `PythonComponent` wraps Python code resource files such as saved models into a structured folder, which can be added to a pipeline</span>

<span class="sd">    configuration package.</span>

<span class="sd">    For a comprehensive overview on how to wrap ML models into Python components, we recommend you refer to</span>

<span class="sd">    the AI SDK User Manual, especially the guideline for writing pipeline components. We also recommend you</span>

<span class="sd">    study the example Python components in the E2E Tutorials for the AI SDK.</span>

<span class="sd">    A new `PythonComponent` is empty.</span>

<span class="sd">    Args:</span>

<span class="sd">        name (str): Component name. (default: inference)</span>

<span class="sd">        desc (str): Component description (optional)</span>

<span class="sd">        version (str): Component version. (default: 0.0.1)</span>

<span class="sd">        python_version (str): Python version on the target AI Inference Server.</span>

<span class="sd">            At the moment of writing, the current version supports Python 3.10 and 3.11.</span>

<span class="sd">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;inference&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="o">=</span><span class="s2">&quot;0.0.1&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">python_version</span><span class="o">=</span><span class="s1">&#39;3.10&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Creates a new, empty Python component.</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Component name. (default: inference)</span>

<span class="sd">            desc (str): Component description (optional)</span>

<span class="sd">            version (str): Component version. (default: 0.0.1)</span>

<span class="sd">            python_version (str): Python version on the target AI Inference Server. At the moment of writing, AI Inference Server supports Python 3.10 and 3.11.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="o">=</span><span class="n">desc</span><span class="p">)</span>

<span class="w">        </span><span class="n">try</span><span class="p">:</span>

<span class="w">            </span><span class="n">python_version_validator</span><span class="p">(</span><span class="n">python_version</span><span class="p">)</span>

<span class="w">        </span><span class="n">except</span><span class="w"> </span><span class="n">ValueError</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">error</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">python_version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">python_version</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">version</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PythonDependencies</span><span class="p">(</span><span class="n">python_version</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">_replicas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb">str</span><span class="p">:</span>

<span class="w">        </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">super</span><span class="p">()</span><span class="o">.</span><span class="n">__repr__</span><span class="p">()</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Metrics:</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">metric</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;&lt; {name}{&#39;: &#39; + metric[&#39;desc&#39;] if metric.get(&#39;desc&#39;) is not None else &#39;&#39;}</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="p">):</span>

<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Resources:</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;  {base}/{path.name}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;./&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;Entrypoint: {self.entrypoint}</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">text</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">set_entrypoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">entrypoint</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Sets the entrypoint module for the component.</span>

<span class="sd">        The entrypoint is the Python code which is responsible for receiving the input data and producing a structured response with the output for the AI Inference Server.</span>

<span class="sd">        The script should consume a JSON string and produce another. See the short example below.</span>

<span class="sd">        The file will be copied into the root directory of the component on the AI Inference Server, so every file reference should be aligned.</span>

<span class="sd">        The example code below shows a basic structure of the entrypoint Python code.</span>

<span class="sd">        ```python</span>

<span class="sd">        import json</span>

<span class="sd">        import sys</span>

<span class="sd">        from pathlib import Path</span>

<span class="sd">        # by adding the parent folder of your modules to system path makes them available for relative import</span>

<span class="sd">        sys.path.insert(0, str(Path(&#39;./src&#39;).resolve()))</span>

<span class="sd">        from my_module import processor  # then the processor module can be imported</span>

<span class="sd">        def run(data: str):</span>

<span class="sd">            input_data = json.loads(data)  # incoming JSON string is loaded as a dictionary</span>

<span class="sd">            result = processor.process_data(input_data)  # the process_data can be called to process the incoming data</span>

<span class="sd">            # the code below creates the formatted output for the AI Inference Server</span>

<span class="sd">            if result is None:</span>

<span class="sd">                answer = {&quot;ready&quot;: False, &quot;output&quot;: None}</span>

<span class="sd">            else:</span>

<span class="sd">                answer = {&quot;ready&quot;: True, &quot;output&quot;: json.dumps(result)}</span>

<span class="sd">            return answer</span>

<span class="sd">        ```</span>

<span class="sd">        Args:</span>

<span class="sd">            entrypoint (str): Name of the new entrypoint script to be copied</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">any</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">items</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">key</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">entrypoint</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="p">):</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;Entrypoint must be added as resource to the root directory before setting up as entrypoint.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">entrypoint</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_resources</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">base_dir</span><span class="p">:</span><span class="w"> </span><span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">,</span><span class="w"> </span><span class="n">resources</span><span class="p">:</span><span class="w"> </span><span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">list</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Adds files to a component.</span>

<span class="sd">        To make your file resources available on the AI Inference Server you need to add them to the package resources.</span>

<span class="sd">        These resources can be Python or config files, serialized ML models or reference data.</span>

<span class="sd">        They are then available on path {component_root}/{resources} in the runtime environment.</span>

<span class="sd">        When saving the package they will be copied from {base_dir}/{resources} into the package.</span>

<span class="sd">        Files in &#39;__pycache__&#39; folders or any other hidden folders (folder name starting with &#39;.&#39; character) will be excluded.</span>

<span class="sd">        Args:</span>

<span class="sd">            base_dir (path-like): Root folder of your code from which the resources are referred</span>

<span class="sd">            resources (os.PathLike or List): A single path or list of relative paths to resource files</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span>

<span class="w">        </span><span class="n">base_dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">base_dir</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">base_dir</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Parameter &#39;base_dir&#39; must be a directory and available in path {base_dir}.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">resources</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resources</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">type</span><span class="p">(</span><span class="n">resources</span><span class="p">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">[</span><span class="n">resources</span><span class="p">]</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">resources</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">_add_resource</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="w"> </span><span class="n">resource</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_add_resource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">base_dir</span><span class="p">:</span><span class="w"> </span><span class="n">Path</span><span class="p">,</span><span class="w"> </span><span class="n">resource</span><span class="p">:</span><span class="w"> </span><span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">):</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span><span class="o">.</span><span class="n">is_absolute</span><span class="p">()</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;..&#39;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">resource</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;The resource path must be relative and cannot contain &#39;/../&#39; elements.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">resource_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">base_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">resource</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">resource_path</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">_add_resource_file</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="w"> </span><span class="n">resource_path</span><span class="p">)</span>

<span class="w">            </span><span class="k">return</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">resource_path</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">glob_path</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">resource_path</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">):</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">glob_path</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>

<span class="w">                    </span><span class="bp">self</span><span class="o">.</span><span class="n">_add_resource_file</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="w"> </span><span class="n">glob_path</span><span class="p">)</span>

<span class="w">            </span><span class="k">return</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Specified resource is not a file or directory: &#39;{resource}&#39;&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_add_resource_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">base_dir</span><span class="p">:</span><span class="w"> </span><span class="n">Path</span><span class="p">,</span><span class="w"> </span><span class="n">resource_path</span><span class="p">:</span><span class="w"> </span><span class="n">Path</span><span class="p">):</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">parent</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">resource_path</span><span class="o">.</span><span class="n">parents</span><span class="p">:</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;__pycache__&#39;</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nb">str</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">):</span>

<span class="w">                </span><span class="k">return</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">resource_path</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Resource &#39;{resource_path}&#39; is already added to target directory &#39;{self.resources[resource_path]}&#39;&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="k">return</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="p">[</span><span class="n">resource_path</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;{resource_path.parent.relative_to(base_dir)}&quot;</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_dependencies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">packages</span><span class="p">:</span><span class="w"> </span><span class="n">list</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Adds required dependencies for the Python code.</span>

<span class="sd">        The list must contain the name of the Python packages or tuples in the form of (name, version) which are required to execute the component on AI Inference Server.</span>

<span class="sd">        The method will search for the packages for the target platform and collect their transitive dependencies as well.</span>

<span class="sd">        Packages that are distributed only in source format can be added too, but only if they are pure Python packages.</span>

<span class="sd">        Args:</span>

<span class="sd">            packages (list): Can be a list of strings (name) or a list of tuples (name, version) of the required packages for component execution</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span><span class="o">.</span><span class="n">add_dependencies</span><span class="p">(</span><span class="n">packages</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">set_requirements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">requirements_path</span><span class="p">:</span><span class="w"> </span><span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Reads the defined dependencies from the given `requirements.txt` file and creates a new dependency list. Previously added dependencies will be cleared.</span>

<span class="sd">        The file format must follow Python&#39;s requirements file format defined in PEP 508.</span>

<span class="sd">        It can contain URLs to additional repositories in the form of `--extra-index-url=my.repo.example.com`.</span>

<span class="sd">        Args:</span>

<span class="sd">            requirements_path (str): Path of the given `requirements.txt` file</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span><span class="o">.</span><span class="n">set_requirements</span><span class="p">(</span><span class="n">requirements_path</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_python_packages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Adds Python package(s) to the `PythonPackages.zip` file of the component.</span>

<span class="sd">        The `path` parameter can refer to either a `whl`, a `zip` or a `tar.gz` file.</span>

<span class="sd">        Zip files can be either a source distribution package or a collection of Python packages. Only pure Python source distributions are allowed.</span>

<span class="sd">        The dependency list of the component will be extended with the files added here, so that they will also get installed on the AI Inference Server.</span>

<span class="sd">        The method uses the `tempfile.tempdir` folder, so make sure that the folder is writeable.</span>

<span class="sd">        The wheel files must fulfill the requirements of the targeted device environment</span>

<span class="sd">        (e.g., the Python version must match the supported Python version of the targeted AI Inference Server, and the platform should be one of the supported ones too).</span>

<span class="sd">        Args:</span>

<span class="sd">            path (str): Path of the distribution file</span>

<span class="sd">        Examples:</span>

<span class="sd">            `component.add_python_packages(&#39;../resources/my_package-0.0.1-py3-none-any.wheel&#39;)`</span>

<span class="sd">                adds the wheel file to `PythonPackages.zip` and adds dictionary item `component.dependencies[&#39;my_package&#39;] = &#39;0.0.1&#39;`</span>

<span class="sd">            `component.add_python_packages(&#39;../resources/inference-wheels.zip&#39;)`</span>

<span class="sd">                adds all the wheel files in the zip to `PythonPackages.zip` and `component.dependencies`</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span><span class="o">.</span><span class="n">add_python_packages</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">set_parallel_steps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">replicas</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Sets the number of parallel executors.</span>

<span class="sd">        This method configures how many instances of the component can be</span>

<span class="sd">        executed at the same time.</span>

<span class="sd">        The component must be suitable for parallel execution. The inputs arriving</span>

<span class="sd">        to the component will be processed by different instances in parallel,</span>

<span class="sd">        and these instances do not share their state (e.g. variables). Every</span>

<span class="sd">        instance is initialized separately and receives only a fraction of the inputs.</span>

<span class="sd">        AI Inference Server supports at most 8 parallel instances.```</span>

<span class="sd">        Args:</span>

<span class="sd">            replicas (int): Number of parallel executors. Default is 1.</span>

<span class="sd">        Raises:</span>

<span class="sd">            ValueError: if the given argument is not a positive integer.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">not</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">replicas</span><span class="p">,</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">))</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">replicas</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="s2">&quot;Replica count must be a positive integer.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">replicas</span><span class="p">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;The current maximum of parallel executors is 8.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">_replicas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">replicas</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_metric</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Adds a metric that will be automatically used as a pipeline output.</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Name of the metric.</span>

<span class="sd">            desc (str): Description of the metric. (optional)</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="s2">&quot;_&quot;</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">name</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;The metric name must contain at least one underscore&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Metric &#39;{name}&#39; already exists&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">desc</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;desc&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">desc</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">delete_metric</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Remove a previously added metric.</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Name of the metric to be deleted.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Component &#39;{self.name}&#39; has no metric &#39;{name}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">        </span><span class="n">dict</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="o">**</span><span class="n">super</span><span class="p">()</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(),</span>

<span class="w">            </span><span class="s1">&#39;version&#39;</span><span class="p">:</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;entrypoint&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;./{self.entrypoint.name}&quot;</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;hwType&#39;</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;CPU&#39;</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;runtime&#39;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>

<span class="w">                </span><span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;python&#39;</span><span class="p">,</span>

<span class="w">                </span><span class="s1">&#39;version&#39;</span><span class="p">:</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">python_version</span>

<span class="w">            </span><span class="p">},</span>

<span class="w">            </span><span class="s1">&#39;replicas&#39;</span><span class="p">:</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_replicas</span>

<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">dict</span><span class="p">[</span><span class="s2">&quot;outputType&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">[{</span>

<span class="w">            </span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">name</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;String&#39;</span><span class="p">,</span>

<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">dict</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">enable_dependency_optimization</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Allows changing repository URLs to optimize the package size</span>

<span class="sd">        Allows the replacement of the `--index-url` argument during `pip download` to download</span>

<span class="sd">        CPU runtime optimized dependencies only. Enabling this optimization, the present</span>

<span class="sd">        `--index-url` will be prepended to the `--extra-index-url` list, and the Pytorch CPU only repository</span>

<span class="sd">        will be set as the `--index-url`.</span>

<span class="sd">        A warning message will be printed if the repository URL modification was necessary.</span>

<span class="sd">        Some dependencies have both CPU and GPU runtime</span>

<span class="sd">        versions, pytorch for example, but a `PythonComponent` can only run on CPU, so</span>

<span class="sd">        packaging the additional GPU runtime dependencies just enlarges the package size.</span>

<span class="sd">        If you want to run your model on GPU, convert it to an `ONNX` model and use it within a</span>

<span class="sd">        `GPURuntimeComponent`.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span><span class="o">.</span><span class="n">enable_dependency_optimization</span><span class="p">()</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">disable_dependency_optimization</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Disables any modification to repository URLs</span>

<span class="sd">        Disables the replacement of the `--index-url` argument during `pip download`.</span>

<span class="sd">        This way all `--index-url` or `--extra-index-url` arguments will be preserved if they</span>

<span class="sd">        were present in the requirements.txt file.</span>

<span class="sd">        Some dependencies have both CPU and GPU runtime</span>

<span class="sd">        versions, pytorch for example, but a `PythonComponent` can only run on CPU, so</span>

<span class="sd">        packaging the additional GPU runtime dependencies just enlarges the package size.</span>

<span class="sd">        A warning message will be printed about the package size if this optimization is disabled and</span>

<span class="sd">        the dependency list contains GPU optimized dependencies.</span>

<span class="sd">        Disabling this optimization will not allow the component to run on GPU.</span>

<span class="sd">        If you want to run your model on GPU, convert it to an `ONNX` model and use it within a</span>

<span class="sd">        `GPURuntimeComponent`.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span><span class="o">.</span><span class="n">disable_dependency_optimization</span><span class="p">()</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Validates that the component is ready to be serialized and packaged as part of a pipeline.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="p">:</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">                </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;Entrypoint must be defined&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">any</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">items</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">key</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="p">):</span>

<span class="w">                </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;Entrypoint must be added as resource to the root directory before setting up as entrypoint.&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span><span class="o">.</span><span class="n">dependencies</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span>

<span class="w">                </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;WARNING! There are no dependencies defined for component &#39;{self.name}&#39;. Please make sure that all necessary dependencies have been added.&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">True</span>

<span class="w">        </span><span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Component &#39;{self.name}&#39; is valid and ready to use.&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">destination</span><span class="p">,</span><span class="w"> </span><span class="n">validate</span><span class="o">=</span><span class="n">True</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Saves the component to a folder structure, so it can be used as part of a pipeline configuration package.</span>

<span class="sd">        Validation can be skipped by setting parameter `validate` to False.</span>

<span class="sd">        This is useful when the component is already validated and only intended to be saved.</span>

<span class="sd">        The component folder contains the following:</span>

<span class="sd">        - `requirements.txt` with a list of Python dependencies</span>

<span class="sd">        - Entry point script defined by the `entrypoint` attribute of the component</span>

<span class="sd">        - Extra files as added to the specified folders</span>

<span class="sd">        - `PythonPackages.zip` with the wheel binaries for the environment to be installed</span>

<span class="sd">        Args:</span>

<span class="sd">            destination (path-like): Target directory to which the component will be saved.</span>

<span class="sd">            validate (bool): With value True, triggers component validation. Defaults to True.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">validate</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>

<span class="w">        </span><span class="n">folder_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">name</span>

<span class="w">        </span><span class="n">folder_path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="n">True</span><span class="p">,</span><span class="w"> </span><span class="n">exist_ok</span><span class="o">=</span><span class="n">True</span><span class="p">)</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">file_path</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="p">:</span>

<span class="w">            </span><span class="n">dir_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">folder_path</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="p">[</span><span class="n">file_path</span><span class="p">]</span>

<span class="w">            </span><span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span><span class="w"> </span><span class="n">exist_ok</span><span class="o">=</span><span class="n">True</span><span class="p">)</span>

<span class="w">            </span><span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span><span class="w"> </span><span class="n">dir_path</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">file_path</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">folder_path</span><span class="p">)</span>
</code></pre></div>

</details>
<hr />
<h4 id="ancestors-in-mro_1">Ancestors (in MRO)</h4>
<ul>
<li>simaticai.deployment.Component</li>
</ul>
<h4 id="class-variables_2">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">BatchInfo</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">reserved_names</span>
</code></pre></div>

<h4 id="methods_3">Methods</h4>
<h4 id="add_dependencies_1">add_dependencies</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">add_dependencies</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">packages</span><span class="p">:</span> <span class="nb">list</span>
<span class="p">)</span>
</code></pre></div>

<p>Adds required dependencies for the Python code.</p>
<p>The list must contain the name of the Python packages or tuples in the form of (name, version) which are required to execute the component on AI Inference Server.
The method will search for the packages for the target platform and collect their transitive dependencies as well.
Packages that are distributed only in source format can be added too, but only if they are pure Python packages.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>packages</td>
<td>list</td>
<td>Can be a list of strings (name) or a list of tuples (name, version) of the required packages for component execution</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nx">def</span><span class="w"> </span><span class="nx">add_dependencies</span><span class="p">(</span><span class="kp">self</span><span class="p">,</span><span class="w"> </span><span class="nx">packages</span><span class="p">:</span><span class="w"> </span><span class="nx">list</span><span class="p">):</span>

<span class="w">        </span><span class="s">&quot;&quot;&quot;</span>

<span class="s">        Adds required dependencies for the Python code.</span>

<span class="s">        The list must contain the name of the Python packages or tuples in the form of (name, version) which are required to execute the component on AI Inference Server.</span>

<span class="s">        The method will search for the packages for the target platform and collect their transitive dependencies as well.</span>

<span class="s">        Packages that are distributed only in source format can be added too, but only if they are pure Python packages.</span>

<span class="s">        Args:</span>

<span class="s">            packages (list): Can be a list of strings (name) or a list of tuples (name, version) of the required packages for component execution</span>

<span class="s">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="kp">self</span><span class="p">.</span><span class="nx">is_valid</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">False</span>

<span class="w">        </span><span class="kp">self</span><span class="p">.</span><span class="nx">python_dependencies</span><span class="p">.</span><span class="nx">add_dependencies</span><span class="p">(</span><span class="nx">packages</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="add_input_3">add_input</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">add_input</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">desc</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

<p>Adds a new input to the component with its type.</p>
<p>Name of the variables cannot be reserved name like 'timestamp'.
Input variable 'timestamp' is a prebuilt key in the payload and its value contains the timestamp when the payload is created by AI Inference Server.</p>
<p>Types supported by AI Inference Server version 1.6 are contained in the <code>type_dictionary</code>. Newer AI Inference server version may support additional types.
In case the type is not known by the AI SDK, a warning message will be printed.
The most frequently used types are
- String:
    Typically used for data received from Databus
- Object:
    Object type variables are designed to receive from Vision Connect or transfer images between components
- Numeric scalar types:
    Typically used for data received from S7 Connector</p>
<p>The example payload below shows the format of image received from VCA Connector</p>
<div class="codehilite"><pre><span></span><code>    <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;image&quot;</span><span class="p">:</span>
        <span class="p">{</span>
            <span class="s2">&quot;resolutionWidth&quot;</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
            <span class="s2">&quot;resolutionHeight&quot;</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
            <span class="s2">&quot;mimeType&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;image/raw&quot;</span><span class="p">],</span>
            <span class="s2">&quot;dataType&quot;</span><span class="p">:</span> <span class="s2">&quot;uint8&quot;</span><span class="p">,</span>
            <span class="s2">&quot;channelsPerPixel&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s2">&quot;image&quot;</span><span class="p">:</span> <span class="n">_swap_bytes</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">tobytes</span><span class="p">())</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div>

<p>Between components the format is the same format as the format of Object as an output.</p>
<div class="codehilite"><pre><span></span><code>    <span class="s2">&quot;processedImage&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span> <span class="p">{</span>
                        <span class="s2">&quot;resolutionWidth&quot;</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
                        <span class="s2">&quot;resolutionHeight&quot;</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">height</span>
                        <span class="p">}</span>
                    <span class="p">),</span>
        <span class="s2">&quot;bytes&quot;</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">tobytes</span><span class="p">()</span>
    <span class="p">}</span>
</code></pre></div>

<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>str</td>
<td>Name of the new input.</td>
<td>None</td>
</tr>
<tr>
<td>_type</td>
<td>str</td>
<td>Type of the new input.</td>
<td>None</td>
</tr>
<tr>
<td>desc</td>
<td>str</td>
<td>Description of the input. (optional)</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">_type</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Adds a new input to the component with its type.</span>

<span class="sd">        Name of the variables cannot be reserved name like &#39;timestamp&#39;.</span>

<span class="sd">        Input variable &#39;timestamp&#39; is a prebuilt key in the payload and its value contains the timestamp when the payload is created by AI Inference Server.</span>

<span class="sd">        Types supported by AI Inference Server version 1.6 are contained in the `type_dictionary`. Newer AI Inference server version may support additional types.</span>

<span class="sd">        In case the type is not known by the AI SDK, a warning message will be printed.</span>

<span class="sd">        The most frequently used types are</span>

<span class="sd">        - String:</span>

<span class="sd">            Typically used for data received from Databus</span>

<span class="sd">        - Object:</span>

<span class="sd">            Object type variables are designed to receive from Vision Connect or transfer images between components</span>

<span class="sd">        - Numeric scalar types:</span>

<span class="sd">            Typically used for data received from S7 Connector</span>

<span class="sd">        The example payload below shows the format of image received from VCA Connector</span>

<span class="sd">        ```python</span>

<span class="sd">            payload = { &quot;image&quot;:</span>

<span class="sd">                {</span>

<span class="sd">                    &quot;resolutionWidth&quot;: image.width,</span>

<span class="sd">                    &quot;resolutionHeight&quot;: image.height,</span>

<span class="sd">                    &quot;mimeType&quot;: [&quot;image/raw&quot;],</span>

<span class="sd">                    &quot;dataType&quot;: &quot;uint8&quot;,</span>

<span class="sd">                    &quot;channelsPerPixel&quot;: 3,</span>

<span class="sd">                    &quot;image&quot;: _swap_bytes(image.tobytes())</span>

<span class="sd">                }</span>

<span class="sd">            }</span>

<span class="sd">        ```</span>

<span class="sd">        Between components the format is the same format as the format of Object as an output.</span>

<span class="sd">        ```python</span>

<span class="sd">            &quot;processedImage&quot;: {</span>

<span class="sd">                &quot;metadata&quot;: json.dumps( {</span>

<span class="sd">                                &quot;resolutionWidth&quot;: image.width,</span>

<span class="sd">                                &quot;resolutionHeight&quot;: image.height</span>

<span class="sd">                                }</span>

<span class="sd">                            ),</span>

<span class="sd">                &quot;bytes&quot;: image.tobytes()</span>

<span class="sd">            }</span>

<span class="sd">        ```</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Name of the new input.</span>

<span class="sd">            _type (str): Type of the new input.</span>

<span class="sd">            desc (str): Description of the input. (optional)</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Input &#39;{name}&#39; already exists.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">reserved_names</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Input &#39;{name}&#39; is a reserved keyword.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">_type</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">supported_types</span><span class="p">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;WARNING! Unknown type &#39;{_type}&#39; for input variable &#39;{name}&#39;. Please check if the target Inference Server supports this type.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">_type</span><span class="p">,</span>

<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">desc</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;desc&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">desc</span>
</code></pre></div>

</details>
<h4 id="add_metric">add_metric</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">add_metric</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">desc</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

<p>Adds a metric that will be automatically used as a pipeline output.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>str</td>
<td>Name of the metric.</td>
<td>None</td>
</tr>
<tr>
<td>desc</td>
<td>str</td>
<td>Description of the metric. (optional)</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_metric</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="k">desc</span><span class="err">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">str</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Adds a metric that will be automatically used as a pipeline output.</span>

<span class="ss">        Args:</span>

<span class="ss">            name (str): Name of the metric.</span>

<span class="ss">            desc (str): Description of the metric. (optional)</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ss">&quot;_&quot;</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">name</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="ss">&quot;The metric name must contain at least one underscore&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">metrics</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">metrics</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">metrics</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;Metric &#39;{name}&#39; already exists&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">metrics</span><span class="o">[</span><span class="n">name</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="k">desc</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">metrics</span><span class="o">[</span><span class="n">name</span><span class="o">][</span><span class="n">&#39;desc&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">desc</span>
</code></pre></div>

</details>
<h4 id="add_output_3">add_output</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">add_output</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">desc</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

<p>Adds a new output to the component.</p>
<p>Types supported by AI Inference Server version 1.6 are contained in the <code>type_dictionary</code>. Newer AI Inference server version may support additional types.
In case the type is not known by the AI SDK, a warning message will be printed.
The most frequently used types are
- String:
    Typically used for data to be sent to Databus
- Object:
    Typically used for images to be sent to ZMQ Connector
- Numeric scalar types:
    Typically used for data sent to S7 Connector</p>
<p>For outputs of type <code>Object</code> the entrypoint must return with a <code>dictionary</code> containing two fields, where one field has type <code>str</code> and the other field has type <code>bytes</code>.
The example below shows the required format, assuming that 'image' is a PIL Image.</p>
<div class="codehilite"><pre><span></span><code>    <span class="s2">&quot;processedImage&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span> <span class="p">{</span>
                        <span class="s2">&quot;resolutionWidth&quot;</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
                        <span class="s2">&quot;resolutionHeight&quot;</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">height</span>
                        <span class="p">}</span>
                    <span class="p">),</span>
        <span class="s2">&quot;bytes&quot;</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">tobytes</span><span class="p">()</span>
    <span class="p">}</span>
</code></pre></div>

<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>str</td>
<td>Name of the new output.</td>
<td>None</td>
</tr>
<tr>
<td>_type</td>
<td>str</td>
<td>Type of the new output.</td>
<td>None</td>
</tr>
<tr>
<td>desc</td>
<td>str</td>
<td>Description of the output. (optional)</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">_type</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Adds a new output to the component.</span>

<span class="sd">        Types supported by AI Inference Server version 1.6 are contained in the `type_dictionary`. Newer AI Inference server version may support additional types.</span>

<span class="sd">        In case the type is not known by the AI SDK, a warning message will be printed.</span>

<span class="sd">        The most frequently used types are</span>

<span class="sd">        - String:</span>

<span class="sd">            Typically used for data to be sent to Databus</span>

<span class="sd">        - Object:</span>

<span class="sd">            Typically used for images to be sent to ZMQ Connector</span>

<span class="sd">        - Numeric scalar types:</span>

<span class="sd">            Typically used for data sent to S7 Connector</span>

<span class="sd">        For outputs of type `Object` the entrypoint must return with a `dictionary` containing two fields, where one field has type `str` and the other field has type `bytes`.</span>

<span class="sd">        The example below shows the required format, assuming that &#39;image&#39; is a PIL Image.</span>

<span class="sd">        ```python</span>

<span class="sd">            &quot;processedImage&quot;: {</span>

<span class="sd">                &quot;metadata&quot;: json.dumps( {</span>

<span class="sd">                                &quot;resolutionWidth&quot;: image.width,</span>

<span class="sd">                                &quot;resolutionHeight&quot;: image.height</span>

<span class="sd">                                }</span>

<span class="sd">                            ),</span>

<span class="sd">                &quot;bytes&quot;: image.tobytes()</span>

<span class="sd">            }</span>

<span class="sd">        ```</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Name of the new output.</span>

<span class="sd">            _type (str): Type of the new output.</span>

<span class="sd">            desc (str): Description of the output. (optional)</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Output &#39;{name}&#39; already exists&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">_type</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">supported_types</span><span class="p">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;WARNING! Unknown type &#39;{_type}&#39; for input variable &#39;{name}&#39;. Please check if the target Inference Server supports this type.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">_type</span><span class="p">,</span>

<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">desc</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;desc&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">desc</span>
</code></pre></div>

</details>
<h4 id="add_python_packages">add_python_packages</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">add_python_packages</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>Adds Python package(s) to the <code>PythonPackages.zip</code> file of the component.</p>
<p>The <code>path</code> parameter can refer to either a <code>whl</code>, a <code>zip</code> or a <code>tar.gz</code> file.
Zip files can be either a source distribution package or a collection of Python packages. Only pure Python source distributions are allowed.
The dependency list of the component will be extended with the files added here, so that they will also get installed on the AI Inference Server.
The method uses the <code>tempfile.tempdir</code> folder, so make sure that the folder is writeable.</p>
<p>The wheel files must fulfill the requirements of the targeted device environment
(e.g., the Python version must match the supported Python version of the targeted AI Inference Server, and the platform should be one of the supported ones too).</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>path</td>
<td>str</td>
<td>Path of the distribution file</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_python_packages</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">path</span><span class="o">:</span><span class="w"> </span><span class="n">str</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="o">:</span>

<span class="w">        </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span>

<span class="s2">        Adds Python package(s) to the `PythonPackages.zip` file of the component.</span>

<span class="s2">        The `path` parameter can refer to either a `whl`, a `zip` or a `tar.gz` file.</span>

<span class="s2">        Zip files can be either a source distribution package or a collection of Python packages. Only pure Python source distributions are allowed.</span>

<span class="s2">        The dependency list of the component will be extended with the files added here, so that they will also get installed on the AI Inference Server.</span>

<span class="s2">        The method uses the `tempfile.tempdir` folder, so make sure that the folder is writeable.</span>

<span class="s2">        The wheel files must fulfill the requirements of the targeted device environment</span>

<span class="s2">        (e.g., the Python version must match the supported Python version of the targeted AI Inference Server, and the platform should be one of the supported ones too).</span>

<span class="s2">        Args:</span>

<span class="s2">            path (str): Path of the distribution file</span>

<span class="s2">        Examples:</span>

<span class="s2">            `component.add_python_packages(&#39;../resources/my_package-0.0.1-py3-none-any.wheel&#39;)`</span>

<span class="s2">                adds the wheel file to `PythonPackages.zip` and adds dictionary item `component.dependencies[&#39;my_package&#39;] = &#39;0.0.1&#39;`</span>

<span class="s2">            `component.add_python_packages(&#39;../resources/inference-wheels.zip&#39;)`</span>

<span class="s2">                adds all the wheel files in the zip to `PythonPackages.zip` and `component.dependencies`</span>

<span class="s2">        </span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">False</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">python_dependencies</span><span class="p">.</span><span class="n">add_python_packages</span><span class="p">(</span><span class="k">path</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="add_resources">add_resources</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">add_resources</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">base_dir</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">,</span>
    <span class="n">resources</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span>
<span class="p">)</span>
</code></pre></div>

<p>Adds files to a component.</p>
<p>To make your file resources available on the AI Inference Server you need to add them to the package resources.
These resources can be Python or config files, serialized ML models or reference data.
They are then available on path {component_root}/{resources} in the runtime environment.
When saving the package they will be copied from {base_dir}/{resources} into the package.
Files in '<strong>pycache</strong>' folders or any other hidden folders (folder name starting with '.' character) will be excluded.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>base_dir</td>
<td>path-like</td>
<td>Root folder of your code from which the resources are referred</td>
<td>None</td>
</tr>
<tr>
<td>resources</td>
<td>os.PathLike or List</td>
<td>A single path or list of relative paths to resource files</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_resources</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">base_dir</span><span class="p">:</span><span class="w"> </span><span class="n">os</span><span class="p">.</span><span class="n">PathLike</span><span class="p">,</span><span class="w"> </span><span class="nl">resources</span><span class="p">:</span><span class="w"> </span><span class="n">os</span><span class="p">.</span><span class="n">PathLike</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">list</span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Adds files to a component.</span>

<span class="ss">        To make your file resources available on the AI Inference Server you need to add them to the package resources.</span>

<span class="ss">        These resources can be Python or config files, serialized ML models or reference data.</span>

<span class="ss">        They are then available on path {component_root}/{resources} in the runtime environment.</span>

<span class="ss">        When saving the package they will be copied from {base_dir}/{resources} into the package.</span>

<span class="ss">        Files in &#39;__pycache__&#39; folders or any other hidden folders (folder name starting with &#39;.&#39; character) will be excluded.</span>

<span class="ss">        Args:</span>

<span class="ss">            base_dir (path-like): Root folder of your code from which the resources are referred</span>

<span class="ss">            resources (os.PathLike or List): A single path or list of relative paths to resource files</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">False</span>

<span class="w">        </span><span class="n">base_dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">Path</span><span class="p">(</span><span class="n">base_dir</span><span class="p">).</span><span class="n">resolve</span><span class="p">().</span><span class="k">absolute</span><span class="p">()</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">base_dir</span><span class="p">.</span><span class="n">is_dir</span><span class="p">()</span><span class="err">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;Parameter &#39;base_dir&#39; must be a directory and available in path {base_dir}.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">resources</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resources</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">type</span><span class="p">(</span><span class="n">resources</span><span class="p">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="o">[</span><span class="n">resources</span><span class="o">]</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">resources</span><span class="p">:</span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">_add_resource</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="w"> </span><span class="n">resource</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="change_input_2">change_input</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">change_input</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">desc</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

<p>Changes one of the inputs of the component.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>str</td>
<td>Name of the input to be changed.</td>
<td>None</td>
</tr>
<tr>
<td>_type</td>
<td>str</td>
<td>New type of the input.</td>
<td>None</td>
</tr>
<tr>
<td>desc</td>
<td>str</td>
<td>Description of the input. (optional)</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">change_input</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="nl">_type</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="k">desc</span><span class="err">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">str</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Changes one of the inputs of the component.</span>

<span class="ss">        Args:</span>

<span class="ss">            name (str): Name of the input to be changed.</span>

<span class="ss">            _type (str): New type of the input.</span>

<span class="ss">            desc (str): Description of the input. (optional)</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">inputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;There is no input with name &#39;{name}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">_type</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">supported_types</span><span class="p">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="p">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;WARNING! Unknown type &#39;{_type}&#39; for input variable &#39;{name}&#39;. Please check if the target Inference Server supports this type.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">inputs</span><span class="o">[</span><span class="n">name</span><span class="o">][</span><span class="n">&#39;type&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_type</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="k">desc</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">inputs</span><span class="o">[</span><span class="n">name</span><span class="o">][</span><span class="n">&#39;desc&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">desc</span>
</code></pre></div>

</details>
<h4 id="change_output_2">change_output</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">change_output</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">desc</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

<p>Changes one of the outputs of the component.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>str</td>
<td>Name of the output to be changed.</td>
<td>None</td>
</tr>
<tr>
<td>_type</td>
<td>str</td>
<td>The new type of the output.</td>
<td>None</td>
</tr>
<tr>
<td>desc</td>
<td>str</td>
<td>Description of the output. (optional)</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">change_output</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="nl">_type</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="k">desc</span><span class="err">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">str</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Changes one of the outputs of the component.</span>

<span class="ss">        Args:</span>

<span class="ss">            name (str): Name of the output to be changed.</span>

<span class="ss">            _type (str): The new type of the output.</span>

<span class="ss">            desc (str): Description of the output. (optional)</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;There is no output with name &#39;{name}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">_type</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">supported_types</span><span class="p">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="p">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;WARNING! Unknown type &#39;{_type}&#39; for input variable &#39;{name}&#39;. Please check if the target Inference Server supports this type.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">outputs</span><span class="o">[</span><span class="n">name</span><span class="o">][</span><span class="n">&#39;type&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_type</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="k">desc</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">inputs</span><span class="o">[</span><span class="n">name</span><span class="o">][</span><span class="n">&#39;desc&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">desc</span>
</code></pre></div>

</details>
<h4 id="delete_input_3">delete_input</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">delete_input</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span>
</code></pre></div>

<p>Deletes an input from the component by name.</p>
<p>Once the package has been created with the given component, it is recommended not to change the component directly.
Instead, all necessary methods to change it are available through the package to avoid component inconsistencies.
It is recommended to use <code>package.delete_input_wire(...)</code> with default parameter <code>with_input=True</code>.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>str</td>
<td>Name of the input to be deleted.</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nx">def</span><span class="w"> </span><span class="nx">delete_input</span><span class="p">(</span><span class="kp">self</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="p">:</span><span class="w"> </span><span class="nx">str</span><span class="p">):</span>

<span class="w">        </span><span class="s">&quot;&quot;&quot;</span>

<span class="s">        Deletes an input from the component by name.</span>

<span class="s">        Once the package has been created with the given component, it is recommended not to change the component directly.</span>

<span class="s">        Instead, all necessary methods to change it are available through the package to avoid component inconsistencies.</span>

<span class="s">        It is recommended to use `package.delete_input_wire(...)` with default parameter `with_input=True`.</span>

<span class="s">        Args:</span>

<span class="s">            name (str): Name of the input to be deleted.</span>

<span class="s">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="kp">self</span><span class="p">.</span><span class="nx">inputs</span><span class="p">:</span>

<span class="w">            </span><span class="nx">raise</span><span class="w"> </span><span class="nx">AssertionError</span><span class="p">(</span><span class="nx">f</span><span class="s">&quot;Component &#39;{self.name}&#39; has no input &#39;{name}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="kp">self</span><span class="p">.</span><span class="nx">inputs</span><span class="p">.</span><span class="nx">pop</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="delete_metric">delete_metric</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">delete_metric</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span>
</code></pre></div>

<p>Remove a previously added metric.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>str</td>
<td>Name of the metric to be deleted.</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code>    def delete_metric(self, name: str):

        &quot;&quot;&quot;

        Remove a previously added metric.

        Args:

            name (str): Name of the metric to be deleted.

        &quot;&quot;&quot;

        if name not in self.metrics:

            raise AssertionError(f&quot;Component &#39;{self.name}&#39; has no metric &#39;{name}&#39;&quot;)

        self.metrics.pop(name)
</code></pre></div>

</details>
<h4 id="delete_output_3">delete_output</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">delete_output</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span>
</code></pre></div>

<p>Deletes an output from the component by name.</p>
<p>Once the package has been created with the given component, it is recommended not to change the component directly.
Instead, all necessary methods to change it are available through the package to avoid component inconsistencies.
Deleting an output which is represented in any wire will cause package inconsistency.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>str</td>
<td>Name of the output to be deleted.</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nx">def</span><span class="w"> </span><span class="nx">delete_output</span><span class="p">(</span><span class="kp">self</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="p">:</span><span class="w"> </span><span class="nx">str</span><span class="p">):</span>

<span class="w">        </span><span class="s">&quot;&quot;&quot;</span>

<span class="s">        Deletes an output from the component by name.</span>

<span class="s">        Once the package has been created with the given component, it is recommended not to change the component directly.</span>

<span class="s">        Instead, all necessary methods to change it are available through the package to avoid component inconsistencies.</span>

<span class="s">        Deleting an output which is represented in any wire will cause package inconsistency.</span>

<span class="s">        Args:</span>

<span class="s">            name (str): Name of the output to be deleted.</span>

<span class="s">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="kp">self</span><span class="p">.</span><span class="nx">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="nx">raise</span><span class="w"> </span><span class="nx">AssertionError</span><span class="p">(</span><span class="nx">f</span><span class="s">&quot;Component &#39;{self.name}&#39; has no output &#39;{name}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="kp">self</span><span class="p">.</span><span class="nx">outputs</span><span class="p">.</span><span class="nx">pop</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="disable_dependency_optimization">disable_dependency_optimization</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">disable_dependency_optimization</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<p>Disables any modification to repository URLs</p>
<p>Disables the replacement of the <code>--index-url</code> argument during <code>pip download</code>.
This way all <code>--index-url</code> or <code>--extra-index-url</code> arguments will be preserved if they
were present in the requirements.txt file.
Some dependencies have both CPU and GPU runtime
versions, pytorch for example, but a <code>PythonComponent</code> can only run on CPU, so
packaging the additional GPU runtime dependencies just enlarges the package size.
A warning message will be printed about the package size if this optimization is disabled and
the dependency list contains GPU optimized dependencies.
Disabling this optimization will not allow the component to run on GPU.
If you want to run your model on GPU, convert it to an <code>ONNX</code> model and use it within a
<code>GPURuntimeComponent</code>.</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">disable_dependency_optimization</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">:</span>

<span class="w">        </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span>

<span class="s2">        Disables any modification to repository URLs</span>

<span class="s2">        Disables the replacement of the `--index-url` argument during `pip download`.</span>

<span class="s2">        This way all `--index-url` or `--extra-index-url` arguments will be preserved if they</span>

<span class="s2">        were present in the requirements.txt file.</span>

<span class="s2">        Some dependencies have both CPU and GPU runtime</span>

<span class="s2">        versions, pytorch for example, but a `PythonComponent` can only run on CPU, so</span>

<span class="s2">        packaging the additional GPU runtime dependencies just enlarges the package size.</span>

<span class="s2">        A warning message will be printed about the package size if this optimization is disabled and</span>

<span class="s2">        the dependency list contains GPU optimized dependencies.</span>

<span class="s2">        Disabling this optimization will not allow the component to run on GPU.</span>

<span class="s2">        If you want to run your model on GPU, convert it to an `ONNX` model and use it within a</span>

<span class="s2">        `GPURuntimeComponent`.</span>

<span class="s2">        </span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">python_dependencies</span><span class="p">.</span><span class="n">disable_dependency_optimization</span><span class="p">()</span>
</code></pre></div>

</details>
<h4 id="enable_dependency_optimization">enable_dependency_optimization</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">enable_dependency_optimization</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<p>Allows changing repository URLs to optimize the package size</p>
<p>Allows the replacement of the <code>--index-url</code> argument during <code>pip download</code> to download
CPU runtime optimized dependencies only. Enabling this optimization, the present
<code>--index-url</code> will be prepended to the <code>--extra-index-url</code> list, and the Pytorch CPU only repository
will be set as the <code>--index-url</code>.
A warning message will be printed if the repository URL modification was necessary.
Some dependencies have both CPU and GPU runtime
versions, pytorch for example, but a <code>PythonComponent</code> can only run on CPU, so
packaging the additional GPU runtime dependencies just enlarges the package size.
If you want to run your model on GPU, convert it to an <code>ONNX</code> model and use it within a
<code>GPURuntimeComponent</code>.</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">enable_dependency_optimization</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">:</span>

<span class="w">        </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span>

<span class="s2">        Allows changing repository URLs to optimize the package size</span>

<span class="s2">        Allows the replacement of the `--index-url` argument during `pip download` to download</span>

<span class="s2">        CPU runtime optimized dependencies only. Enabling this optimization, the present</span>

<span class="s2">        `--index-url` will be prepended to the `--extra-index-url` list, and the Pytorch CPU only repository</span>

<span class="s2">        will be set as the `--index-url`.</span>

<span class="s2">        A warning message will be printed if the repository URL modification was necessary.</span>

<span class="s2">        Some dependencies have both CPU and GPU runtime</span>

<span class="s2">        versions, pytorch for example, but a `PythonComponent` can only run on CPU, so</span>

<span class="s2">        packaging the additional GPU runtime dependencies just enlarges the package size.</span>

<span class="s2">        If you want to run your model on GPU, convert it to an `ONNX` model and use it within a</span>

<span class="s2">        `GPURuntimeComponent`.</span>

<span class="s2">        </span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">python_dependencies</span><span class="p">.</span><span class="n">enable_dependency_optimization</span><span class="p">()</span>
</code></pre></div>

</details>
<h4 id="save_3">save</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">save</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">destination</span><span class="p">,</span>
    <span class="n">validate</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</code></pre></div>

<p>Saves the component to a folder structure, so it can be used as part of a pipeline configuration package.</p>
<p>Validation can be skipped by setting parameter <code>validate</code> to False.
This is useful when the component is already validated and only intended to be saved.</p>
<p>The component folder contains the following:</p>
<ul>
<li><code>requirements.txt</code> with a list of Python dependencies</li>
<li>Entry point script defined by the <code>entrypoint</code> attribute of the component</li>
<li>Extra files as added to the specified folders</li>
<li><code>PythonPackages.zip</code> with the wheel binaries for the environment to be installed</li>
</ul>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>destination</td>
<td>path-like</td>
<td>Target directory to which the component will be saved.</td>
<td>None</td>
</tr>
<tr>
<td>validate</td>
<td>bool</td>
<td>With value True, triggers component validation. Defaults to True.</td>
<td>True</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">save</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">destination</span><span class="p">,</span><span class="w"> </span><span class="n">validate</span><span class="o">=</span><span class="no">True</span><span class="p">)</span><span class="o">:</span>

<span class="w">        </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span>

<span class="s2">        Saves the component to a folder structure, so it can be used as part of a pipeline configuration package.</span>

<span class="s2">        Validation can be skipped by setting parameter `validate` to False.</span>

<span class="s2">        This is useful when the component is already validated and only intended to be saved.</span>

<span class="s2">        The component folder contains the following:</span>

<span class="s2">        - `requirements.txt` with a list of Python dependencies</span>

<span class="s2">        - Entry point script defined by the `entrypoint` attribute of the component</span>

<span class="s2">        - Extra files as added to the specified folders</span>

<span class="s2">        - `PythonPackages.zip` with the wheel binaries for the environment to be installed</span>

<span class="s2">        Args:</span>

<span class="s2">            destination (path-like): Target directory to which the component will be saved.</span>

<span class="s2">            validate (bool): With value True, triggers component validation. Defaults to True.</span>

<span class="s2">        </span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">validate</span><span class="p">()</span>

<span class="w">        </span><span class="n">folder_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">Path</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="k">name</span>

<span class="w">        </span><span class="n">folder_path</span><span class="p">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="no">True</span><span class="p">,</span><span class="w"> </span><span class="n">exist_ok</span><span class="o">=</span><span class="no">True</span><span class="p">)</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">file_path</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">resources</span><span class="o">:</span>

<span class="w">            </span><span class="n">dir_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">folder_path</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">resources</span><span class="err">[</span><span class="n">file_path</span><span class="err">]</span>

<span class="w">            </span><span class="n">os</span><span class="p">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span><span class="w"> </span><span class="n">exist_ok</span><span class="o">=</span><span class="no">True</span><span class="p">)</span>

<span class="w">            </span><span class="n">shutil</span><span class="p">.</span><span class="n">copy</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span><span class="w"> </span><span class="n">dir_path</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">file_path</span><span class="p">.</span><span class="k">name</span><span class="p">)</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">python_dependencies</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="n">folder_path</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="set_entrypoint">set_entrypoint</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">set_entrypoint</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">entrypoint</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span>
</code></pre></div>

<p>Sets the entrypoint module for the component.</p>
<p>The entrypoint is the Python code which is responsible for receiving the input data and producing a structured response with the output for the AI Inference Server.
The script should consume a JSON string and produce another. See the short example below.</p>
<p>The file will be copied into the root directory of the component on the AI Inference Server, so every file reference should be aligned.</p>
<p>The example code below shows a basic structure of the entrypoint Python code.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="c1"># by adding the parent folder of your modules to system path makes them available for relative import</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;./src&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()))</span>
<span class="kn">from</span> <span class="nn">my_module</span> <span class="kn">import</span> <span class="n">processor</span>  <span class="c1"># then the processor module can be imported</span>

<span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="n">input_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>  <span class="c1"># incoming JSON string is loaded as a dictionary</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">processor</span><span class="o">.</span><span class="n">process_data</span><span class="p">(</span><span class="n">input_data</span><span class="p">)</span>  <span class="c1"># the process_data can be called to process the incoming data</span>

    <span class="c1"># the code below creates the formatted output for the AI Inference Server</span>
    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">answer</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ready&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;output&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">answer</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ready&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;output&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">result</span><span class="p">)}</span>

    <span class="k">return</span> <span class="n">answer</span>
</code></pre></div>

<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>entrypoint</td>
<td>str</td>
<td>Name of the new entrypoint script to be copied</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="k">def</span><span class="w"> </span><span class="nf">set_entrypoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">entrypoint</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>

<span class="w">        </span><span class="s2">&quot;&quot;&quot;</span>

<span class="s2">        Sets the entrypoint module for the component.</span>

<span class="s2">        The entrypoint is the Python code which is responsible for receiving the input data and producing a structured response with the output for the AI Inference Server.</span>

<span class="s2">        The script should consume a JSON string and produce another. See the short example below.</span>

<span class="s2">        The file will be copied into the root directory of the component on the AI Inference Server, so every file reference should be aligned.</span>

<span class="s2">        The example code below shows a basic structure of the entrypoint Python code.</span>

<span class="s2">        ```python</span>

<span class="s2">        import json</span>

<span class="s2">        import sys</span>

<span class="s2">        from pathlib import Path</span>

<span class="s2">        # by adding the parent folder of your modules to system path makes them available for relative import</span>

<span class="s2">        sys.path.insert(0, str(Path(&#39;./src&#39;).resolve()))</span>

<span class="s2">        from my_module import processor  # then the processor module can be imported</span>

<span class="s2">        def run(data: str):</span>

<span class="s2">            input_data = json.loads(data)  # incoming JSON string is loaded as a dictionary</span>

<span class="s2">            result = processor.process_data(input_data)  # the process_data can be called to process the incoming data</span>

<span class="s2">            # the code below creates the formatted output for the AI Inference Server</span>

<span class="s2">            if result is None:</span>

<span class="s2">                answer = {&quot;ready&quot;: False, &quot;output&quot;: None}</span>

<span class="s2">            else:</span>

<span class="s2">                answer = {&quot;ready&quot;: True, &quot;output&quot;: json.dumps(result)}</span>

<span class="s2">            return answer</span>

<span class="s2">        ```</span>

<span class="s2">        Args:</span>

<span class="s2">            entrypoint (str): Name of the new entrypoint script to be copied</span>

<span class="s2">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">False</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nb">any</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">items</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">key</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">entrypoint</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="p">):</span>

<span class="w">            </span><span class="k">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;Entrypoint must be added as resource to the root directory before setting up as entrypoint.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">entrypoint</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="set_parallel_steps">set_parallel_steps</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">set_parallel_steps</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">replicas</span>
<span class="p">)</span>
</code></pre></div>

<p>Sets the number of parallel executors.</p>
<p>This method configures how many instances of the component can be
executed at the same time.
The component must be suitable for parallel execution. The inputs arriving
to the component will be processed by different instances in parallel,
and these instances do not share their state (e.g. variables). Every
instance is initialized separately and receives only a fraction of the inputs.
AI Inference Server supports at most 8 parallel instances.```</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>replicas</td>
<td>int</td>
<td>Number of parallel executors. Default is 1.</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Raises:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>ValueError</td>
<td>if the given argument is not a positive integer.</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">set_parallel_steps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">replicas</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Sets the number of parallel executors.</span>

<span class="sd">        This method configures how many instances of the component can be</span>

<span class="sd">        executed at the same time.</span>

<span class="sd">        The component must be suitable for parallel execution. The inputs arriving</span>

<span class="sd">        to the component will be processed by different instances in parallel,</span>

<span class="sd">        and these instances do not share their state (e.g. variables). Every</span>

<span class="sd">        instance is initialized separately and receives only a fraction of the inputs.</span>

<span class="sd">        AI Inference Server supports at most 8 parallel instances.```</span>

<span class="sd">        Args:</span>

<span class="sd">            replicas (int): Number of parallel executors. Default is 1.</span>

<span class="sd">        Raises:</span>

<span class="sd">            ValueError: if the given argument is not a positive integer.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">not</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">replicas</span><span class="p">,</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">))</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">replicas</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="s2">&quot;Replica count must be a positive integer.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">replicas</span><span class="p">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;The current maximum of parallel executors is 8.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">_replicas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">replicas</span>
</code></pre></div>

</details>
<h4 id="set_requirements">set_requirements</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">set_requirements</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">requirements_path</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span>
<span class="p">)</span>
</code></pre></div>

<p>Reads the defined dependencies from the given <code>requirements.txt</code> file and creates a new dependency list. Previously added dependencies will be cleared.</p>
<p>The file format must follow Python's requirements file format defined in PEP 508.
It can contain URLs to additional repositories in the form of <code>--extra-index-url=my.repo.example.com</code>.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>requirements_path</td>
<td>str</td>
<td>Path of the given <code>requirements.txt</code> file</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code>    def set_requirements(self, requirements_path: os.PathLike):

        &quot;&quot;&quot;

        Reads the defined dependencies from the given <span class="sb">`requirements.txt`</span> file and creates a new dependency list. Previously added dependencies will be cleared.

        The file format must follow Python&#39;s requirements file format defined in PEP 508.

        It can contain URLs to additional repositories in the form of <span class="sb">`--extra-index-url=my.repo.example.com`</span>.

        Args:

            requirements_path (str): Path of the given <span class="sb">`requirements.txt`</span> file

        &quot;&quot;&quot;

        self.is_valid = False

        self.python_dependencies.set_requirements(requirements_path)
</code></pre></div>

</details>
<h4 id="validate_3">validate</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">validate</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<p>Validates that the component is ready to be serialized and packaged as part of a pipeline.</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nx">def</span><span class="w"> </span><span class="nx">validate</span><span class="p">(</span><span class="kp">self</span><span class="p">):</span>

<span class="w">        </span><span class="s">&quot;&quot;&quot;</span>

<span class="s">        Validates that the component is ready to be serialized and packaged as part of a pipeline.</span>

<span class="s">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="kp">self</span><span class="p">.</span><span class="nx">is_valid</span><span class="p">:</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="kp">self</span><span class="p">.</span><span class="nx">entrypoint</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">None</span><span class="p">:</span>

<span class="w">                </span><span class="nx">raise</span><span class="w"> </span><span class="nx">AssertionError</span><span class="p">(</span><span class="s">&quot;Entrypoint must be defined&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="nx">any</span><span class="p">(</span><span class="nx">key</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">key</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="kp">self</span><span class="p">.</span><span class="nx">resources</span><span class="p">.</span><span class="nx">items</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nx">key</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kp">self</span><span class="p">.</span><span class="nx">entrypoint</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;.&#39;</span><span class="p">):</span>

<span class="w">                </span><span class="nx">raise</span><span class="w"> </span><span class="nx">AssertionError</span><span class="p">(</span><span class="s">&quot;Entrypoint must be added as resource to the root directory before setting up as entrypoint.&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="nx">len</span><span class="p">(</span><span class="kp">self</span><span class="p">.</span><span class="nx">python_dependencies</span><span class="p">.</span><span class="nx">dependencies</span><span class="p">)</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span>

<span class="w">                </span><span class="nx">_logger</span><span class="p">.</span><span class="nx">warning</span><span class="p">(</span><span class="nx">f</span><span class="s">&quot;WARNING! There are no dependencies defined for component &#39;{self.name}&#39;. Please make sure that all necessary dependencies have been added.&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="kp">self</span><span class="p">.</span><span class="nx">python_dependencies</span><span class="p">.</span><span class="nx">validate</span><span class="p">()</span>

<span class="w">            </span><span class="kp">self</span><span class="p">.</span><span class="nx">is_valid</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">True</span>

<span class="w">        </span><span class="nx">_logger</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="nx">f</span><span class="s">&quot;Component &#39;{self.name}&#39; is valid and ready to use.&quot;</span><span class="p">)</span>
</code></pre></div>

</details>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../log_module/mock_logger.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Mock Logger" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Mock Logger
            </div>
          </div>
        </a>
      
      
        
        <a href="index.html" class="md-footer__link md-footer__link--next" aria-label="Next: Index" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Index
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright (C) Siemens AG 2021. All Rights Reserved.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.ecf98df9.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.48f2be22.min.js"></script>
      
    
  </body>
</html>