<!--
  SPDX-FileCopyrightText: 2025 (C) 2025 Siemens AG
  SPDX-License-Identifier: MIT
-->

<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../../favicon.ico">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.5.0">
    
    
      
        <title>Python Component - AI Software Development Kit</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.2e8b5541.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../styles.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#module-simaticaideploypython_component" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../index.html" title="AI Software Development Kit" class="md-header__button md-logo" aria-label="AI Software Development Kit" data-md-component="logo">
      
  <img src="../../../Sie_logo_white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AI Software Development Kit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Python Component
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../index.html" title="AI Software Development Kit" class="md-nav__button md-logo" aria-label="AI Software Development Kit" data-md-component="logo">
      
  <img src="../../../Sie_logo_white.svg" alt="logo">

    </a>
    AI Software Development Kit
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../index.html" class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../CHANGELOG.html" class="md-nav__link">
        Changelog
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../Readme.html" class="md-nav__link">
        Readme
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../user_manual.html" class="md-nav__link">
        User Manual
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_1" type="checkbox" id="__nav_5_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5_1">
          Log Module
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Log Module" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_1">
          <span class="md-nav__icon md-icon"></span>
          Log Module
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../log_module/index.html" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../log_module/mock_logger.html" class="md-nav__link">
        Mock Logger
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_2" type="checkbox" id="__nav_5_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5_2">
          Simaticai
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Simaticai" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_2">
          <span class="md-nav__icon md-icon"></span>
          Simaticai
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../deployment.html" class="md-nav__link">
        Deployment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../model_config_pb2.html" class="md-nav__link">
        Model Config Pb2
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_2_4" type="checkbox" id="__nav_5_2_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5_2_4">
          Data
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Data" data-md-level="3">
        <label class="md-nav__title" for="__nav_5_2_4">
          <span class="md-nav__icon md-icon"></span>
          Data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../data/index.html" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../data/schemas.html" class="md-nav__link">
        Schemas
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_2_5" type="checkbox" id="__nav_5_2_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5_2_5">
          Deploy
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Deploy" data-md-level="3">
        <label class="md-nav__title" for="__nav_5_2_5">
          <span class="md-nav__icon md-icon"></span>
          Deploy
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="component.html" class="md-nav__link">
        Component
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="gpuruntime_component.html" class="md-nav__link">
        Gpuruntime Component
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipeline.html" class="md-nav__link">
        Pipeline
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipeline_data.html" class="md-nav__link">
        Pipeline Data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipeline_page.html" class="md-nav__link">
        Pipeline Page
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Python Component
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="python_component.html" class="md-nav__link md-nav__link--active">
        Python Component
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#python_version_validator" class="md-nav__link">
    python_version_validator
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pythoncomponent" class="md-nav__link">
    PythonComponent
  </a>
  
    <nav class="md-nav" aria-label="PythonComponent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#attributes" class="md-nav__link">
    Attributes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_dependencies" class="md-nav__link">
    add_dependencies
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_input" class="md-nav__link">
    add_input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_metric" class="md-nav__link">
    add_metric
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_output" class="md-nav__link">
    add_output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_python_packages" class="md-nav__link">
    add_python_packages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_resources" class="md-nav__link">
    add_resources
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change_input" class="md-nav__link">
    change_input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change_output" class="md-nav__link">
    change_output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_input" class="md-nav__link">
    delete_input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_metric" class="md-nav__link">
    delete_metric
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_output" class="md-nav__link">
    delete_output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disable_dependency_optimization" class="md-nav__link">
    disable_dependency_optimization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enable_dependency_optimization" class="md-nav__link">
    enable_dependency_optimization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save" class="md-nav__link">
    save
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_entrypoint" class="md-nav__link">
    set_entrypoint
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_parallel_steps" class="md-nav__link">
    set_parallel_steps
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_pyproject_toml" class="md-nav__link">
    set_pyproject_toml
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_requirements" class="md-nav__link">
    set_requirements
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate" class="md-nav__link">
    validate
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_2_6" type="checkbox" id="__nav_5_2_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5_2_6">
          Helpers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Helpers" data-md-level="3">
        <label class="md-nav__title" for="__nav_5_2_6">
          <span class="md-nav__icon md-icon"></span>
          Helpers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../helpers/index.html" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../helpers/model_config.html" class="md-nav__link">
        Model Config
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../helpers/pep508.html" class="md-nav__link">
        Pep508
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../helpers/reporter.html" class="md-nav__link">
        Reporter
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../helpers/tempfiles.html" class="md-nav__link">
        Tempfiles
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../helpers/yaml_helper.html" class="md-nav__link">
        Yaml Helper
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_2_7" type="checkbox" id="__nav_5_2_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5_2_7">
          Packaging
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Packaging" data-md-level="3">
        <label class="md-nav__title" for="__nav_5_2_7">
          <span class="md-nav__icon md-icon"></span>
          Packaging
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../packaging/constants.html" class="md-nav__link">
        Constants
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../packaging/index.html" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../packaging/python_dependencies.html" class="md-nav__link">
        Python Dependencies
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../packaging/wheelhouse.html" class="md-nav__link">
        Wheelhouse
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_2_8" type="checkbox" id="__nav_5_2_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5_2_8">
          Testing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Testing" data-md-level="3">
        <label class="md-nav__title" for="__nav_5_2_8">
          <span class="md-nav__icon md-icon"></span>
          Testing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../testing/component_runner.html" class="md-nav__link">
        Component Runner
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../testing/data_stream.html" class="md-nav__link">
        Data Stream
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../testing/docker_venv.html" class="md-nav__link">
        Docker Venv
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../testing/index.html" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../testing/pipeline_runner.html" class="md-nav__link">
        Pipeline Runner
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../testing/pipeline_validator.html" class="md-nav__link">
        Pipeline Validator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../testing/run_component.html" class="md-nav__link">
        Run Component
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../testing/run_gpuruntime_component.html" class="md-nav__link">
        Run Gpuruntime Component
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../testing/runner_config.html" class="md-nav__link">
        Runner Config
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../testing/timeseries_stream.html" class="md-nav__link">
        Timeseries Stream
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../testing/vca_stream.html" class="md-nav__link">
        Vca Stream
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#python_version_validator" class="md-nav__link">
    python_version_validator
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pythoncomponent" class="md-nav__link">
    PythonComponent
  </a>
  
    <nav class="md-nav" aria-label="PythonComponent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#attributes" class="md-nav__link">
    Attributes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_dependencies" class="md-nav__link">
    add_dependencies
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_input" class="md-nav__link">
    add_input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_metric" class="md-nav__link">
    add_metric
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_output" class="md-nav__link">
    add_output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_python_packages" class="md-nav__link">
    add_python_packages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_resources" class="md-nav__link">
    add_resources
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change_input" class="md-nav__link">
    change_input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change_output" class="md-nav__link">
    change_output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_input" class="md-nav__link">
    delete_input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_metric" class="md-nav__link">
    delete_metric
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_output" class="md-nav__link">
    delete_output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disable_dependency_optimization" class="md-nav__link">
    disable_dependency_optimization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enable_dependency_optimization" class="md-nav__link">
    enable_dependency_optimization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save" class="md-nav__link">
    save
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_entrypoint" class="md-nav__link">
    set_entrypoint
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_parallel_steps" class="md-nav__link">
    set_parallel_steps
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_pyproject_toml" class="md-nav__link">
    set_pyproject_toml
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_requirements" class="md-nav__link">
    set_requirements
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate" class="md-nav__link">
    validate
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="module-simaticaideploypython_component">Module simaticai.deploy.python_component</h1>
<p>None</p>
<p>None</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="c1"># Copyright (C) Siemens AG 2021. All Rights Reserved. Confidential.</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">simaticai.deploy.component</span><span class="w"> </span><span class="kn">import</span> <span class="n">Component</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">simaticai.packaging.python_dependencies</span><span class="w"> </span><span class="kn">import</span> <span class="n">PythonDependencies</span>

<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">()</span>

<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span><span class="o">.</span><span class="n">handlers</span> <span class="o">=</span> <span class="p">[</span><span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)]</span>

<span class="n">_logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">_logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PythonComponent&#39;</span><span class="p">,</span> <span class="s1">&#39;python_version_validator&#39;</span><span class="p">]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">python_version_validator</span><span class="p">(</span><span class="n">version</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Checks if Python version string is valid and describes supported version.</span>

<span class="sd">    Only version 3.10 and 3.11 is supported. A patch version is optional and accepted but logs a warning.</span>

<span class="sd">    Accepted syntaxes are:</span>

<span class="sd">        - {major}.{minor}</span>

<span class="sd">        - {major}.{minor}.{patch}</span>

<span class="sd">    Args:</span>

<span class="sd">        version (str): Python version string</span>

<span class="sd">    Raises:</span>

<span class="sd">        ValueError: if the provided version is not supported</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">supported_versions</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;3.10&quot;</span><span class="p">,</span> <span class="s2">&quot;3.11&quot;</span><span class="p">]</span>

    <span class="n">error_message</span> <span class="o">=</span> <span class="s2">&quot;The defined python version is not supported. Currently supported Python versions are 3.10 and 3.11. Python version must be specified only with major and minor version, e.g. &#39;3.10&#39;.&quot;</span>

    <span class="n">warning_message</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;Required Python version was specified with patch version.</span>

<span class="s2">                Please note that the patch digit of the required Python version is often not taken into account by the Python ecosystem,</span>

<span class="s2">                so there is no guarantee it has the desired effect.&quot;&quot;&quot;</span>

    <span class="n">python_version_matcher</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(3)\.(0|[1-9][0-9]*)\.?(0|[1-9][0-9]*)?$&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">version</span><span class="p">))</span>

    <span class="n">major_minor_version</span> <span class="o">=</span> <span class="s2">&quot;0.0&quot;</span>

    <span class="n">has_patch_version</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="n">python_version_matcher</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

        <span class="n">major_minor_version</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">python_version_matcher</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">python_version_matcher</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="n">has_patch_version</span> <span class="o">=</span> <span class="n">python_version_matcher</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">major_minor_version</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">supported_versions</span><span class="p">:</span>

        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">error_message</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">has_patch_version</span><span class="p">:</span>

        <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">warning_message</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PythonComponent</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    A pipeline component implemented using Python scripts and libraries.</span>

<span class="sd">    A `PythonComponent` wraps Python code resource files such as saved models into a structured folder, which can be added to a pipeline</span>

<span class="sd">    configuration package.</span>

<span class="sd">    For a comprehensive overview on how to wrap ML models into Python components, we recommend you refer to</span>

<span class="sd">    the AI SDK User Manual, especially the guideline for writing pipeline components. We also recommend you</span>

<span class="sd">    study the example Python components in the E2E Tutorials for the AI SDK.</span>

<span class="sd">    A new `PythonComponent` is empty.</span>

<span class="sd">    Args:</span>

<span class="sd">        name (str): Component name. (default: inference)</span>

<span class="sd">        desc (str): Component description (optional)</span>

<span class="sd">        version (str): Component version. (default: 0.0.1)</span>

<span class="sd">        python_version (str): Python version on the target AI Inference Server.</span>

<span class="sd">            At the moment of writing, the current version supports Python 3.10 and 3.11.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;inference&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s2">&quot;0.0.1&quot;</span><span class="p">,</span> <span class="n">python_version</span><span class="o">=</span><span class="s1">&#39;3.10&#39;</span><span class="p">,</span> <span class="n">desc</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Creates a new, empty Python component.</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Component name. (default: inference)</span>

<span class="sd">            desc (str): Component description (optional)</span>

<span class="sd">            version (str): Component version. (default: 0.0.1)</span>

<span class="sd">            python_version (str): Python version on the target AI Inference Server. At the moment of writing, AI Inference Server supports Python 3.10 and 3.11.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">desc</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="n">python_version_validator</span><span class="p">(</span><span class="n">python_version</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>

            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">python_version</span> <span class="o">=</span> <span class="n">python_version</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">version</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">resources</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span> <span class="o">=</span> <span class="n">PythonDependencies</span><span class="p">(</span><span class="n">python_version</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_replicas</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>

        <span class="n">text</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Metrics:</span><span class="se">\n</span><span class="s2">&quot;</span>

            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">metric</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

                <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt; </span><span class="si">{</span><span class="n">name</span><span class="si">}{</span><span class="s1">&#39;: &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">metric</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">]</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">metric</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;desc&#39;</span><span class="p">)</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="kc">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="p">):</span>

            <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Resources:</span><span class="se">\n</span><span class="s2">&quot;</span>

            <span class="k">for</span> <span class="n">path</span><span class="p">,</span> <span class="n">base</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

                <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">base</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">path</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

            <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Entrypoint: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">return</span> <span class="n">text</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_entrypoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entrypoint</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Sets the entrypoint module for the component.</span>

<span class="sd">        The entrypoint is the Python code which is responsible for receiving the input data and producing a structured response with the output for the AI Inference Server.</span>

<span class="sd">        The script should consume a JSON string and produce another. See the short example below.</span>

<span class="sd">        The file will be copied into the root directory of the component on the AI Inference Server, so every file reference should be aligned.</span>

<span class="sd">        The example code below shows a basic structure of the entrypoint Python code.</span>

<span class="sd">        ```python</span>

<span class="sd">        import json</span>

<span class="sd">        import sys</span>

<span class="sd">        from pathlib import Path</span>

<span class="sd">        # by adding the parent folder of your modules to system path makes them available for relative import</span>

<span class="sd">        sys.path.insert(0, str(Path(&#39;./src&#39;).resolve()))</span>

<span class="sd">        from my_module import processor  # then the processor module can be imported</span>

<span class="sd">        def run(data: str):</span>

<span class="sd">            input_data = json.loads(data)  # incoming JSON string is loaded as a dictionary</span>

<span class="sd">            result = processor.process_data(input_data)  # the process_data can be called to process the incoming data</span>

<span class="sd">            # the code below creates the formatted output for the AI Inference Server</span>

<span class="sd">            if result is None:</span>

<span class="sd">                answer = {&quot;ready&quot;: False, &quot;output&quot;: None}</span>

<span class="sd">            else:</span>

<span class="sd">                answer = {&quot;ready&quot;: True, &quot;output&quot;: json.dumps(result)}</span>

<span class="sd">            return answer</span>

<span class="sd">        ```</span>

<span class="sd">        Args:</span>

<span class="sd">            entrypoint (str): Name of the new entrypoint script to be copied</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">entrypoint</span> <span class="ow">and</span> <span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;.&#39;</span><span class="p">):</span>

            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;Entrypoint must be added as resource to the root directory before setting up as entrypoint.&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">entrypoint</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_resources</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_dir</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">,</span> <span class="n">resources</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">,</span> <span class="nb">list</span><span class="p">]):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Adds files to a component.</span>

<span class="sd">        To make your file resources available on the AI Inference Server you need to add them to the package resources.</span>

<span class="sd">        These resources can be Python or config files, serialized ML models or reference data.</span>

<span class="sd">        They are then available on path {component_root}/{resources} in the runtime environment.</span>

<span class="sd">        When saving the package they will be copied from {base_dir}/{resources} into the package.</span>

<span class="sd">        Files in &#39;__pycache__&#39; folders will be excluded.</span>

<span class="sd">        Until version 2.3.0 of AI SDK hidden files and folders (starting with &#39;.&#39;) are also excluded.</span>

<span class="sd">        Args:</span>

<span class="sd">            base_dir (path-like): Root folder of your code from which the resources are referred</span>

<span class="sd">            resources (os.PathLike or List): A single path or list of relative paths to resource files</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">base_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">base_dir</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">base_dir</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>

            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Parameter &#39;base_dir&#39; must be a directory and available in path </span><span class="si">{</span><span class="n">base_dir</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

        <span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">resources</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span> <span class="k">else</span> <span class="p">[</span><span class="n">resources</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">resource</span> <span class="ow">in</span> <span class="n">resources</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_add_resource</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">resource</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_add_resource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">resource</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">Path</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span><span class="o">.</span><span class="n">is_absolute</span><span class="p">()</span> <span class="ow">or</span> <span class="s1">&#39;..&#39;</span> <span class="ow">in</span> <span class="n">resource</span><span class="p">:</span>

            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;The resource path must be relative and cannot contain &#39;/../&#39; elements.&quot;</span><span class="p">)</span>

        <span class="n">resource_path</span> <span class="o">=</span> <span class="n">base_dir</span> <span class="o">/</span> <span class="n">resource</span>

        <span class="k">if</span> <span class="n">resource_path</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_add_resource_file</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">resource_path</span><span class="p">)</span>

            <span class="k">return</span>

        <span class="k">if</span> <span class="n">resource_path</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>

            <span class="k">for</span> <span class="n">glob_path</span> <span class="ow">in</span> <span class="n">resource_path</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">):</span>

                <span class="k">if</span> <span class="n">glob_path</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">_add_resource_file</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">glob_path</span><span class="p">)</span>

            <span class="k">return</span>

        <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Specified resource is not a file or directory: &#39;</span><span class="si">{</span><span class="n">resource</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_add_resource_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">resource_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">for</span> <span class="n">parent</span> <span class="ow">in</span> <span class="n">resource_path</span><span class="o">.</span><span class="n">parents</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">parent</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;__pycache__&#39;</span><span class="p">:</span>

                <span class="k">return</span>

        <span class="k">if</span> <span class="n">resource_path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>

            <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Resource &#39;</span><span class="si">{</span><span class="n">resource_path</span><span class="si">}</span><span class="s2">&#39; is already added to target directory &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="p">[</span><span class="n">resource_path</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="p">[</span><span class="n">resource_path</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">resource_path</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">relative_to</span><span class="p">(</span><span class="n">base_dir</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_dependencies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">packages</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Adds required dependencies for the Python code.</span>

<span class="sd">        The list must contain the name of the Python packages or tuples in the form of (name, version) which are required to execute the component on AI Inference Server.</span>

<span class="sd">        The method will search for the packages for the target platform and collect their transitive dependencies as well.</span>

<span class="sd">        Packages that are distributed only in source format can be added too, but only if they are pure Python packages.</span>

<span class="sd">        Args:</span>

<span class="sd">            packages (list): Can be a list of strings (name) or a list of tuples (name, version) of the required packages for component execution</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span><span class="o">.</span><span class="n">add_dependencies</span><span class="p">(</span><span class="n">packages</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_requirements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">requirements_path</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Reads the defined dependencies from the given `requirements.txt` file and creates a new dependency list. Previously added dependencies will be cleared.</span>

<span class="sd">        The file format must follow Python&#39;s requirements file format defined in PEP 508.</span>

<span class="sd">        It can contain URLs to additional repositories in the form of `--extra-index-url=my.repo.example.com`.</span>

<span class="sd">        Args:</span>

<span class="sd">            requirements_path (str): Path of the given `requirements.txt` file</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span><span class="o">.</span><span class="n">set_requirements</span><span class="p">(</span><span class="n">requirements_path</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_pyproject_toml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pyproject_path</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Reads the defined dependencies from the given `pyproject.toml` file and adds it to the requirements list.</span>

<span class="sd">        Only the dependencies defined in the `[project]` section will be added to the component.</span>

<span class="sd">        Args:</span>

<span class="sd">            pyproject_path (str): Path of the given `pyproject.toml` file</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span><span class="o">.</span><span class="n">set_pyproject_toml</span><span class="p">(</span><span class="n">pyproject_path</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_python_packages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Adds Python package(s) to the `PythonPackages.zip` file of the component.</span>

<span class="sd">        The `path` parameter can refer to either a `whl`, a `zip` or a `tar.gz` file.</span>

<span class="sd">        Zip files can be either a source distribution package or a collection of Python packages. Only pure Python source distributions are allowed.</span>

<span class="sd">        The dependency list of the component will be extended with the files added here, so that they will also get installed on the AI Inference Server.</span>

<span class="sd">        The method uses the `tempfile.tempdir` folder, so make sure that the folder is writeable.</span>

<span class="sd">        The wheel files must fulfill the requirements of the targeted device environment</span>

<span class="sd">        (e.g., the Python version must match the supported Python version of the targeted AI Inference Server, and the platform should be one of the supported ones too).</span>

<span class="sd">        Args:</span>

<span class="sd">            path (str): Path of the distribution file</span>

<span class="sd">        Examples:</span>

<span class="sd">            `component.add_python_packages(&#39;../resources/my_package-0.0.1-py3-none-any.wheel&#39;)`</span>

<span class="sd">                adds the wheel file to `PythonPackages.zip` and adds dictionary item `component.dependencies[&#39;my_package&#39;] = &#39;0.0.1&#39;`</span>

<span class="sd">            `component.add_python_packages(&#39;../resources/inference-wheels.zip&#39;)`</span>

<span class="sd">                adds all the wheel files in the zip to `PythonPackages.zip` and `component.dependencies`</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span><span class="o">.</span><span class="n">add_python_packages</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_parallel_steps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">replicas</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Sets the number of parallel executors.</span>

<span class="sd">        This method configures how many instances of the component can be</span>

<span class="sd">        executed at the same time.</span>

<span class="sd">        The component must be suitable for parallel execution. The inputs arriving</span>

<span class="sd">        to the component will be processed by different instances in parallel,</span>

<span class="sd">        and these instances do not share their state (e.g. variables). Every</span>

<span class="sd">        instance is initialized separately and receives only a fraction of the inputs.</span>

<span class="sd">        AI Inference Server supports at most 8 parallel instances.```</span>

<span class="sd">        Args:</span>

<span class="sd">            replicas (int): Number of parallel executors. Default is 1.</span>

<span class="sd">        Raises:</span>

<span class="sd">            ValueError: if the given argument is not a positive integer.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">replicas</span><span class="p">,</span> <span class="nb">int</span><span class="p">))</span> <span class="ow">or</span> <span class="n">replicas</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>

            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Replica count must be a positive integer.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="mi">8</span> <span class="o">&lt;</span> <span class="n">replicas</span><span class="p">:</span>

            <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;The current maximum of parallel executors is 8.&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_replicas</span> <span class="o">=</span> <span class="n">replicas</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_metric</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">desc</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Adds a metric that will be automatically used as a pipeline output.</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Name of the metric.</span>

<span class="sd">            desc (str): Description of the metric. (optional)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="s2">&quot;_&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>

            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;The metric name must contain at least one underscore&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="p">:</span>

            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Metric &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; already exists&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">desc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;desc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">desc</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">delete_metric</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Remove a previously added metric.</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Name of the metric to be deleted.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="p">:</span>

            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Component &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; has no metric &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">component_dict</span> <span class="o">=</span> <span class="p">{</span>

            <span class="o">**</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(),</span>

            <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="p">,</span>

            <span class="s1">&#39;entrypoint&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;./</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>

            <span class="s1">&#39;hwType&#39;</span><span class="p">:</span> <span class="s1">&#39;CPU&#39;</span><span class="p">,</span>

            <span class="s1">&#39;runtime&#39;</span><span class="p">:</span> <span class="p">{</span>

                <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;python&#39;</span><span class="p">,</span>

                <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">python_version</span>

            <span class="p">},</span>

            <span class="s1">&#39;replicas&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_replicas</span>

        <span class="p">}</span>

        <span class="n">component_dict</span><span class="p">[</span><span class="s2">&quot;outputType&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">[{</span>

            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>

            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;String&#39;</span><span class="p">,</span>

            <span class="s1">&#39;metric&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>

        <span class="p">}</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>

        <span class="k">return</span> <span class="n">component_dict</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">enable_dependency_optimization</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Allows changing repository URLs to optimize the package size</span>

<span class="sd">        Allows the replacement of the `--index-url` argument during `pip download` to download</span>

<span class="sd">        CPU runtime optimized dependencies only. Enabling this optimization, the present</span>

<span class="sd">        `--index-url` will be prepended to the `--extra-index-url` list, and the Pytorch CPU only repository</span>

<span class="sd">        will be set as the `--index-url`.</span>

<span class="sd">        A warning message will be printed if the repository URL modification was necessary.</span>

<span class="sd">        Some dependencies have both CPU and GPU runtime</span>

<span class="sd">        versions, pytorch for example, but a `PythonComponent` can only run on CPU, so</span>

<span class="sd">        packaging the additional GPU runtime dependencies just enlarges the package size.</span>

<span class="sd">        If you want to run your model on GPU, convert it to an `ONNX` model and use it within a</span>

<span class="sd">        `GPURuntimeComponent`.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span><span class="o">.</span><span class="n">enable_dependency_optimization</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">disable_dependency_optimization</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Disables any modification to repository URLs</span>

<span class="sd">        Disables the replacement of the `--index-url` argument during `pip download`.</span>

<span class="sd">        This way all `--index-url` or `--extra-index-url` arguments will be preserved if they</span>

<span class="sd">        were present in the requirements.txt file.</span>

<span class="sd">        Some dependencies have both CPU and GPU runtime</span>

<span class="sd">        versions, pytorch for example, but a `PythonComponent` can only run on CPU, so</span>

<span class="sd">        packaging the additional GPU runtime dependencies just enlarges the package size.</span>

<span class="sd">        A warning message will be printed about the package size if this optimization is disabled and</span>

<span class="sd">        the dependency list contains GPU optimized dependencies.</span>

<span class="sd">        Disabling this optimization will not allow the component to run on GPU.</span>

<span class="sd">        If you want to run your model on GPU, convert it to an `ONNX` model and use it within a</span>

<span class="sd">        `GPURuntimeComponent`.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span><span class="o">.</span><span class="n">disable_dependency_optimization</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Validates that the component is ready to be serialized and packaged as part of a pipeline.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="p">:</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

                <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;Entrypoint must be defined&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span><span class="o">.</span><span class="n">name</span> <span class="ow">and</span> <span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;.&#39;</span><span class="p">):</span>

                <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;Entrypoint must be added as resource to the root directory before setting up as entrypoint.&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span><span class="o">.</span><span class="n">dependencies</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>

                <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;WARNING! There are no dependencies defined for component &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;. Please make sure that all necessary dependencies have been added.&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Component &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; is valid and ready to use.&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">destination</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Saves the component to a folder structure, so it can be used as part of a pipeline configuration package.</span>

<span class="sd">        Validation can be skipped by setting parameter `validate` to False.</span>

<span class="sd">        This is useful when the component is already validated and only intended to be saved.</span>

<span class="sd">        The component folder contains the following:</span>

<span class="sd">        - `requirements.txt` with a list of Python dependencies</span>

<span class="sd">        - Entry point script defined by the `entrypoint` attribute of the component</span>

<span class="sd">        - Extra files as added to the specified folders</span>

<span class="sd">        - `PythonPackages.zip` with the wheel binaries for the environment to be installed</span>

<span class="sd">        Args:</span>

<span class="sd">            destination (path-like): Target directory to which the component will be saved.</span>

<span class="sd">            validate (bool): With value True, triggers component validation. Defaults to True.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">validate</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>

        <span class="n">folder_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

        <span class="n">folder_path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="p">:</span>

            <span class="n">dir_path</span> <span class="o">=</span> <span class="n">folder_path</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="p">[</span><span class="n">file_path</span><span class="p">]</span>

            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">dir_path</span> <span class="o">/</span> <span class="n">file_path</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">folder_path</span><span class="p">)</span>
</code></pre></div>

</details>
<h2 id="functions">Functions</h2>
<h3 id="python_version_validator">python_version_validator</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">python_version_validator</span><span class="p">(</span>
    <span class="n">version</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span>
</code></pre></div>

<p>Checks if Python version string is valid and describes supported version.</p>
<p>Only version 3.10 and 3.11 is supported. A patch version is optional and accepted but logs a warning.</p>
<p>Accepted syntaxes are:</p>
<div class="codehilite"><pre><span></span><code>- {major}.{minor}
- {major}.{minor}.{patch}
</code></pre></div>

<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>version</td>
<td>str</td>
<td>Python version string</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Raises:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>ValueError</td>
<td>if the provided version is not supported</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code>def python_version_validator(version: str):

    &quot;&quot;&quot;

    Checks if Python version string is valid and describes supported version.

    Only version 3.10 and 3.11 is supported. A patch version is optional and accepted but logs a warning.

    Accepted syntaxes are:

        <span class="k">-</span> {major}.{minor}

        <span class="k">-</span> {major}.{minor}.{patch}

    Args:

        version (str): Python version string

    Raises:

        ValueError: if the provided version is not supported

    &quot;&quot;&quot;

    supported_versions = [&quot;3.10&quot;, &quot;3.11&quot;]

    error_message = &quot;The defined python version is not supported. Currently supported Python versions are 3.10 and 3.11. Python version must be specified only with major and minor version, e.g. &#39;3.10&#39;.&quot;

    warning_message = &quot;&quot;&quot;Required Python version was specified with patch version.

                Please note that the patch digit of the required Python version is often not taken into account by the Python ecosystem,

                so there is no guarantee it has the desired effect.&quot;&quot;&quot;

    python_version_matcher = re.match(r&#39;^(3)\.(0|[1-9][0-9]*)\.?(0|[1-9][0-9]*)?$&#39;, str(version))

    major_minor_version = &quot;0.0&quot;

    has_patch_version = False

    if python_version_matcher is not None:

        major_minor_version = f&quot;{python_version_matcher.group(1)}.{python_version_matcher.group(2)}&quot;

        has_patch_version = python_version_matcher.group(3) is not None

    if major_minor_version not in supported_versions:

        raise ValueError(error_message)

    if has_patch_version:

        _logger.warning(warning_message)
</code></pre></div>

</details>
<h2 id="classes">Classes</h2>
<h3 id="pythoncomponent">PythonComponent</h3>
<p>A pipeline component implemented using Python scripts and libraries.</p>
<p>A <code>PythonComponent</code> wraps Python code resource files such as saved models into a structured folder, which can be added to a pipeline
configuration package.</p>
<p>For a comprehensive overview on how to wrap ML models into Python components, we recommend you refer to
the AI SDK User Manual, especially the guideline for writing pipeline components. We also recommend you
study the example Python components in the E2E Tutorials for the AI SDK.</p>
<p>A new <code>PythonComponent</code> is empty.</p>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PythonComponent</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;inference&#39;</span><span class="p">,</span>
    <span class="n">version</span><span class="o">=</span><span class="s1">&#39;0.0.1&#39;</span><span class="p">,</span>
    <span class="n">python_version</span><span class="o">=</span><span class="s1">&#39;3.10&#39;</span><span class="p">,</span>
    <span class="n">desc</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="p">)</span>
</code></pre></div>

<h4 id="attributes">Attributes</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>str</td>
<td>Component name. (default: inference)</td>
<td>None</td>
</tr>
<tr>
<td>desc</td>
<td>str</td>
<td>Component description (optional)</td>
<td>None</td>
</tr>
<tr>
<td>version</td>
<td>str</td>
<td>Component version. (default: 0.0.1)</td>
<td>None</td>
</tr>
<tr>
<td>python_version</td>
<td>str</td>
<td>Python version on the target AI Inference Server. At the moment of writing, the current version supports Python 3.10 and 3.11.</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="n">PythonComponent</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    A pipeline component implemented using Python scripts and libraries.</span>

<span class="sd">    A `PythonComponent` wraps Python code resource files such as saved models into a structured folder, which can be added to a pipeline</span>

<span class="sd">    configuration package.</span>

<span class="sd">    For a comprehensive overview on how to wrap ML models into Python components, we recommend you refer to</span>

<span class="sd">    the AI SDK User Manual, especially the guideline for writing pipeline components. We also recommend you</span>

<span class="sd">    study the example Python components in the E2E Tutorials for the AI SDK.</span>

<span class="sd">    A new `PythonComponent` is empty.</span>

<span class="sd">    Args:</span>

<span class="sd">        name (str): Component name. (default: inference)</span>

<span class="sd">        desc (str): Component description (optional)</span>

<span class="sd">        version (str): Component version. (default: 0.0.1)</span>

<span class="sd">        python_version (str): Python version on the target AI Inference Server.</span>

<span class="sd">            At the moment of writing, the current version supports Python 3.10 and 3.11.</span>

<span class="sd">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;inference&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="o">=</span><span class="s2">&quot;0.0.1&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">python_version</span><span class="o">=</span><span class="s1">&#39;3.10&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Creates a new, empty Python component.</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Component name. (default: inference)</span>

<span class="sd">            desc (str): Component description (optional)</span>

<span class="sd">            version (str): Component version. (default: 0.0.1)</span>

<span class="sd">            python_version (str): Python version on the target AI Inference Server. At the moment of writing, AI Inference Server supports Python 3.10 and 3.11.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="o">=</span><span class="n">desc</span><span class="p">)</span>

<span class="w">        </span><span class="n">try</span><span class="p">:</span>

<span class="w">            </span><span class="n">python_version_validator</span><span class="p">(</span><span class="n">python_version</span><span class="p">)</span>

<span class="w">        </span><span class="n">except</span><span class="w"> </span><span class="n">ValueError</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">error</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">python_version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">python_version</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">version</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PythonDependencies</span><span class="p">(</span><span class="n">python_version</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">_replicas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb">str</span><span class="p">:</span>

<span class="w">        </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">super</span><span class="p">()</span><span class="o">.</span><span class="n">__repr__</span><span class="p">()</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Metrics:</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">metric</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;&lt; {name}{&#39;: &#39; + metric[&#39;desc&#39;] if metric.get(&#39;desc&#39;) is not None else &#39;&#39;}</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="p">):</span>

<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Resources:</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;  {base}/{path.name}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;./&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;Entrypoint: {self.entrypoint}</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">text</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">set_entrypoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">entrypoint</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Sets the entrypoint module for the component.</span>

<span class="sd">        The entrypoint is the Python code which is responsible for receiving the input data and producing a structured response with the output for the AI Inference Server.</span>

<span class="sd">        The script should consume a JSON string and produce another. See the short example below.</span>

<span class="sd">        The file will be copied into the root directory of the component on the AI Inference Server, so every file reference should be aligned.</span>

<span class="sd">        The example code below shows a basic structure of the entrypoint Python code.</span>

<span class="sd">        ```python</span>

<span class="sd">        import json</span>

<span class="sd">        import sys</span>

<span class="sd">        from pathlib import Path</span>

<span class="sd">        # by adding the parent folder of your modules to system path makes them available for relative import</span>

<span class="sd">        sys.path.insert(0, str(Path(&#39;./src&#39;).resolve()))</span>

<span class="sd">        from my_module import processor  # then the processor module can be imported</span>

<span class="sd">        def run(data: str):</span>

<span class="sd">            input_data = json.loads(data)  # incoming JSON string is loaded as a dictionary</span>

<span class="sd">            result = processor.process_data(input_data)  # the process_data can be called to process the incoming data</span>

<span class="sd">            # the code below creates the formatted output for the AI Inference Server</span>

<span class="sd">            if result is None:</span>

<span class="sd">                answer = {&quot;ready&quot;: False, &quot;output&quot;: None}</span>

<span class="sd">            else:</span>

<span class="sd">                answer = {&quot;ready&quot;: True, &quot;output&quot;: json.dumps(result)}</span>

<span class="sd">            return answer</span>

<span class="sd">        ```</span>

<span class="sd">        Args:</span>

<span class="sd">            entrypoint (str): Name of the new entrypoint script to be copied</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">any</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">items</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">key</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">entrypoint</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="p">):</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;Entrypoint must be added as resource to the root directory before setting up as entrypoint.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">entrypoint</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_resources</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">base_dir</span><span class="p">:</span><span class="w"> </span><span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">,</span><span class="w"> </span><span class="n">resources</span><span class="p">:</span><span class="w"> </span><span class="n">Union</span><span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">,</span><span class="w"> </span><span class="n">list</span><span class="p">]):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Adds files to a component.</span>

<span class="sd">        To make your file resources available on the AI Inference Server you need to add them to the package resources.</span>

<span class="sd">        These resources can be Python or config files, serialized ML models or reference data.</span>

<span class="sd">        They are then available on path {component_root}/{resources} in the runtime environment.</span>

<span class="sd">        When saving the package they will be copied from {base_dir}/{resources} into the package.</span>

<span class="sd">        Files in &#39;__pycache__&#39; folders will be excluded.</span>

<span class="sd">        Until version 2.3.0 of AI SDK hidden files and folders (starting with &#39;.&#39;) are also excluded.</span>

<span class="sd">        Args:</span>

<span class="sd">            base_dir (path-like): Root folder of your code from which the resources are referred</span>

<span class="sd">            resources (os.PathLike or List): A single path or list of relative paths to resource files</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span>

<span class="w">        </span><span class="n">base_dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">base_dir</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">base_dir</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Parameter &#39;base_dir&#39; must be a directory and available in path {base_dir}.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">resources</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resources</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">type</span><span class="p">(</span><span class="n">resources</span><span class="p">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">[</span><span class="n">resources</span><span class="p">]</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">resources</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">_add_resource</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="w"> </span><span class="n">resource</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_add_resource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">base_dir</span><span class="p">:</span><span class="w"> </span><span class="n">Path</span><span class="p">,</span><span class="w"> </span><span class="n">resource</span><span class="p">:</span><span class="w"> </span><span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">):</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span><span class="o">.</span><span class="n">is_absolute</span><span class="p">()</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;..&#39;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">resource</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;The resource path must be relative and cannot contain &#39;/../&#39; elements.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">resource_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">base_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">resource</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">resource_path</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">_add_resource_file</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="w"> </span><span class="n">resource_path</span><span class="p">)</span>

<span class="w">            </span><span class="k">return</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">resource_path</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">glob_path</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">resource_path</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">):</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">glob_path</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>

<span class="w">                    </span><span class="bp">self</span><span class="o">.</span><span class="n">_add_resource_file</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="w"> </span><span class="n">glob_path</span><span class="p">)</span>

<span class="w">            </span><span class="k">return</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Specified resource is not a file or directory: &#39;{resource}&#39;&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_add_resource_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">base_dir</span><span class="p">:</span><span class="w"> </span><span class="n">Path</span><span class="p">,</span><span class="w"> </span><span class="n">resource_path</span><span class="p">:</span><span class="w"> </span><span class="n">Path</span><span class="p">):</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">parent</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">resource_path</span><span class="o">.</span><span class="n">parents</span><span class="p">:</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;__pycache__&#39;</span><span class="p">:</span>

<span class="w">                </span><span class="k">return</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">resource_path</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Resource &#39;{resource_path}&#39; is already added to target directory &#39;{self.resources[resource_path]}&#39;&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="k">return</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="p">[</span><span class="n">resource_path</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;{resource_path.parent.relative_to(base_dir)}&quot;</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_dependencies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">packages</span><span class="p">:</span><span class="w"> </span><span class="n">list</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Adds required dependencies for the Python code.</span>

<span class="sd">        The list must contain the name of the Python packages or tuples in the form of (name, version) which are required to execute the component on AI Inference Server.</span>

<span class="sd">        The method will search for the packages for the target platform and collect their transitive dependencies as well.</span>

<span class="sd">        Packages that are distributed only in source format can be added too, but only if they are pure Python packages.</span>

<span class="sd">        Args:</span>

<span class="sd">            packages (list): Can be a list of strings (name) or a list of tuples (name, version) of the required packages for component execution</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span><span class="o">.</span><span class="n">add_dependencies</span><span class="p">(</span><span class="n">packages</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">set_requirements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">requirements_path</span><span class="p">:</span><span class="w"> </span><span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Reads the defined dependencies from the given `requirements.txt` file and creates a new dependency list. Previously added dependencies will be cleared.</span>

<span class="sd">        The file format must follow Python&#39;s requirements file format defined in PEP 508.</span>

<span class="sd">        It can contain URLs to additional repositories in the form of `--extra-index-url=my.repo.example.com`.</span>

<span class="sd">        Args:</span>

<span class="sd">            requirements_path (str): Path of the given `requirements.txt` file</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span><span class="o">.</span><span class="n">set_requirements</span><span class="p">(</span><span class="n">requirements_path</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">set_pyproject_toml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">pyproject_path</span><span class="p">:</span><span class="w"> </span><span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Reads the defined dependencies from the given `pyproject.toml` file and adds it to the requirements list.</span>

<span class="sd">        Only the dependencies defined in the `[project]` section will be added to the component.</span>

<span class="sd">        Args:</span>

<span class="sd">            pyproject_path (str): Path of the given `pyproject.toml` file</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span><span class="o">.</span><span class="n">set_pyproject_toml</span><span class="p">(</span><span class="n">pyproject_path</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_python_packages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Adds Python package(s) to the `PythonPackages.zip` file of the component.</span>

<span class="sd">        The `path` parameter can refer to either a `whl`, a `zip` or a `tar.gz` file.</span>

<span class="sd">        Zip files can be either a source distribution package or a collection of Python packages. Only pure Python source distributions are allowed.</span>

<span class="sd">        The dependency list of the component will be extended with the files added here, so that they will also get installed on the AI Inference Server.</span>

<span class="sd">        The method uses the `tempfile.tempdir` folder, so make sure that the folder is writeable.</span>

<span class="sd">        The wheel files must fulfill the requirements of the targeted device environment</span>

<span class="sd">        (e.g., the Python version must match the supported Python version of the targeted AI Inference Server, and the platform should be one of the supported ones too).</span>

<span class="sd">        Args:</span>

<span class="sd">            path (str): Path of the distribution file</span>

<span class="sd">        Examples:</span>

<span class="sd">            `component.add_python_packages(&#39;../resources/my_package-0.0.1-py3-none-any.wheel&#39;)`</span>

<span class="sd">                adds the wheel file to `PythonPackages.zip` and adds dictionary item `component.dependencies[&#39;my_package&#39;] = &#39;0.0.1&#39;`</span>

<span class="sd">            `component.add_python_packages(&#39;../resources/inference-wheels.zip&#39;)`</span>

<span class="sd">                adds all the wheel files in the zip to `PythonPackages.zip` and `component.dependencies`</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span><span class="o">.</span><span class="n">add_python_packages</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">set_parallel_steps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">replicas</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Sets the number of parallel executors.</span>

<span class="sd">        This method configures how many instances of the component can be</span>

<span class="sd">        executed at the same time.</span>

<span class="sd">        The component must be suitable for parallel execution. The inputs arriving</span>

<span class="sd">        to the component will be processed by different instances in parallel,</span>

<span class="sd">        and these instances do not share their state (e.g. variables). Every</span>

<span class="sd">        instance is initialized separately and receives only a fraction of the inputs.</span>

<span class="sd">        AI Inference Server supports at most 8 parallel instances.```</span>

<span class="sd">        Args:</span>

<span class="sd">            replicas (int): Number of parallel executors. Default is 1.</span>

<span class="sd">        Raises:</span>

<span class="sd">            ValueError: if the given argument is not a positive integer.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">not</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">replicas</span><span class="p">,</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">))</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">replicas</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="s2">&quot;Replica count must be a positive integer.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">replicas</span><span class="p">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;The current maximum of parallel executors is 8.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">_replicas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">replicas</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_metric</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Adds a metric that will be automatically used as a pipeline output.</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Name of the metric.</span>

<span class="sd">            desc (str): Description of the metric. (optional)</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="s2">&quot;_&quot;</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">name</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;The metric name must contain at least one underscore&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Metric &#39;{name}&#39; already exists&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">desc</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;desc&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">desc</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">delete_metric</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Remove a previously added metric.</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Name of the metric to be deleted.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Component &#39;{self.name}&#39; has no metric &#39;{name}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">        </span><span class="n">component_dict</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="o">**</span><span class="n">super</span><span class="p">()</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(),</span>

<span class="w">            </span><span class="s1">&#39;version&#39;</span><span class="p">:</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;entrypoint&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;./{self.entrypoint.name}&quot;</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;hwType&#39;</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;CPU&#39;</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;runtime&#39;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>

<span class="w">                </span><span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;python&#39;</span><span class="p">,</span>

<span class="w">                </span><span class="s1">&#39;version&#39;</span><span class="p">:</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">python_version</span>

<span class="w">            </span><span class="p">},</span>

<span class="w">            </span><span class="s1">&#39;replicas&#39;</span><span class="p">:</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_replicas</span>

<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">component_dict</span><span class="p">[</span><span class="s2">&quot;outputType&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">[{</span>

<span class="w">            </span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">name</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;String&#39;</span><span class="p">,</span>

<span class="w">            </span><span class="s1">&#39;metric&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">True</span><span class="p">,</span>

<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">component_dict</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">enable_dependency_optimization</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Allows changing repository URLs to optimize the package size</span>

<span class="sd">        Allows the replacement of the `--index-url` argument during `pip download` to download</span>

<span class="sd">        CPU runtime optimized dependencies only. Enabling this optimization, the present</span>

<span class="sd">        `--index-url` will be prepended to the `--extra-index-url` list, and the Pytorch CPU only repository</span>

<span class="sd">        will be set as the `--index-url`.</span>

<span class="sd">        A warning message will be printed if the repository URL modification was necessary.</span>

<span class="sd">        Some dependencies have both CPU and GPU runtime</span>

<span class="sd">        versions, pytorch for example, but a `PythonComponent` can only run on CPU, so</span>

<span class="sd">        packaging the additional GPU runtime dependencies just enlarges the package size.</span>

<span class="sd">        If you want to run your model on GPU, convert it to an `ONNX` model and use it within a</span>

<span class="sd">        `GPURuntimeComponent`.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span><span class="o">.</span><span class="n">enable_dependency_optimization</span><span class="p">()</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">disable_dependency_optimization</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Disables any modification to repository URLs</span>

<span class="sd">        Disables the replacement of the `--index-url` argument during `pip download`.</span>

<span class="sd">        This way all `--index-url` or `--extra-index-url` arguments will be preserved if they</span>

<span class="sd">        were present in the requirements.txt file.</span>

<span class="sd">        Some dependencies have both CPU and GPU runtime</span>

<span class="sd">        versions, pytorch for example, but a `PythonComponent` can only run on CPU, so</span>

<span class="sd">        packaging the additional GPU runtime dependencies just enlarges the package size.</span>

<span class="sd">        A warning message will be printed about the package size if this optimization is disabled and</span>

<span class="sd">        the dependency list contains GPU optimized dependencies.</span>

<span class="sd">        Disabling this optimization will not allow the component to run on GPU.</span>

<span class="sd">        If you want to run your model on GPU, convert it to an `ONNX` model and use it within a</span>

<span class="sd">        `GPURuntimeComponent`.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span><span class="o">.</span><span class="n">disable_dependency_optimization</span><span class="p">()</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Validates that the component is ready to be serialized and packaged as part of a pipeline.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="p">:</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">                </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;Entrypoint must be defined&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">any</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">items</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">key</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="p">):</span>

<span class="w">                </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="s2">&quot;Entrypoint must be added as resource to the root directory before setting up as entrypoint.&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span><span class="o">.</span><span class="n">dependencies</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span>

<span class="w">                </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;WARNING! There are no dependencies defined for component &#39;{self.name}&#39;. Please make sure that all necessary dependencies have been added.&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">True</span>

<span class="w">        </span><span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Component &#39;{self.name}&#39; is valid and ready to use.&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">destination</span><span class="p">,</span><span class="w"> </span><span class="n">validate</span><span class="o">=</span><span class="n">True</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Saves the component to a folder structure, so it can be used as part of a pipeline configuration package.</span>

<span class="sd">        Validation can be skipped by setting parameter `validate` to False.</span>

<span class="sd">        This is useful when the component is already validated and only intended to be saved.</span>

<span class="sd">        The component folder contains the following:</span>

<span class="sd">        - `requirements.txt` with a list of Python dependencies</span>

<span class="sd">        - Entry point script defined by the `entrypoint` attribute of the component</span>

<span class="sd">        - Extra files as added to the specified folders</span>

<span class="sd">        - `PythonPackages.zip` with the wheel binaries for the environment to be installed</span>

<span class="sd">        Args:</span>

<span class="sd">            destination (path-like): Target directory to which the component will be saved.</span>

<span class="sd">            validate (bool): With value True, triggers component validation. Defaults to True.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">validate</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>

<span class="w">        </span><span class="n">folder_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">name</span>

<span class="w">        </span><span class="n">folder_path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="n">True</span><span class="p">,</span><span class="w"> </span><span class="n">exist_ok</span><span class="o">=</span><span class="n">True</span><span class="p">)</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">file_path</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="p">:</span>

<span class="w">            </span><span class="n">dir_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">folder_path</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="p">[</span><span class="n">file_path</span><span class="p">]</span>

<span class="w">            </span><span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span><span class="w"> </span><span class="n">exist_ok</span><span class="o">=</span><span class="n">True</span><span class="p">)</span>

<span class="w">            </span><span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span><span class="w"> </span><span class="n">dir_path</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">file_path</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">python_dependencies</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">folder_path</span><span class="p">)</span>
</code></pre></div>

</details>
<hr />
<h4 id="ancestors-in-mro">Ancestors (in MRO)</h4>
<ul>
<li>simaticai.deploy.component.Component</li>
</ul>
<h4 id="class-variables">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">BatchInfo</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">reserved_names</span>
</code></pre></div>

<h4 id="methods">Methods</h4>
<h4 id="add_dependencies">add_dependencies</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_dependencies</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">packages</span><span class="p">:</span> <span class="nb">list</span>
<span class="p">)</span>
</code></pre></div>

<p>Adds required dependencies for the Python code.</p>
<p>The list must contain the name of the Python packages or tuples in the form of (name, version) which are required to execute the component on AI Inference Server.
The method will search for the packages for the target platform and collect their transitive dependencies as well.
Packages that are distributed only in source format can be added too, but only if they are pure Python packages.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>packages</td>
<td>list</td>
<td>Can be a list of strings (name) or a list of tuples (name, version) of the required packages for component execution</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nx">def</span><span class="w"> </span><span class="nx">add_dependencies</span><span class="p">(</span><span class="kp">self</span><span class="p">,</span><span class="w"> </span><span class="nx">packages</span><span class="p">:</span><span class="w"> </span><span class="nx">list</span><span class="p">):</span>

<span class="w">        </span><span class="s">&quot;&quot;&quot;</span>

<span class="s">        Adds required dependencies for the Python code.</span>

<span class="s">        The list must contain the name of the Python packages or tuples in the form of (name, version) which are required to execute the component on AI Inference Server.</span>

<span class="s">        The method will search for the packages for the target platform and collect their transitive dependencies as well.</span>

<span class="s">        Packages that are distributed only in source format can be added too, but only if they are pure Python packages.</span>

<span class="s">        Args:</span>

<span class="s">            packages (list): Can be a list of strings (name) or a list of tuples (name, version) of the required packages for component execution</span>

<span class="s">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="kp">self</span><span class="p">.</span><span class="nx">is_valid</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">False</span>

<span class="w">        </span><span class="kp">self</span><span class="p">.</span><span class="nx">python_dependencies</span><span class="p">.</span><span class="nx">add_dependencies</span><span class="p">(</span><span class="nx">packages</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="add_input">add_input</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_input</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">desc</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

<p>Adds a new input to the component with its type.</p>
<p>Name of the variables cannot be reserved name like 'timestamp'.
Input variable 'timestamp' is a prebuilt key in the payload and its value contains the timestamp when the payload is created by AI Inference Server.</p>
<p>Types supported by AI Inference Server version 1.6 are contained in the <code>type_dictionary</code>. Newer AI Inference server version may support additional types.
In case the type is not known by the AI SDK, a warning message will be printed.
The most frequently used types are
- String:
    Typically used for data received from Databus
- Object:
    Object type variables are designed to receive from Vision Connect or transfer images between components
- Numeric scalar types:
    Typically used for data received from S7 Connector</p>
<p>The example payload below shows the format of image received from VCA Connector</p>
<div class="codehilite"><pre><span></span><code>    <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;image&quot;</span><span class="p">:</span>
        <span class="p">{</span>
            <span class="s2">&quot;resolutionWidth&quot;</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
            <span class="s2">&quot;resolutionHeight&quot;</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
            <span class="s2">&quot;mimeType&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;image/raw&quot;</span><span class="p">],</span>
            <span class="s2">&quot;dataType&quot;</span><span class="p">:</span> <span class="s2">&quot;uint8&quot;</span><span class="p">,</span>
            <span class="s2">&quot;channelsPerPixel&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s2">&quot;image&quot;</span><span class="p">:</span> <span class="n">_swap_bytes</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">tobytes</span><span class="p">())</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div>

<p>Between components the format is the same format as the format of Object as an output.</p>
<div class="codehilite"><pre><span></span><code>    <span class="s2">&quot;processedImage&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span> <span class="p">{</span>
                        <span class="s2">&quot;resolutionWidth&quot;</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
                        <span class="s2">&quot;resolutionHeight&quot;</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">height</span>
                        <span class="p">}</span>
                    <span class="p">),</span>
        <span class="s2">&quot;bytes&quot;</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">tobytes</span><span class="p">()</span>
    <span class="p">}</span>
</code></pre></div>

<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>str</td>
<td>Name of the new input.</td>
<td>None</td>
</tr>
<tr>
<td>_type</td>
<td>str</td>
<td>Type of the new input.</td>
<td>None</td>
</tr>
<tr>
<td>desc</td>
<td>str</td>
<td>Description of the input. (optional)</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">_type</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Adds a new input to the component with its type.</span>

<span class="sd">        Name of the variables cannot be reserved name like &#39;timestamp&#39;.</span>

<span class="sd">        Input variable &#39;timestamp&#39; is a prebuilt key in the payload and its value contains the timestamp when the payload is created by AI Inference Server.</span>

<span class="sd">        Types supported by AI Inference Server version 1.6 are contained in the `type_dictionary`. Newer AI Inference server version may support additional types.</span>

<span class="sd">        In case the type is not known by the AI SDK, a warning message will be printed.</span>

<span class="sd">        The most frequently used types are</span>

<span class="sd">        - String:</span>

<span class="sd">            Typically used for data received from Databus</span>

<span class="sd">        - Object:</span>

<span class="sd">            Object type variables are designed to receive from Vision Connect or transfer images between components</span>

<span class="sd">        - Numeric scalar types:</span>

<span class="sd">            Typically used for data received from S7 Connector</span>

<span class="sd">        The example payload below shows the format of image received from VCA Connector</span>

<span class="sd">        ```python</span>

<span class="sd">            payload = { &quot;image&quot;:</span>

<span class="sd">                {</span>

<span class="sd">                    &quot;resolutionWidth&quot;: image.width,</span>

<span class="sd">                    &quot;resolutionHeight&quot;: image.height,</span>

<span class="sd">                    &quot;mimeType&quot;: [&quot;image/raw&quot;],</span>

<span class="sd">                    &quot;dataType&quot;: &quot;uint8&quot;,</span>

<span class="sd">                    &quot;channelsPerPixel&quot;: 3,</span>

<span class="sd">                    &quot;image&quot;: _swap_bytes(image.tobytes())</span>

<span class="sd">                }</span>

<span class="sd">            }</span>

<span class="sd">        ```</span>

<span class="sd">        Between components the format is the same format as the format of Object as an output.</span>

<span class="sd">        ```python</span>

<span class="sd">            &quot;processedImage&quot;: {</span>

<span class="sd">                &quot;metadata&quot;: json.dumps( {</span>

<span class="sd">                                &quot;resolutionWidth&quot;: image.width,</span>

<span class="sd">                                &quot;resolutionHeight&quot;: image.height</span>

<span class="sd">                                }</span>

<span class="sd">                            ),</span>

<span class="sd">                &quot;bytes&quot;: image.tobytes()</span>

<span class="sd">            }</span>

<span class="sd">        ```</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Name of the new input.</span>

<span class="sd">            _type (str): Type of the new input.</span>

<span class="sd">            desc (str): Description of the input. (optional)</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Input &#39;{name}&#39; already exists.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">reserved_names</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Input &#39;{name}&#39; is a reserved keyword.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">_type</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">supported_types</span><span class="p">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;WARNING! Unknown type &#39;{_type}&#39; for input variable &#39;{name}&#39;. Please check if the target Inference Server supports this type.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">_type</span><span class="p">,</span>

<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">desc</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;desc&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">desc</span>
</code></pre></div>

</details>
<h4 id="add_metric">add_metric</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_metric</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">desc</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

<p>Adds a metric that will be automatically used as a pipeline output.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>str</td>
<td>Name of the metric.</td>
<td>None</td>
</tr>
<tr>
<td>desc</td>
<td>str</td>
<td>Description of the metric. (optional)</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_metric</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="k">desc</span><span class="err">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">str</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Adds a metric that will be automatically used as a pipeline output.</span>

<span class="ss">        Args:</span>

<span class="ss">            name (str): Name of the metric.</span>

<span class="ss">            desc (str): Description of the metric. (optional)</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ss">&quot;_&quot;</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">name</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="ss">&quot;The metric name must contain at least one underscore&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">metrics</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">metrics</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">metrics</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;Metric &#39;{name}&#39; already exists&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">metrics</span><span class="o">[</span><span class="n">name</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="k">desc</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">metrics</span><span class="o">[</span><span class="n">name</span><span class="o">][</span><span class="n">&#39;desc&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">desc</span>
</code></pre></div>

</details>
<h4 id="add_output">add_output</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_output</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">desc</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

<p>Adds a new output to the component.</p>
<p>Types supported by AI Inference Server version 1.6 are contained in the <code>type_dictionary</code>. Newer AI Inference server version may support additional types.
In case the type is not known by the AI SDK, a warning message will be printed.
The most frequently used types are
- String:
    Typically used for data to be sent to Databus
- Object:
    Typically used for images to be sent to ZMQ Connector
- Numeric scalar types:
    Typically used for data sent to S7 Connector</p>
<p>For outputs of type <code>Object</code> the entrypoint must return with a <code>dictionary</code> containing two fields, where one field has type <code>str</code> and the other field has type <code>bytes</code>.
The example below shows the required format, assuming that 'image' is a PIL Image.</p>
<div class="codehilite"><pre><span></span><code>    <span class="s2">&quot;processedImage&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span> <span class="p">{</span>
                        <span class="s2">&quot;resolutionWidth&quot;</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
                        <span class="s2">&quot;resolutionHeight&quot;</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">height</span>
                        <span class="p">}</span>
                    <span class="p">),</span>
        <span class="s2">&quot;bytes&quot;</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">tobytes</span><span class="p">()</span>
    <span class="p">}</span>
</code></pre></div>

<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>str</td>
<td>Name of the new output.</td>
<td>None</td>
</tr>
<tr>
<td>_type</td>
<td>str</td>
<td>Type of the new output.</td>
<td>None</td>
</tr>
<tr>
<td>desc</td>
<td>str</td>
<td>Description of the output. (optional)</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">_type</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Adds a new output to the component.</span>

<span class="sd">        Types supported by AI Inference Server version 1.6 are contained in the `type_dictionary`. Newer AI Inference server version may support additional types.</span>

<span class="sd">        In case the type is not known by the AI SDK, a warning message will be printed.</span>

<span class="sd">        The most frequently used types are</span>

<span class="sd">        - String:</span>

<span class="sd">            Typically used for data to be sent to Databus</span>

<span class="sd">        - Object:</span>

<span class="sd">            Typically used for images to be sent to ZMQ Connector</span>

<span class="sd">        - Numeric scalar types:</span>

<span class="sd">            Typically used for data sent to S7 Connector</span>

<span class="sd">        For outputs of type `Object` the entrypoint must return with a `dictionary` containing two fields, where one field has type `str` and the other field has type `bytes`.</span>

<span class="sd">        The example below shows the required format, assuming that &#39;image&#39; is a PIL Image.</span>

<span class="sd">        ```python</span>

<span class="sd">            &quot;processedImage&quot;: {</span>

<span class="sd">                &quot;metadata&quot;: json.dumps( {</span>

<span class="sd">                                &quot;resolutionWidth&quot;: image.width,</span>

<span class="sd">                                &quot;resolutionHeight&quot;: image.height</span>

<span class="sd">                                }</span>

<span class="sd">                            ),</span>

<span class="sd">                &quot;bytes&quot;: image.tobytes()</span>

<span class="sd">            }</span>

<span class="sd">        ```</span>

<span class="sd">        Args:</span>

<span class="sd">            name (str): Name of the new output.</span>

<span class="sd">            _type (str): Type of the new output.</span>

<span class="sd">            desc (str): Description of the output. (optional)</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Output &#39;{name}&#39; already exists&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">reserved_names</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Output &#39;{name}&#39; is a reserved keyword.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">_type</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">supported_types</span><span class="p">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;WARNING! Unknown type &#39;{_type}&#39; for input variable &#39;{name}&#39;. Please check if the target Inference Server supports this type.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">_type</span><span class="p">,</span>

<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">desc</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;desc&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">desc</span>
</code></pre></div>

</details>
<h4 id="add_python_packages">add_python_packages</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_python_packages</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>Adds Python package(s) to the <code>PythonPackages.zip</code> file of the component.</p>
<p>The <code>path</code> parameter can refer to either a <code>whl</code>, a <code>zip</code> or a <code>tar.gz</code> file.
Zip files can be either a source distribution package or a collection of Python packages. Only pure Python source distributions are allowed.
The dependency list of the component will be extended with the files added here, so that they will also get installed on the AI Inference Server.
The method uses the <code>tempfile.tempdir</code> folder, so make sure that the folder is writeable.</p>
<p>The wheel files must fulfill the requirements of the targeted device environment
(e.g., the Python version must match the supported Python version of the targeted AI Inference Server, and the platform should be one of the supported ones too).</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>path</td>
<td>str</td>
<td>Path of the distribution file</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_python_packages</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">path</span><span class="o">:</span><span class="w"> </span><span class="n">str</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="o">:</span>

<span class="w">        </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span>

<span class="s2">        Adds Python package(s) to the `PythonPackages.zip` file of the component.</span>

<span class="s2">        The `path` parameter can refer to either a `whl`, a `zip` or a `tar.gz` file.</span>

<span class="s2">        Zip files can be either a source distribution package or a collection of Python packages. Only pure Python source distributions are allowed.</span>

<span class="s2">        The dependency list of the component will be extended with the files added here, so that they will also get installed on the AI Inference Server.</span>

<span class="s2">        The method uses the `tempfile.tempdir` folder, so make sure that the folder is writeable.</span>

<span class="s2">        The wheel files must fulfill the requirements of the targeted device environment</span>

<span class="s2">        (e.g., the Python version must match the supported Python version of the targeted AI Inference Server, and the platform should be one of the supported ones too).</span>

<span class="s2">        Args:</span>

<span class="s2">            path (str): Path of the distribution file</span>

<span class="s2">        Examples:</span>

<span class="s2">            `component.add_python_packages(&#39;../resources/my_package-0.0.1-py3-none-any.wheel&#39;)`</span>

<span class="s2">                adds the wheel file to `PythonPackages.zip` and adds dictionary item `component.dependencies[&#39;my_package&#39;] = &#39;0.0.1&#39;`</span>

<span class="s2">            `component.add_python_packages(&#39;../resources/inference-wheels.zip&#39;)`</span>

<span class="s2">                adds all the wheel files in the zip to `PythonPackages.zip` and `component.dependencies`</span>

<span class="s2">        </span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">False</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">python_dependencies</span><span class="p">.</span><span class="n">add_python_packages</span><span class="p">(</span><span class="k">path</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="add_resources">add_resources</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_resources</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">base_dir</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">,</span>
    <span class="n">resources</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span>
<span class="p">)</span>
</code></pre></div>

<p>Adds files to a component.</p>
<p>To make your file resources available on the AI Inference Server you need to add them to the package resources.
These resources can be Python or config files, serialized ML models or reference data.
They are then available on path {component_root}/{resources} in the runtime environment.
When saving the package they will be copied from {base_dir}/{resources} into the package.
Files in '<strong>pycache</strong>' folders will be excluded.
Until version 2.3.0 of AI SDK hidden files and folders (starting with '.') are also excluded.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>base_dir</td>
<td>path-like</td>
<td>Root folder of your code from which the resources are referred</td>
<td>None</td>
</tr>
<tr>
<td>resources</td>
<td>os.PathLike or List</td>
<td>A single path or list of relative paths to resource files</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_resources</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">base_dir</span><span class="p">:</span><span class="w"> </span><span class="n">os</span><span class="p">.</span><span class="n">PathLike</span><span class="p">,</span><span class="w"> </span><span class="nl">resources</span><span class="p">:</span><span class="w"> </span><span class="ow">Union</span><span class="o">[</span><span class="n">os.PathLike, list</span><span class="o">]</span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Adds files to a component.</span>

<span class="ss">        To make your file resources available on the AI Inference Server you need to add them to the package resources.</span>

<span class="ss">        These resources can be Python or config files, serialized ML models or reference data.</span>

<span class="ss">        They are then available on path {component_root}/{resources} in the runtime environment.</span>

<span class="ss">        When saving the package they will be copied from {base_dir}/{resources} into the package.</span>

<span class="ss">        Files in &#39;__pycache__&#39; folders will be excluded.</span>

<span class="ss">        Until version 2.3.0 of AI SDK hidden files and folders (starting with &#39;.&#39;) are also excluded.</span>

<span class="ss">        Args:</span>

<span class="ss">            base_dir (path-like): Root folder of your code from which the resources are referred</span>

<span class="ss">            resources (os.PathLike or List): A single path or list of relative paths to resource files</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">False</span>

<span class="w">        </span><span class="n">base_dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">Path</span><span class="p">(</span><span class="n">base_dir</span><span class="p">).</span><span class="n">resolve</span><span class="p">().</span><span class="k">absolute</span><span class="p">()</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">base_dir</span><span class="p">.</span><span class="n">is_dir</span><span class="p">()</span><span class="err">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;Parameter &#39;base_dir&#39; must be a directory and available in path {base_dir}.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">resources</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resources</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">type</span><span class="p">(</span><span class="n">resources</span><span class="p">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="o">[</span><span class="n">resources</span><span class="o">]</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">resources</span><span class="p">:</span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">_add_resource</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="w"> </span><span class="n">resource</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="change_input">change_input</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">change_input</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">desc</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

<p>Changes one of the inputs of the component.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>str</td>
<td>Name of the input to be changed.</td>
<td>None</td>
</tr>
<tr>
<td>_type</td>
<td>str</td>
<td>New type of the input.</td>
<td>None</td>
</tr>
<tr>
<td>desc</td>
<td>str</td>
<td>Description of the input. (optional)</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">change_input</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="nl">_type</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="k">desc</span><span class="err">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">str</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Changes one of the inputs of the component.</span>

<span class="ss">        Args:</span>

<span class="ss">            name (str): Name of the input to be changed.</span>

<span class="ss">            _type (str): New type of the input.</span>

<span class="ss">            desc (str): Description of the input. (optional)</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">inputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;There is no input with name &#39;{name}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">_type</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">supported_types</span><span class="p">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="p">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;WARNING! Unknown type &#39;{_type}&#39; for input variable &#39;{name}&#39;. Please check if the target Inference Server supports this type.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">inputs</span><span class="o">[</span><span class="n">name</span><span class="o">][</span><span class="n">&#39;type&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_type</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="k">desc</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">inputs</span><span class="o">[</span><span class="n">name</span><span class="o">][</span><span class="n">&#39;desc&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">desc</span>
</code></pre></div>

</details>
<h4 id="change_output">change_output</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">change_output</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">desc</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

<p>Changes one of the outputs of the component.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>str</td>
<td>Name of the output to be changed.</td>
<td>None</td>
</tr>
<tr>
<td>_type</td>
<td>str</td>
<td>The new type of the output.</td>
<td>None</td>
</tr>
<tr>
<td>desc</td>
<td>str</td>
<td>Description of the output. (optional)</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">change_output</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="nl">_type</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="k">desc</span><span class="err">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">str</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Changes one of the outputs of the component.</span>

<span class="ss">        Args:</span>

<span class="ss">            name (str): Name of the output to be changed.</span>

<span class="ss">            _type (str): The new type of the output.</span>

<span class="ss">            desc (str): Description of the output. (optional)</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">AssertionError</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;There is no output with name &#39;{name}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">_type</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">supported_types</span><span class="p">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="p">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;WARNING! Unknown type &#39;{_type}&#39; for input variable &#39;{name}&#39;. Please check if the target Inference Server supports this type.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">outputs</span><span class="o">[</span><span class="n">name</span><span class="o">][</span><span class="n">&#39;type&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_type</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="k">desc</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">inputs</span><span class="o">[</span><span class="n">name</span><span class="o">][</span><span class="n">&#39;desc&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">desc</span>
</code></pre></div>

</details>
<h4 id="delete_input">delete_input</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete_input</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span>
</code></pre></div>

<p>Deletes an input from the component by name.</p>
<p>Once the package has been created with the given component, it is recommended not to change the component directly.
Instead, all necessary methods to change it are available through the package to avoid component inconsistencies.
It is recommended to use <code>package.delete_input_wire(...)</code> with default parameter <code>with_input=True</code>.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>str</td>
<td>Name of the input to be deleted.</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nx">def</span><span class="w"> </span><span class="nx">delete_input</span><span class="p">(</span><span class="kp">self</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="p">:</span><span class="w"> </span><span class="nx">str</span><span class="p">):</span>

<span class="w">        </span><span class="s">&quot;&quot;&quot;</span>

<span class="s">        Deletes an input from the component by name.</span>

<span class="s">        Once the package has been created with the given component, it is recommended not to change the component directly.</span>

<span class="s">        Instead, all necessary methods to change it are available through the package to avoid component inconsistencies.</span>

<span class="s">        It is recommended to use `package.delete_input_wire(...)` with default parameter `with_input=True`.</span>

<span class="s">        Args:</span>

<span class="s">            name (str): Name of the input to be deleted.</span>

<span class="s">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="kp">self</span><span class="p">.</span><span class="nx">inputs</span><span class="p">:</span>

<span class="w">            </span><span class="nx">raise</span><span class="w"> </span><span class="nx">AssertionError</span><span class="p">(</span><span class="nx">f</span><span class="s">&quot;Component &#39;{self.name}&#39; has no input &#39;{name}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="kp">self</span><span class="p">.</span><span class="nx">inputs</span><span class="p">.</span><span class="nx">pop</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="delete_metric">delete_metric</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete_metric</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span>
</code></pre></div>

<p>Remove a previously added metric.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>str</td>
<td>Name of the metric to be deleted.</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code>    def delete_metric(self, name: str):

        &quot;&quot;&quot;

        Remove a previously added metric.

        Args:

            name (str): Name of the metric to be deleted.

        &quot;&quot;&quot;

        if name not in self.metrics:

            raise AssertionError(f&quot;Component &#39;{self.name}&#39; has no metric &#39;{name}&#39;&quot;)

        self.metrics.pop(name)
</code></pre></div>

</details>
<h4 id="delete_output">delete_output</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete_output</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span>
</code></pre></div>

<p>Deletes an output from the component by name.</p>
<p>Once the package has been created with the given component, it is recommended not to change the component directly.
Instead, all necessary methods to change it are available through the package to avoid component inconsistencies.
Deleting an output which is represented in any wire will cause package inconsistency.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>str</td>
<td>Name of the output to be deleted.</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nx">def</span><span class="w"> </span><span class="nx">delete_output</span><span class="p">(</span><span class="kp">self</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="p">:</span><span class="w"> </span><span class="nx">str</span><span class="p">):</span>

<span class="w">        </span><span class="s">&quot;&quot;&quot;</span>

<span class="s">        Deletes an output from the component by name.</span>

<span class="s">        Once the package has been created with the given component, it is recommended not to change the component directly.</span>

<span class="s">        Instead, all necessary methods to change it are available through the package to avoid component inconsistencies.</span>

<span class="s">        Deleting an output which is represented in any wire will cause package inconsistency.</span>

<span class="s">        Args:</span>

<span class="s">            name (str): Name of the output to be deleted.</span>

<span class="s">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="kp">self</span><span class="p">.</span><span class="nx">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="nx">raise</span><span class="w"> </span><span class="nx">AssertionError</span><span class="p">(</span><span class="nx">f</span><span class="s">&quot;Component &#39;{self.name}&#39; has no output &#39;{name}&#39;&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="kp">self</span><span class="p">.</span><span class="nx">outputs</span><span class="p">.</span><span class="nx">pop</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="disable_dependency_optimization">disable_dependency_optimization</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">disable_dependency_optimization</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<p>Disables any modification to repository URLs</p>
<p>Disables the replacement of the <code>--index-url</code> argument during <code>pip download</code>.
This way all <code>--index-url</code> or <code>--extra-index-url</code> arguments will be preserved if they
were present in the requirements.txt file.
Some dependencies have both CPU and GPU runtime
versions, pytorch for example, but a <code>PythonComponent</code> can only run on CPU, so
packaging the additional GPU runtime dependencies just enlarges the package size.
A warning message will be printed about the package size if this optimization is disabled and
the dependency list contains GPU optimized dependencies.
Disabling this optimization will not allow the component to run on GPU.
If you want to run your model on GPU, convert it to an <code>ONNX</code> model and use it within a
<code>GPURuntimeComponent</code>.</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">disable_dependency_optimization</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">:</span>

<span class="w">        </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span>

<span class="s2">        Disables any modification to repository URLs</span>

<span class="s2">        Disables the replacement of the `--index-url` argument during `pip download`.</span>

<span class="s2">        This way all `--index-url` or `--extra-index-url` arguments will be preserved if they</span>

<span class="s2">        were present in the requirements.txt file.</span>

<span class="s2">        Some dependencies have both CPU and GPU runtime</span>

<span class="s2">        versions, pytorch for example, but a `PythonComponent` can only run on CPU, so</span>

<span class="s2">        packaging the additional GPU runtime dependencies just enlarges the package size.</span>

<span class="s2">        A warning message will be printed about the package size if this optimization is disabled and</span>

<span class="s2">        the dependency list contains GPU optimized dependencies.</span>

<span class="s2">        Disabling this optimization will not allow the component to run on GPU.</span>

<span class="s2">        If you want to run your model on GPU, convert it to an `ONNX` model and use it within a</span>

<span class="s2">        `GPURuntimeComponent`.</span>

<span class="s2">        </span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">python_dependencies</span><span class="p">.</span><span class="n">disable_dependency_optimization</span><span class="p">()</span>
</code></pre></div>

</details>
<h4 id="enable_dependency_optimization">enable_dependency_optimization</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">enable_dependency_optimization</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<p>Allows changing repository URLs to optimize the package size</p>
<p>Allows the replacement of the <code>--index-url</code> argument during <code>pip download</code> to download
CPU runtime optimized dependencies only. Enabling this optimization, the present
<code>--index-url</code> will be prepended to the <code>--extra-index-url</code> list, and the Pytorch CPU only repository
will be set as the <code>--index-url</code>.
A warning message will be printed if the repository URL modification was necessary.
Some dependencies have both CPU and GPU runtime
versions, pytorch for example, but a <code>PythonComponent</code> can only run on CPU, so
packaging the additional GPU runtime dependencies just enlarges the package size.
If you want to run your model on GPU, convert it to an <code>ONNX</code> model and use it within a
<code>GPURuntimeComponent</code>.</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">enable_dependency_optimization</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">:</span>

<span class="w">        </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span>

<span class="s2">        Allows changing repository URLs to optimize the package size</span>

<span class="s2">        Allows the replacement of the `--index-url` argument during `pip download` to download</span>

<span class="s2">        CPU runtime optimized dependencies only. Enabling this optimization, the present</span>

<span class="s2">        `--index-url` will be prepended to the `--extra-index-url` list, and the Pytorch CPU only repository</span>

<span class="s2">        will be set as the `--index-url`.</span>

<span class="s2">        A warning message will be printed if the repository URL modification was necessary.</span>

<span class="s2">        Some dependencies have both CPU and GPU runtime</span>

<span class="s2">        versions, pytorch for example, but a `PythonComponent` can only run on CPU, so</span>

<span class="s2">        packaging the additional GPU runtime dependencies just enlarges the package size.</span>

<span class="s2">        If you want to run your model on GPU, convert it to an `ONNX` model and use it within a</span>

<span class="s2">        `GPURuntimeComponent`.</span>

<span class="s2">        </span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">python_dependencies</span><span class="p">.</span><span class="n">enable_dependency_optimization</span><span class="p">()</span>
</code></pre></div>

</details>
<h4 id="save">save</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">destination</span><span class="p">,</span>
    <span class="n">validate</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</code></pre></div>

<p>Saves the component to a folder structure, so it can be used as part of a pipeline configuration package.</p>
<p>Validation can be skipped by setting parameter <code>validate</code> to False.
This is useful when the component is already validated and only intended to be saved.</p>
<p>The component folder contains the following:</p>
<ul>
<li><code>requirements.txt</code> with a list of Python dependencies</li>
<li>Entry point script defined by the <code>entrypoint</code> attribute of the component</li>
<li>Extra files as added to the specified folders</li>
<li><code>PythonPackages.zip</code> with the wheel binaries for the environment to be installed</li>
</ul>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>destination</td>
<td>path-like</td>
<td>Target directory to which the component will be saved.</td>
<td>None</td>
</tr>
<tr>
<td>validate</td>
<td>bool</td>
<td>With value True, triggers component validation. Defaults to True.</td>
<td>True</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">save</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">destination</span><span class="p">,</span><span class="w"> </span><span class="n">validate</span><span class="o">=</span><span class="no">True</span><span class="p">)</span><span class="o">:</span>

<span class="w">        </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span>

<span class="s2">        Saves the component to a folder structure, so it can be used as part of a pipeline configuration package.</span>

<span class="s2">        Validation can be skipped by setting parameter `validate` to False.</span>

<span class="s2">        This is useful when the component is already validated and only intended to be saved.</span>

<span class="s2">        The component folder contains the following:</span>

<span class="s2">        - `requirements.txt` with a list of Python dependencies</span>

<span class="s2">        - Entry point script defined by the `entrypoint` attribute of the component</span>

<span class="s2">        - Extra files as added to the specified folders</span>

<span class="s2">        - `PythonPackages.zip` with the wheel binaries for the environment to be installed</span>

<span class="s2">        Args:</span>

<span class="s2">            destination (path-like): Target directory to which the component will be saved.</span>

<span class="s2">            validate (bool): With value True, triggers component validation. Defaults to True.</span>

<span class="s2">        </span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">validate</span><span class="p">()</span>

<span class="w">        </span><span class="n">folder_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">Path</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="k">name</span>

<span class="w">        </span><span class="n">folder_path</span><span class="p">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="no">True</span><span class="p">,</span><span class="w"> </span><span class="n">exist_ok</span><span class="o">=</span><span class="no">True</span><span class="p">)</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">file_path</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">resources</span><span class="o">:</span>

<span class="w">            </span><span class="n">dir_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">folder_path</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">resources</span><span class="err">[</span><span class="n">file_path</span><span class="err">]</span>

<span class="w">            </span><span class="n">os</span><span class="p">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span><span class="w"> </span><span class="n">exist_ok</span><span class="o">=</span><span class="no">True</span><span class="p">)</span>

<span class="w">            </span><span class="n">shutil</span><span class="p">.</span><span class="n">copy</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span><span class="w"> </span><span class="n">dir_path</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">file_path</span><span class="p">.</span><span class="k">name</span><span class="p">)</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">python_dependencies</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="n">folder_path</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="set_entrypoint">set_entrypoint</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_entrypoint</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">entrypoint</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span>
</code></pre></div>

<p>Sets the entrypoint module for the component.</p>
<p>The entrypoint is the Python code which is responsible for receiving the input data and producing a structured response with the output for the AI Inference Server.
The script should consume a JSON string and produce another. See the short example below.</p>
<p>The file will be copied into the root directory of the component on the AI Inference Server, so every file reference should be aligned.</p>
<p>The example code below shows a basic structure of the entrypoint Python code.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="c1"># by adding the parent folder of your modules to system path makes them available for relative import</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;./src&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()))</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">my_module</span><span class="w"> </span><span class="kn">import</span> <span class="n">processor</span>  <span class="c1"># then the processor module can be imported</span>

<span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="n">input_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>  <span class="c1"># incoming JSON string is loaded as a dictionary</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">processor</span><span class="o">.</span><span class="n">process_data</span><span class="p">(</span><span class="n">input_data</span><span class="p">)</span>  <span class="c1"># the process_data can be called to process the incoming data</span>

    <span class="c1"># the code below creates the formatted output for the AI Inference Server</span>
    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">answer</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ready&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;output&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">answer</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ready&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;output&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">result</span><span class="p">)}</span>

    <span class="k">return</span> <span class="n">answer</span>
</code></pre></div>

<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>entrypoint</td>
<td>str</td>
<td>Name of the new entrypoint script to be copied</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code>    <span class="k">def</span><span class="w"> </span><span class="nf">set_entrypoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entrypoint</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Sets the entrypoint module for the component.</span>

<span class="sd">        The entrypoint is the Python code which is responsible for receiving the input data and producing a structured response with the output for the AI Inference Server.</span>

<span class="sd">        The script should consume a JSON string and produce another. See the short example below.</span>

<span class="sd">        The file will be copied into the root directory of the component on the AI Inference Server, so every file reference should be aligned.</span>

<span class="sd">        The example code below shows a basic structure of the entrypoint Python code.</span>

<span class="sd">        ```python</span>

<span class="sd">        import json</span>

<span class="sd">        import sys</span>

<span class="sd">        from pathlib import Path</span>

<span class="sd">        # by adding the parent folder of your modules to system path makes them available for relative import</span>

<span class="sd">        sys.path.insert(0, str(Path(&#39;./src&#39;).resolve()))</span>

<span class="sd">        from my_module import processor  # then the processor module can be imported</span>

<span class="sd">        def run(data: str):</span>

<span class="sd">            input_data = json.loads(data)  # incoming JSON string is loaded as a dictionary</span>

<span class="sd">            result = processor.process_data(input_data)  # the process_data can be called to process the incoming data</span>

<span class="sd">            # the code below creates the formatted output for the AI Inference Server</span>

<span class="sd">            if result is None:</span>

<span class="sd">                answer = {&quot;ready&quot;: False, &quot;output&quot;: None}</span>

<span class="sd">            else:</span>

<span class="sd">                answer = {&quot;ready&quot;: True, &quot;output&quot;: json.dumps(result)}</span>

<span class="sd">            return answer</span>

<span class="sd">        ```</span>

<span class="sd">        Args:</span>

<span class="sd">            entrypoint (str): Name of the new entrypoint script to be copied</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">entrypoint</span> <span class="ow">and</span> <span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;.&#39;</span><span class="p">):</span>

            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;Entrypoint must be added as resource to the root directory before setting up as entrypoint.&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">entrypoint</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="set_parallel_steps">set_parallel_steps</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_parallel_steps</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">replicas</span>
<span class="p">)</span>
</code></pre></div>

<p>Sets the number of parallel executors.</p>
<p>This method configures how many instances of the component can be
executed at the same time.
The component must be suitable for parallel execution. The inputs arriving
to the component will be processed by different instances in parallel,
and these instances do not share their state (e.g. variables). Every
instance is initialized separately and receives only a fraction of the inputs.
AI Inference Server supports at most 8 parallel instances.```</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>replicas</td>
<td>int</td>
<td>Number of parallel executors. Default is 1.</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Raises:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>ValueError</td>
<td>if the given argument is not a positive integer.</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">set_parallel_steps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">replicas</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Sets the number of parallel executors.</span>

<span class="sd">        This method configures how many instances of the component can be</span>

<span class="sd">        executed at the same time.</span>

<span class="sd">        The component must be suitable for parallel execution. The inputs arriving</span>

<span class="sd">        to the component will be processed by different instances in parallel,</span>

<span class="sd">        and these instances do not share their state (e.g. variables). Every</span>

<span class="sd">        instance is initialized separately and receives only a fraction of the inputs.</span>

<span class="sd">        AI Inference Server supports at most 8 parallel instances.```</span>

<span class="sd">        Args:</span>

<span class="sd">            replicas (int): Number of parallel executors. Default is 1.</span>

<span class="sd">        Raises:</span>

<span class="sd">            ValueError: if the given argument is not a positive integer.</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">not</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">replicas</span><span class="p">,</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">))</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">replicas</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="s2">&quot;Replica count must be a positive integer.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">replicas</span><span class="p">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;The current maximum of parallel executors is 8.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">_replicas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">replicas</span>
</code></pre></div>

</details>
<h4 id="set_pyproject_toml">set_pyproject_toml</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_pyproject_toml</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">pyproject_path</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span>
<span class="p">)</span>
</code></pre></div>

<p>Reads the defined dependencies from the given <code>pyproject.toml</code> file and adds it to the requirements list.</p>
<p>Only the dependencies defined in the <code>[project]</code> section will be added to the component.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>pyproject_path</td>
<td>str</td>
<td>Path of the given <code>pyproject.toml</code> file</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">set_pyproject_toml</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">pyproject_path</span><span class="p">:</span><span class="w"> </span><span class="n">os</span><span class="p">.</span><span class="n">PathLike</span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Reads the defined dependencies from the given `pyproject.toml` file and adds it to the requirements list.</span>

<span class="ss">        Only the dependencies defined in the `[project]` section will be added to the component.</span>

<span class="ss">        Args:</span>

<span class="ss">            pyproject_path (str): Path of the given `pyproject.toml` file</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">False</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">python_dependencies</span><span class="p">.</span><span class="n">set_pyproject_toml</span><span class="p">(</span><span class="n">pyproject_path</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="set_requirements">set_requirements</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_requirements</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">requirements_path</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span>
<span class="p">)</span>
</code></pre></div>

<p>Reads the defined dependencies from the given <code>requirements.txt</code> file and creates a new dependency list. Previously added dependencies will be cleared.</p>
<p>The file format must follow Python's requirements file format defined in PEP 508.
It can contain URLs to additional repositories in the form of <code>--extra-index-url=my.repo.example.com</code>.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>requirements_path</td>
<td>str</td>
<td>Path of the given <code>requirements.txt</code> file</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code>    def set_requirements(self, requirements_path: os.PathLike):

        &quot;&quot;&quot;

        Reads the defined dependencies from the given <span class="sb">`requirements.txt`</span> file and creates a new dependency list. Previously added dependencies will be cleared.

        The file format must follow Python&#39;s requirements file format defined in PEP 508.

        It can contain URLs to additional repositories in the form of <span class="sb">`--extra-index-url=my.repo.example.com`</span>.

        Args:

            requirements_path (str): Path of the given <span class="sb">`requirements.txt`</span> file

        &quot;&quot;&quot;

        self.is_valid = False

        self.python_dependencies.set_requirements(requirements_path)
</code></pre></div>

</details>
<h4 id="validate">validate</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<p>Validates that the component is ready to be serialized and packaged as part of a pipeline.</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nx">def</span><span class="w"> </span><span class="nx">validate</span><span class="p">(</span><span class="kp">self</span><span class="p">):</span>

<span class="w">        </span><span class="s">&quot;&quot;&quot;</span>

<span class="s">        Validates that the component is ready to be serialized and packaged as part of a pipeline.</span>

<span class="s">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="kp">self</span><span class="p">.</span><span class="nx">is_valid</span><span class="p">:</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="kp">self</span><span class="p">.</span><span class="nx">entrypoint</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">None</span><span class="p">:</span>

<span class="w">                </span><span class="nx">raise</span><span class="w"> </span><span class="nx">AssertionError</span><span class="p">(</span><span class="s">&quot;Entrypoint must be defined&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="nx">any</span><span class="p">(</span><span class="nx">key</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">key</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="kp">self</span><span class="p">.</span><span class="nx">resources</span><span class="p">.</span><span class="nx">items</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nx">key</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kp">self</span><span class="p">.</span><span class="nx">entrypoint</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;.&#39;</span><span class="p">):</span>

<span class="w">                </span><span class="nx">raise</span><span class="w"> </span><span class="nx">AssertionError</span><span class="p">(</span><span class="s">&quot;Entrypoint must be added as resource to the root directory before setting up as entrypoint.&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="nx">len</span><span class="p">(</span><span class="kp">self</span><span class="p">.</span><span class="nx">python_dependencies</span><span class="p">.</span><span class="nx">dependencies</span><span class="p">)</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span>

<span class="w">                </span><span class="nx">_logger</span><span class="p">.</span><span class="nx">warning</span><span class="p">(</span><span class="nx">f</span><span class="s">&quot;WARNING! There are no dependencies defined for component &#39;{self.name}&#39;. Please make sure that all necessary dependencies have been added.&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="kp">self</span><span class="p">.</span><span class="nx">python_dependencies</span><span class="p">.</span><span class="nx">validate</span><span class="p">()</span>

<span class="w">            </span><span class="kp">self</span><span class="p">.</span><span class="nx">is_valid</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">True</span>

<span class="w">        </span><span class="nx">_logger</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="nx">f</span><span class="s">&quot;Component &#39;{self.name}&#39; is valid and ready to use.&quot;</span><span class="p">)</span>
</code></pre></div>

</details>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="pipeline_page.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Pipeline Page" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Pipeline Page
            </div>
          </div>
        </a>
      
      
        
        <a href="../helpers/index.html" class="md-footer__link md-footer__link--next" aria-label="Next: Index" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Index
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright (C) Siemens AG 2021. All Rights Reserved.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.ecf98df9.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.48f2be22.min.js"></script>
      
    
  </body>
</html>