
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../../favicon.ico">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.5.0">
    
    
      
        <title>Run Component - AI Software Development Kit</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.2e8b5541.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../styles.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#module-simaticaitestingrun_component" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../index.html" title="AI Software Development Kit" class="md-header__button md-logo" aria-label="AI Software Development Kit" data-md-component="logo">
      
  <img src="../../../Sie_logo_white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AI Software Development Kit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Run Component
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../index.html" title="AI Software Development Kit" class="md-nav__button md-logo" aria-label="AI Software Development Kit" data-md-component="logo">
      
  <img src="../../../Sie_logo_white.svg" alt="logo">

    </a>
    AI Software Development Kit
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../index.html" class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../CHANGELOG.html" class="md-nav__link">
        Changelog
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../user_manual.html" class="md-nav__link">
        User Manual
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_1" type="checkbox" id="__nav_4_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_1">
          Log Module
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Log Module" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          Log Module
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../log_module/index.html" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../log_module/mock_logger.html" class="md-nav__link">
        Mock Logger
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4_2">
          Simaticai
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Simaticai" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Simaticai
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../deployment.html" class="md-nav__link">
        Deployment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../model_config_pb2.html" class="md-nav__link">
        Model Config Pb2
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2_4" type="checkbox" id="__nav_4_2_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_2_4">
          Data
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Data" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_2_4">
          <span class="md-nav__icon md-icon"></span>
          Data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../data/index.html" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../data/schemas.html" class="md-nav__link">
        Schemas
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2_5" type="checkbox" id="__nav_4_2_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_2_5">
          Helpers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Helpers" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_2_5">
          <span class="md-nav__icon md-icon"></span>
          Helpers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../helpers/index.html" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../helpers/model_config.html" class="md-nav__link">
        Model Config
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../helpers/pep508.html" class="md-nav__link">
        Pep508
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../helpers/tempfiles.html" class="md-nav__link">
        Tempfiles
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../helpers/yaml_helper.html" class="md-nav__link">
        Yaml Helper
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2_6" type="checkbox" id="__nav_4_2_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_2_6">
          Packaging
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Packaging" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_2_6">
          <span class="md-nav__icon md-icon"></span>
          Packaging
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../packaging/constants.html" class="md-nav__link">
        Constants
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../packaging/index.html" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../packaging/python_dependencies.html" class="md-nav__link">
        Python Dependencies
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../packaging/wheelhouse.html" class="md-nav__link">
        Wheelhouse
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2_7" type="checkbox" id="__nav_4_2_7" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4_2_7">
          Testing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Testing" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_2_7">
          <span class="md-nav__icon md-icon"></span>
          Testing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipeline_runner.html" class="md-nav__link">
        Pipeline Runner
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipeline_validator.html" class="md-nav__link">
        Pipeline Validator
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Run Component
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="run_component.html" class="md-nav__link md-nav__link--active">
        Run Component
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#main" class="md-nav__link">
    main
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#warn_about_unusued_dependencies" class="md-nav__link">
    warn_about_unusued_dependencies
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="run_gpuruntime_component.html" class="md-nav__link">
        Run Gpuruntime Component
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#main" class="md-nav__link">
    main
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#warn_about_unusued_dependencies" class="md-nav__link">
    warn_about_unusued_dependencies
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="module-simaticaitestingrun_component">Module simaticai.testing.run_component</h1>
<p>Utility script for running an <code>entrypoint</code> Python script in a given virtual Python environment.</p>
<p>It is designed to be executed from <code>simaticai.testing.PipelineRunner</code> class.
It consumes input data from a joblib file and produces output data into a joblib file.</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="c1"># Copyright (C) Siemens AG 2021. All Rights Reserved. Confidential.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">Utility script for running an `entrypoint` Python script in a given virtual Python environment.</span>

<span class="sd">It is designed to be executed from `simaticai.testing.PipelineRunner` class.</span>

<span class="sd">It consumes input data from a joblib file and produces output data into a joblib file.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">joblib</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">argparse</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">importlib</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">importlib.metadata</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">inspect</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span><span class="w"> </span><span class="n">Path</span>

<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">()</span>

<span class="n">_logger</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">_logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">warn_about_unusued_dependencies</span><span class="p">(</span><span class="n">requirements_list</span><span class="p">):</span>

<span class="w">    </span><span class="s2">&quot;&quot;&quot;</span>

<span class="s2">    Raises a warning if some declared dependencies were not used during test execution</span>

<span class="s2">    This method compares the imported modules after test execution with the</span>

<span class="s2">    dependency list in the package&#39;s requirements.txt file. If the requirements</span>

<span class="s2">    contains more than what is required for execution, it raises a warning.</span>

<span class="s2">    Also warns the user if the `sqlite3` module is in use, because the current AI Inference Server</span>

<span class="s2">    does not support it. A third party replacement library can be used instead.</span>

<span class="s2">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="n">imported_packages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>

<span class="w">    </span><span class="n">packages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">importlib</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">packages_distributions</span><span class="p">()</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="n">value</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">packages</span><span class="p">:</span>

<span class="w">            </span><span class="n">pkgs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">packages</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">pkg</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">pkgs</span><span class="p">:</span>

<span class="w">                </span><span class="n">imported_packages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pkg</span><span class="p">)</span>

<span class="w">    </span><span class="n">imported_packages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">set</span><span class="p">([</span><span class="n">pkg</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">pkg</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">imported_packages</span><span class="p">])</span>

<span class="w">    </span><span class="n">requirements_list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">set</span><span class="p">([</span><span class="n">pkg</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">pkg</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">requirements_list</span><span class="p">])</span>

<span class="w">    </span><span class="n">diff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">requirements_list</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">imported_packages</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">diff</span><span class="p">):</span>

<span class="w">        </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;WARNING! The following dependencies were not used during execution: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span><span class="si">}</span><span class="s2">. Consider removing them from the pipeline package.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="c1"># raise RuntimeError(&#39;UNUSED IMPORTS: &#39; + (&#39;, &#39;.join(diff)))</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="s1">&#39;sqlite3&#39;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">:</span>

<span class="w">        </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;WARNING! sqlite3 is not part of AI Inference Server&#39;s Python runtime. Make sure to include a third party replacement library for sqlite3 in your pipeline package.&quot;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span><span class="w"> </span><span class="n">argparse</span><span class="o">.</span><span class="n">Namespace</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb">int</span><span class="p">:</span>

<span class="w">    </span><span class="s2">&quot;&quot;&quot;</span>

<span class="s2">    Feeds input to the entrypoint and captures output.</span>

<span class="s2">    Imports entrypoint module given with its name, and triggers its `run(...)` function with the prepared data in the input file.</span>

<span class="s2">    If pipeline_parameters dictionary is not empty, before triggering `run(..)` method, the `update_parameters(..)` method of entrypoint will be called with the dictionary.</span>

<span class="s2">    The input file must be a joblib dump, and the joblib must be a dictionary or list of dictionaries.</span>

<span class="s2">    One dictionary represents one input for the component with the required variable names and values, which is directly passed to `run()`.</span>

<span class="s2">    The output file is a dumped joblib result which is a list containing outputs of the component, in the structure returned from `run()`.</span>

<span class="s2">    Args:</span>

<span class="s2">        module_name (str): Name of the entrypoint Python script</span>

<span class="s2">        input_file (os.Pathlike): Path of the joblib file containing the input payloads</span>

<span class="s2">        output_file (os.Pathlike): Path of the joblib file where the outputs will be stored</span>

<span class="s2">        pipeline-parameters (json-string): json formatted dictionary defining configurable parameters with their names as key and their values</span>

<span class="s2">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="n">entrypoint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">module_name</span><span class="p">)</span>

<span class="w">    </span><span class="n">trigger_method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;none&quot;</span>

<span class="w">    </span><span class="k">try</span><span class="p">:</span>

<span class="w">        </span><span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">entrypoint</span><span class="o">.</span><span class="n">process_input</span><span class="p">)</span>

<span class="w">        </span><span class="n">trigger_method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;process_input&quot;</span>

<span class="w">    </span><span class="k">except</span><span class="w"> </span><span class="n">AttributeError</span><span class="p">:</span>

<span class="w">        </span><span class="k">try</span><span class="p">:</span>

<span class="w">            </span><span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">entrypoint</span><span class="o">.</span><span class="n">run</span><span class="p">)</span>

<span class="w">            </span><span class="n">trigger_method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;run&quot;</span>

<span class="w">        </span><span class="k">except</span><span class="w"> </span><span class="n">AttributeError</span><span class="p">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Method run not found&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">trigger_method</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;none&quot;</span><span class="p">:</span>

<span class="w">        </span><span class="k">raise</span><span class="w"> </span><span class="n">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Neither &#39;run(data: str)&#39; nor &#39;process_input(data: dict)&#39; entrypoint method can be found.&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="c1"># configure Pipeline parameters</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">args</span><span class="o">.</span><span class="n">pipeline_parameters</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="kc">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">args</span><span class="o">.</span><span class="n">pipeline_parameters</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">:</span>

<span class="w">        </span><span class="n">_logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Calling `update_parameters(..)` with: </span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">pipeline_parameters</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">entrypoint</span><span class="o">.</span><span class="n">update_parameters</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">pipeline_parameters</span><span class="p">))</span>

<span class="w">    </span><span class="n">input_list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">input_file</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">input_list</span><span class="p">,</span><span class="w"> </span><span class="nb">list</span><span class="p">):</span>

<span class="w">        </span><span class="k">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="s2">&quot;Component input must be supplied as a list.&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">trigger_method</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;process_input&quot;</span><span class="p">:</span>

<span class="w">        </span><span class="n">_logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Calling `process_input(..)`&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">output_list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">entrypoint</span><span class="o">.</span><span class="n">process_input</span><span class="p">(</span><span class="n">input_data</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">input_data</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">input_list</span><span class="p">]</span>

<span class="w">    </span><span class="k">else</span><span class="p">:</span>

<span class="w">        </span><span class="n">_logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Calling `run(..)`&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">output_list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">entrypoint</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">input_data</span><span class="p">))</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">input_data</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">input_list</span><span class="p">]</span>

<span class="w">        </span><span class="n">trigger_method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;run&quot;</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">args</span><span class="o">.</span><span class="n">requirements_file</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="kc">None</span><span class="p">:</span>

<span class="w">        </span><span class="n">requirements_list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">requirements_file</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">)</span>

<span class="w">        </span><span class="n">warn_about_unusued_dependencies</span><span class="p">(</span><span class="n">requirements_list</span><span class="p">)</span>

<span class="w">    </span><span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">output_list</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="o">.</span><span class="n">output_file</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">trigger_method</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;process_input&quot;</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="k">else</span><span class="p">:</span>

<span class="w">        </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Trigger method `run(data: str)` is deprecated and will be removed in the future. Please refer the user manual.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mb">0b10001</span><span class="w">  </span><span class="c1"># binary return code means deprecated run method was triggered</span>

<span class="k">if</span><span class="w"> </span><span class="vm">__name__</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;__main__&#39;</span><span class="p">:</span>

<span class="w">    </span><span class="n">_parser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>

<span class="w">    </span><span class="n">_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-m&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;--module-name&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">help</span><span class="o">=</span><span class="s2">&quot;The module which is implemented in the entrypoint Python script.&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="n">_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-i&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;--input-file&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">help</span><span class="o">=</span><span class="s2">&quot;The file which contains input data to test with component.&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="n">_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-o&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;--output-file&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">help</span><span class="o">=</span><span class="s2">&quot;The file which contains calculated output data.&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="n">_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-ll&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;--log-level&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;INFO&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">help</span><span class="o">=</span><span class="s2">&quot;Log Level using `logging` class&#39; enum values.&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="n">_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-p&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;--pipeline-parameters&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">help</span><span class="o">=</span><span class="s2">&quot;Dict of configurable parameters with their values&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="n">_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-r&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;--requirements-file&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">help</span><span class="o">=</span><span class="s2">&quot;The file which contains the required dependencies.&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="n">_args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

<span class="w">    </span><span class="n">_logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">getLevelName</span><span class="p">(</span><span class="n">_args</span><span class="o">.</span><span class="n">log_level</span><span class="p">))</span>

<span class="w">    </span><span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;workdir:   </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;arguments: </span><span class="si">{</span><span class="n">_args</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">main</span><span class="p">(</span><span class="n">_args</span><span class="p">))</span>
</code></pre></div>

</details>
<h2 id="functions">Functions</h2>
<h3 id="main">main</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">main</span><span class="p">(</span>
    <span class="n">args</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">Namespace</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span>
</code></pre></div>

<p>Feeds input to the entrypoint and captures output.</p>
<p>Imports entrypoint module given with its name, and triggers its <code>run(...)</code> function with the prepared data in the input file.
If pipeline_parameters dictionary is not empty, before triggering <code>run(..)</code> method, the <code>update_parameters(..)</code> method of entrypoint will be called with the dictionary.
The input file must be a joblib dump, and the joblib must be a dictionary or list of dictionaries.
One dictionary represents one input for the component with the required variable names and values, which is directly passed to <code>run()</code>.
The output file is a dumped joblib result which is a list containing outputs of the component, in the structure returned from <code>run()</code>.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>module_name</td>
<td>str</td>
<td>Name of the entrypoint Python script</td>
<td>None</td>
</tr>
<tr>
<td>input_file</td>
<td>os.Pathlike</td>
<td>Path of the joblib file containing the input payloads</td>
<td>None</td>
</tr>
<tr>
<td>output_file</td>
<td>os.Pathlike</td>
<td>Path of the joblib file where the outputs will be stored</td>
<td>None</td>
</tr>
<tr>
<td>pipeline-parameters</td>
<td>json-string</td>
<td>json formatted dictionary defining configurable parameters with their names as key and their values</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span><span class="w"> </span><span class="n">argparse</span><span class="o">.</span><span class="n">Namespace</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">:</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Feeds input to the entrypoint and captures output.</span>

<span class="sd">    Imports entrypoint module given with its name, and triggers its `run(...)` function with the prepared data in the input file.</span>

<span class="sd">    If pipeline_parameters dictionary is not empty, before triggering `run(..)` method, the `update_parameters(..)` method of entrypoint will be called with the dictionary.</span>

<span class="sd">    The input file must be a joblib dump, and the joblib must be a dictionary or list of dictionaries.</span>

<span class="sd">    One dictionary represents one input for the component with the required variable names and values, which is directly passed to `run()`.</span>

<span class="sd">    The output file is a dumped joblib result which is a list containing outputs of the component, in the structure returned from `run()`.</span>

<span class="sd">    Args:</span>

<span class="sd">        module_name (str): Name of the entrypoint Python script</span>

<span class="sd">        input_file (os.Pathlike): Path of the joblib file containing the input payloads</span>

<span class="sd">        output_file (os.Pathlike): Path of the joblib file where the outputs will be stored</span>

<span class="sd">        pipeline-parameters (json-string): json formatted dictionary defining configurable parameters with their names as key and their values</span>

<span class="sd">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="n">entrypoint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">module_name</span><span class="p">)</span>

<span class="w">    </span><span class="n">trigger_method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;none&quot;</span>

<span class="w">    </span><span class="n">try</span><span class="p">:</span>

<span class="w">        </span><span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">entrypoint</span><span class="o">.</span><span class="n">process_input</span><span class="p">)</span>

<span class="w">        </span><span class="n">trigger_method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;process_input&quot;</span>

<span class="w">    </span><span class="n">except</span><span class="w"> </span><span class="n">AttributeError</span><span class="p">:</span>

<span class="w">        </span><span class="n">try</span><span class="p">:</span>

<span class="w">            </span><span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">entrypoint</span><span class="o">.</span><span class="n">run</span><span class="p">)</span>

<span class="w">            </span><span class="n">trigger_method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;run&quot;</span>

<span class="w">        </span><span class="n">except</span><span class="w"> </span><span class="n">AttributeError</span><span class="p">:</span>

<span class="w">            </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Method run not found&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">trigger_method</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;none&quot;</span><span class="p">:</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Neither &#39;run(data: str)&#39; nor &#39;process_input(data: dict)&#39; entrypoint method can be found.&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="c1"># configure Pipeline parameters</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">args</span><span class="o">.</span><span class="n">pipeline_parameters</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">args</span><span class="o">.</span><span class="n">pipeline_parameters</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s2">&quot;{}&quot;</span><span class="p">:</span>

<span class="w">        </span><span class="n">_logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Calling `update_parameters(..)` with: {args.pipeline_parameters}&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">entrypoint</span><span class="o">.</span><span class="n">update_parameters</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">pipeline_parameters</span><span class="p">))</span>

<span class="w">    </span><span class="n">input_list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">input_file</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">input_list</span><span class="p">,</span><span class="w"> </span><span class="n">list</span><span class="p">):</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="s2">&quot;Component input must be supplied as a list.&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">trigger_method</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;process_input&quot;</span><span class="p">:</span>

<span class="w">        </span><span class="n">_logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Calling `process_input(..)`&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">output_list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">entrypoint</span><span class="o">.</span><span class="n">process_input</span><span class="p">(</span><span class="n">input_data</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">input_data</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">input_list</span><span class="p">]</span>

<span class="w">    </span><span class="k">else</span><span class="p">:</span>

<span class="w">        </span><span class="n">_logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Calling `run(..)`&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">output_list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">entrypoint</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">input_data</span><span class="p">))</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">input_data</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">input_list</span><span class="p">]</span>

<span class="w">        </span><span class="n">trigger_method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;run&quot;</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">args</span><span class="o">.</span><span class="n">requirements_file</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span>

<span class="w">        </span><span class="n">requirements_list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">requirements_file</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">)</span>

<span class="w">        </span><span class="n">warn_about_unusued_dependencies</span><span class="p">(</span><span class="n">requirements_list</span><span class="p">)</span>

<span class="w">    </span><span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">output_list</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="o">.</span><span class="n">output_file</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">trigger_method</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;process_input&quot;</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="k">else</span><span class="p">:</span>

<span class="w">        </span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Trigger method `run(data: str)` is deprecated and will be removed in the future. Please refer the user manual.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="n">b10001</span><span class="w">  </span><span class="c1"># binary return code means deprecated run method was triggered</span>
</code></pre></div>

</details>
<h3 id="warn_about_unusued_dependencies">warn_about_unusued_dependencies</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">warn_about_unusued_dependencies</span><span class="p">(</span>
    <span class="n">requirements_list</span>
<span class="p">)</span>
</code></pre></div>

<p>Raises a warning if some declared dependencies were not used during test execution</p>
<p>This method compares the imported modules after test execution with the
dependency list in the package's requirements.txt file. If the requirements
contains more than what is required for execution, it raises a warning.
Also warns the user if the <code>sqlite3</code> module is in use, because the current AI Inference Server
does not support it. A third party replacement library can be used instead.</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">warn_about_unusued_dependencies</span><span class="p">(</span><span class="n">requirements_list</span><span class="p">)</span><span class="o">:</span>

<span class="w">    </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span>

<span class="s2">    Raises a warning if some declared dependencies were not used during test execution</span>

<span class="s2">    This method compares the imported modules after test execution with the</span>

<span class="s2">    dependency list in the package&#39;s requirements.txt file. If the requirements</span>

<span class="s2">    contains more than what is required for execution, it raises a warning.</span>

<span class="s2">    Also warns the user if the `sqlite3` module is in use, because the current AI Inference Server</span>

<span class="s2">    does not support it. A third party replacement library can be used instead.</span>

<span class="s2">    </span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">    </span><span class="n">imported_packages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[]</span>

<span class="w">    </span><span class="n">packages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">importlib</span><span class="p">.</span><span class="n">metadata</span><span class="p">.</span><span class="n">packages_distributions</span><span class="p">()</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="k">key</span><span class="p">,</span><span class="k">value</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">sys</span><span class="p">.</span><span class="n">modules</span><span class="p">.</span><span class="n">items</span><span class="p">()</span><span class="o">:</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">packages</span><span class="o">:</span>

<span class="w">            </span><span class="n">pkgs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">packages</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="k">key</span><span class="p">)</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">pkg</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">pkgs</span><span class="o">:</span>

<span class="w">                </span><span class="n">imported_packages</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">pkg</span><span class="p">)</span>

<span class="w">    </span><span class="n">imported_packages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">set</span><span class="p">(</span><span class="err">[</span><span class="n">pkg</span><span class="p">.</span><span class="k">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="p">).</span><span class="nf">lower</span><span class="p">()</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">pkg</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">imported_packages</span><span class="err">]</span><span class="p">)</span>

<span class="w">    </span><span class="n">requirements_list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">set</span><span class="p">(</span><span class="err">[</span><span class="n">pkg</span><span class="p">.</span><span class="k">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="p">).</span><span class="nf">lower</span><span class="p">()</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">pkg</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">requirements_list</span><span class="err">]</span><span class="p">)</span>

<span class="w">    </span><span class="n">diff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">requirements_list</span><span class="p">.</span><span class="n">difference</span><span class="p">(</span><span class="n">imported_packages</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span><span class="o">:</span>

<span class="w">        </span><span class="n">_logger</span><span class="p">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;WARNING! The following dependencies were not used during execution: {&#39;, &#39;.join(diff)}. Consider removing them from the pipeline package.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="c1"># raise RuntimeError(&#39;UNUSED IMPORTS: &#39; + (&#39;, &#39;.join(diff)))</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="s1">&#39;sqlite3&#39;</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">sys</span><span class="p">.</span><span class="n">modules</span><span class="o">:</span>

<span class="w">        </span><span class="n">_logger</span><span class="p">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;WARNING! sqlite3 is not part of AI Inference Server&#39;s Python runtime. Make sure to include a third party replacement library for sqlite3 in your pipeline package.&quot;</span><span class="p">)</span>
</code></pre></div>

</details>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="pipeline_validator.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Pipeline Validator" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Pipeline Validator
            </div>
          </div>
        </a>
      
      
        
        <a href="run_gpuruntime_component.html" class="md-footer__link md-footer__link--next" aria-label="Next: Run Gpuruntime Component" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Run Gpuruntime Component
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright (C) Siemens AG 2021. All Rights Reserved.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.ecf98df9.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.48f2be22.min.js"></script>
      
    
  </body>
</html>